# Proyecto de Inteligencia Artificial

Repositorio académico para la organización de proyectos de Inteligencia Artificial,
donde cada proyecto se estructura de forma clara y reproducible.

Cada proyecto contiene:
- Descripción del problema
- Stack tecnológico
- Arquitectura del sistema (fases)
- Capturas del proceso
- Qué se logró
- Código fuente
- Resultados cuantificables
- Datasheet o fuente del dataset utilizado

Este repositorio está orientado a fines académicos y de aprendizaje práctico.


# Fine-Tuning de un MLP con MLflow

En este proyecto se realizó la optimización (fine-tuning) de un modelo de red neuronal
multicapa (MLP) aplicado a un problema de clasificación supervisada, utilizando MLflow
para el seguimiento de experimentos y métricas.

El objetivo principal fue mejorar el desempeño del modelo base mediante el ajuste
de hiperparámetros y evaluar cuantitativamente los resultados obtenidos.



## Descripción del problema

El problema abordado en este proyecto consiste en mejorar el desempeño de un modelo
de clasificación supervisada aplicado a un conjunto de datos estructurados. El modelo
base presenta limitaciones en métricas de evaluación como el accuracy y el F1-score,
debido al uso de hiperparámetros fijos y no optimizados.

Estas limitaciones pueden provocar subajuste o sobreajuste, reduciendo la capacidad
del modelo para generalizar correctamente sobre nuevos datos. Por esta razón, se
plantea la necesidad de aplicar técnicas de fine-tuning que permitan optimizar la
arquitectura de la red neuronal y los parámetros de entrenamiento.

El objetivo es obtener un modelo más robusto, estable y reproducible, mejorando su
rendimiento mediante un proceso sistemático de experimentación.

## Stack tecnológico

El desarrollo de este proyecto se realizó utilizando el siguiente stack tecnológico:

- Lenguaje de programación: Python 3
- Librerías principales:
  - scikit-learn
  - mlflow
  - pandas
  - numpy
- Entorno de desarrollo:
  - Jupyter Notebook / Google Colab
- Herramientas de seguimiento experimental:
  - MLflow Tracking
- Modelo utilizado:
  - MLPClassifier (Multi Layer Perceptron)

Este stack permitió implementar, entrenar, evaluar y documentar el proceso de
optimización del modelo de forma reproducible.

## Arquitectura del sistema – Fases

La arquitectura del proyecto se organizó en las siguientes fases:

### Fase 1 – Preparación de datos
- Carga del conjunto de datos
- Separación de variables predictoras y variable objetivo
- Preprocesamiento mediante pipelines

### Fase 2 – Modelo base
- Implementación de un MLPClassifier inicial
- Entrenamiento con hiperparámetros por defecto
- Evaluación preliminar del desempeño

### Fase 3 – Fine-tuning del modelo
- Ajuste del número de capas ocultas
- Ajuste del número de neuronas por capa
- Selección de la función de activación
- Configuración del batch size y número de iteraciones
- Registro de experimentos con MLflow

### Fase 4 – Evaluación y comparación
- Comparación de métricas entre configuraciones
- Selección del modelo con mejor desempeño global

## Capturas


## Qué se logró

Con el desarrollo de este proyecto se logró:

- Mejorar el desempeño del modelo base mediante fine-tuning
- Identificar una configuración óptima de hiperparámetros
- Reducir el riesgo de sobreajuste del modelo
- Implementar un flujo de trabajo reproducible
- Integrar MLflow como herramienta de seguimiento experimental
- Analizar de forma objetiva el impacto de cada ajuste realizado


## Código
[practica4FineTuning (3).ipynb](https://github.com/user-attachments/files/24174449/practica4FineTuning.3.ipynb)

{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f07c72f6-066e-4d88-8eb0-a72461176cc9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting mlflow\n",
      "  Downloading mlflow-3.7.0-py3-none-any.whl.metadata (31 kB)\n",
      "Collecting mlflow-skinny==3.7.0 (from mlflow)\n",
      "  Downloading mlflow_skinny-3.7.0-py3-none-any.whl.metadata (31 kB)\n",
      "Collecting mlflow-tracing==3.7.0 (from mlflow)\n",
      "  Downloading mlflow_tracing-3.7.0-py3-none-any.whl.metadata (19 kB)\n",
      "Collecting Flask-CORS<7 (from mlflow)\n",
      "  Downloading flask_cors-6.0.1-py3-none-any.whl.metadata (5.3 kB)\n",
      "Requirement already satisfied: Flask<4 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (3.1.0)\n",
      "Requirement already satisfied: alembic!=1.10.0,<2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (1.16.5)\n",
      "Requirement already satisfied: cryptography<47,>=43.0.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (44.0.1)\n",
      "Collecting docker<8,>=4.0.0 (from mlflow)\n",
      "  Downloading docker-7.1.0-py3-none-any.whl.metadata (3.8 kB)\n",
      "Collecting graphene<4 (from mlflow)\n",
      "  Downloading graphene-3.4.3-py2.py3-none-any.whl.metadata (6.9 kB)\n",
      "Collecting huey<3,>=2.5.0 (from mlflow)\n",
      "  Downloading huey-2.5.5-py3-none-any.whl.metadata (4.8 kB)\n",
      "Requirement already satisfied: matplotlib<4 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (3.10.0)\n",
      "Requirement already satisfied: numpy<3 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (2.1.3)\n",
      "Requirement already satisfied: pandas<3 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (2.2.3)\n",
      "Requirement already satisfied: pyarrow<23,>=4.0.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (19.0.0)\n",
      "Requirement already satisfied: scikit-learn<2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (1.6.1)\n",
      "Requirement already satisfied: scipy<2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (1.15.3)\n",
      "Requirement already satisfied: sqlalchemy<3,>=1.4.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow) (2.0.39)\n",
      "Collecting waitress<4 (from mlflow)\n",
      "  Downloading waitress-3.0.2-py3-none-any.whl.metadata (5.8 kB)\n",
      "Requirement already satisfied: cachetools<7,>=5.0.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (5.5.1)\n",
      "Requirement already satisfied: click<9,>=7.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (8.1.8)\n",
      "Requirement already satisfied: cloudpickle<4 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (3.0.0)\n",
      "Collecting databricks-sdk<1,>=0.20.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading databricks_sdk-0.74.0-py3-none-any.whl.metadata (40 kB)\n",
      "Collecting fastapi<1 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading fastapi-0.124.4-py3-none-any.whl.metadata (30 kB)\n",
      "Requirement already satisfied: gitpython<4,>=3.1.9 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (3.1.43)\n",
      "Requirement already satisfied: importlib_metadata!=4.7.0,<9,>=3.7.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (8.5.0)\n",
      "Collecting opentelemetry-api<3,>=1.9.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading opentelemetry_api-1.39.1-py3-none-any.whl.metadata (1.5 kB)\n",
      "Collecting opentelemetry-proto<3,>=1.9.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading opentelemetry_proto-1.39.1-py3-none-any.whl.metadata (2.3 kB)\n",
      "Collecting opentelemetry-sdk<3,>=1.9.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading opentelemetry_sdk-1.39.1-py3-none-any.whl.metadata (1.5 kB)\n",
      "Requirement already satisfied: packaging<26 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (24.2)\n",
      "Requirement already satisfied: protobuf<7,>=3.12.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (5.29.3)\n",
      "Requirement already satisfied: pydantic<3,>=2.0.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (2.10.3)\n",
      "Requirement already satisfied: python-dotenv<2,>=0.19.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (1.1.0)\n",
      "Requirement already satisfied: pyyaml<7,>=5.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (6.0.2)\n",
      "Requirement already satisfied: requests<3,>=2.17.3 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (2.32.3)\n",
      "Collecting sqlparse<1,>=0.4.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading sqlparse-0.5.4-py3-none-any.whl.metadata (4.7 kB)\n",
      "Requirement already satisfied: typing-extensions<5,>=4.0.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from mlflow-skinny==3.7.0->mlflow) (4.12.2)\n",
      "Collecting uvicorn<1 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading uvicorn-0.38.0-py3-none-any.whl.metadata (6.8 kB)\n",
      "Requirement already satisfied: Mako in c:\\users\\asus\\anaconda3\\lib\\site-packages (from alembic!=1.10.0,<2->mlflow) (1.3.10)\n",
      "Requirement already satisfied: colorama in c:\\users\\asus\\anaconda3\\lib\\site-packages (from click<9,>=7.0->mlflow-skinny==3.7.0->mlflow) (0.4.6)\n",
      "Requirement already satisfied: cffi>=1.12 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from cryptography<47,>=43.0.0->mlflow) (1.17.1)\n",
      "Collecting google-auth~=2.0 (from databricks-sdk<1,>=0.20.0->mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading google_auth-2.43.0-py2.py3-none-any.whl.metadata (6.6 kB)\n",
      "Collecting protobuf<7,>=3.12.0 (from mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading protobuf-6.33.2-cp310-abi3-win_amd64.whl.metadata (593 bytes)\n",
      "Requirement already satisfied: pywin32>=304 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from docker<8,>=4.0.0->mlflow) (308)\n",
      "Requirement already satisfied: urllib3>=1.26.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from docker<8,>=4.0.0->mlflow) (2.3.0)\n",
      "Collecting starlette<0.51.0,>=0.40.0 (from fastapi<1->mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading starlette-0.50.0-py3-none-any.whl.metadata (6.3 kB)\n",
      "Collecting annotated-doc>=0.0.2 (from fastapi<1->mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading annotated_doc-0.0.4-py3-none-any.whl.metadata (6.6 kB)\n",
      "Requirement already satisfied: Werkzeug>=3.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from Flask<4->mlflow) (3.1.3)\n",
      "Requirement already satisfied: Jinja2>=3.1.2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from Flask<4->mlflow) (3.1.6)\n",
      "Requirement already satisfied: itsdangerous>=2.2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from Flask<4->mlflow) (2.2.0)\n",
      "Requirement already satisfied: blinker>=1.9 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from Flask<4->mlflow) (1.9.0)\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from gitpython<4,>=3.1.9->mlflow-skinny==3.7.0->mlflow) (4.0.7)\n",
      "Requirement already satisfied: smmap<5,>=3.0.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from gitdb<5,>=4.0.1->gitpython<4,>=3.1.9->mlflow-skinny==3.7.0->mlflow) (4.0.0)\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.7.0->mlflow) (0.2.8)\n",
      "Collecting rsa<5,>=3.1.4 (from google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading rsa-4.9.1-py3-none-any.whl.metadata (5.6 kB)\n",
      "Collecting graphql-core<3.3,>=3.1 (from graphene<4->mlflow)\n",
      "  Downloading graphql_core-3.2.7-py3-none-any.whl.metadata (11 kB)\n",
      "Collecting graphql-relay<3.3,>=3.1 (from graphene<4->mlflow)\n",
      "  Downloading graphql_relay-3.2.0-py3-none-any.whl.metadata (12 kB)\n",
      "Requirement already satisfied: python-dateutil<3,>=2.7.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from graphene<4->mlflow) (2.9.0.post0)\n",
      "Requirement already satisfied: zipp>=3.20 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from importlib_metadata!=4.7.0,<9,>=3.7.0->mlflow-skinny==3.7.0->mlflow) (3.21.0)\n",
      "Requirement already satisfied: contourpy>=1.0.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (1.3.1)\n",
      "Requirement already satisfied: cycler>=0.10 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (0.11.0)\n",
      "Requirement already satisfied: fonttools>=4.22.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (4.55.3)\n",
      "Requirement already satisfied: kiwisolver>=1.3.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (1.4.8)\n",
      "Requirement already satisfied: pillow>=8 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (11.1.0)\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from matplotlib<4->mlflow) (3.2.0)\n",
      "Collecting opentelemetry-semantic-conventions==0.60b1 (from opentelemetry-sdk<3,>=1.9.0->mlflow-skinny==3.7.0->mlflow)\n",
      "  Downloading opentelemetry_semantic_conventions-0.60b1-py3-none-any.whl.metadata (2.4 kB)\n",
      "Requirement already satisfied: pytz>=2020.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from pandas<3->mlflow) (2024.1)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from pandas<3->mlflow) (2025.2)\n",
      "Requirement already satisfied: annotated-types>=0.6.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from pydantic<3,>=2.0.0->mlflow-skinny==3.7.0->mlflow) (0.6.0)\n",
      "Requirement already satisfied: pydantic-core==2.27.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from pydantic<3,>=2.0.0->mlflow-skinny==3.7.0->mlflow) (2.27.1)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from python-dateutil<3,>=2.7.0->graphene<4->mlflow) (1.17.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.7.0->mlflow) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.7.0->mlflow) (3.7)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from requests<3,>=2.17.3->mlflow-skinny==3.7.0->mlflow) (2025.10.5)\n",
      "Requirement already satisfied: pyasn1>=0.1.3 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from rsa<5,>=3.1.4->google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.7.0->mlflow) (0.4.8)\n",
      "Requirement already satisfied: joblib>=1.2.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from scikit-learn<2->mlflow) (1.4.2)\n",
      "Requirement already satisfied: threadpoolctl>=3.1.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from scikit-learn<2->mlflow) (3.5.0)\n",
      "Requirement already satisfied: greenlet!=0.4.17 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from sqlalchemy<3,>=1.4.0->mlflow) (3.1.1)\n",
      "Requirement already satisfied: anyio<5,>=3.6.2 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from starlette<0.51.0,>=0.40.0->fastapi<1->mlflow-skinny==3.7.0->mlflow) (4.7.0)\n",
      "Requirement already satisfied: sniffio>=1.1 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from anyio<5,>=3.6.2->starlette<0.51.0,>=0.40.0->fastapi<1->mlflow-skinny==3.7.0->mlflow) (1.3.0)\n",
      "Requirement already satisfied: h11>=0.8 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from uvicorn<1->mlflow-skinny==3.7.0->mlflow) (0.16.0)\n",
      "Requirement already satisfied: pycparser in c:\\users\\asus\\anaconda3\\lib\\site-packages (from cffi>=1.12->cryptography<47,>=43.0.0->mlflow) (2.21)\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in c:\\users\\asus\\anaconda3\\lib\\site-packages (from Jinja2>=3.1.2->Flask<4->mlflow) (3.0.2)\n",
      "Downloading mlflow-3.7.0-py3-none-any.whl (8.9 MB)\n",
      "   ---------------------------------------- 0.0/8.9 MB ? eta -:--:--\n",
      "   - -------------------------------------- 0.3/8.9 MB ? eta -:--:--\n",
      "   --- ------------------------------------ 0.8/8.9 MB 2.7 MB/s eta 0:00:04\n",
      "   ----- ---------------------------------- 1.3/8.9 MB 2.7 MB/s eta 0:00:03\n",
      "   -------- ------------------------------- 1.8/8.9 MB 2.8 MB/s eta 0:00:03\n",
      "   ----------- ---------------------------- 2.6/8.9 MB 2.8 MB/s eta 0:00:03\n",
      "   -------------- ------------------------- 3.1/8.9 MB 2.8 MB/s eta 0:00:03\n",
      "   --------------- ------------------------ 3.4/8.9 MB 2.7 MB/s eta 0:00:03\n",
      "   ----------------- ---------------------- 3.9/8.9 MB 2.6 MB/s eta 0:00:02\n",
      "   ------------------ --------------------- 4.2/8.9 MB 2.5 MB/s eta 0:00:02\n",
      "   --------------------- ------------------ 4.7/8.9 MB 2.4 MB/s eta 0:00:02\n",
      "   ----------------------- ---------------- 5.2/8.9 MB 2.4 MB/s eta 0:00:02\n",
      "   ------------------------- -------------- 5.8/8.9 MB 2.4 MB/s eta 0:00:02\n",
      "   ---------------------------- ----------- 6.3/8.9 MB 2.4 MB/s eta 0:00:02\n",
      "   ------------------------------ --------- 6.8/8.9 MB 2.4 MB/s eta 0:00:01\n",
      "   -------------------------------- ------- 7.3/8.9 MB 2.4 MB/s eta 0:00:01\n",
      "   ---------------------------------- ----- 7.6/8.9 MB 2.4 MB/s eta 0:00:01\n",
      "   ------------------------------------ --- 8.1/8.9 MB 2.4 MB/s eta 0:00:01\n",
      "   ------------------------------------- -- 8.4/8.9 MB 2.3 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 8.7/8.9 MB 2.3 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 8.7/8.9 MB 2.3 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 8.7/8.9 MB 2.3 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 8.7/8.9 MB 2.3 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 8.9/8.9 MB 1.9 MB/s eta 0:00:00\n",
      "Downloading mlflow_skinny-3.7.0-py3-none-any.whl (2.4 MB)\n",
      "   ---------------------------------------- 0.0/2.4 MB ? eta -:--:--\n",
      "   -------- ------------------------------- 0.5/2.4 MB 3.3 MB/s eta 0:00:01\n",
      "   ----------------- ---------------------- 1.0/2.4 MB 3.4 MB/s eta 0:00:01\n",
      "   ------------------------------ --------- 1.8/2.4 MB 3.4 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 2.4/2.4 MB 3.7 MB/s eta 0:00:00\n",
      "Downloading mlflow_tracing-3.7.0-py3-none-any.whl (1.3 MB)\n",
      "   ---------------------------------------- 0.0/1.3 MB ? eta -:--:--\n",
      "   ------------------------ --------------- 0.8/1.3 MB 4.7 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 1.3/1.3 MB 4.5 MB/s eta 0:00:00\n",
      "Downloading databricks_sdk-0.74.0-py3-none-any.whl (764 kB)\n",
      "   ---------------------------------------- 0.0/764.2 kB ? eta -:--:--\n",
      "   ---------------------------------------- 764.2/764.2 kB 3.3 MB/s eta 0:00:00\n",
      "Downloading docker-7.1.0-py3-none-any.whl (147 kB)\n",
      "Downloading fastapi-0.124.4-py3-none-any.whl (113 kB)\n",
      "Downloading flask_cors-6.0.1-py3-none-any.whl (13 kB)\n",
      "Downloading google_auth-2.43.0-py2.py3-none-any.whl (223 kB)\n",
      "Downloading graphene-3.4.3-py2.py3-none-any.whl (114 kB)\n",
      "Downloading graphql_core-3.2.7-py3-none-any.whl (207 kB)\n",
      "Downloading graphql_relay-3.2.0-py3-none-any.whl (16 kB)\n",
      "Downloading huey-2.5.5-py3-none-any.whl (76 kB)\n",
      "Downloading opentelemetry_api-1.39.1-py3-none-any.whl (66 kB)\n",
      "Downloading opentelemetry_proto-1.39.1-py3-none-any.whl (72 kB)\n",
      "Downloading opentelemetry_sdk-1.39.1-py3-none-any.whl (132 kB)\n",
      "Downloading opentelemetry_semantic_conventions-0.60b1-py3-none-any.whl (219 kB)\n",
      "Downloading protobuf-6.33.2-cp310-abi3-win_amd64.whl (436 kB)\n",
      "Downloading rsa-4.9.1-py3-none-any.whl (34 kB)\n",
      "Downloading sqlparse-0.5.4-py3-none-any.whl (45 kB)\n",
      "Downloading starlette-0.50.0-py3-none-any.whl (74 kB)\n",
      "Downloading uvicorn-0.38.0-py3-none-any.whl (68 kB)\n",
      "Downloading waitress-3.0.2-py3-none-any.whl (56 kB)\n",
      "Downloading annotated_doc-0.0.4-py3-none-any.whl (5.3 kB)\n",
      "Installing collected packages: huey, waitress, sqlparse, rsa, protobuf, graphql-core, annotated-doc, uvicorn, starlette, opentelemetry-proto, opentelemetry-api, graphql-relay, google-auth, docker, opentelemetry-semantic-conventions, graphene, Flask-CORS, fastapi, databricks-sdk, opentelemetry-sdk, mlflow-tracing, mlflow-skinny, mlflow\n",
      "\n",
      "   ----------------------------------------  0/23 [huey]\n",
      "   - --------------------------------------  1/23 [waitress]\n",
      "   ----- ----------------------------------  3/23 [rsa]\n",
      "  Attempting uninstall: protobuf\n",
      "   ----- ----------------------------------  3/23 [rsa]\n",
      "    Found existing installation: protobuf 5.29.3\n",
      "   ----- ----------------------------------  3/23 [rsa]\n",
      "    Uninstalling protobuf-5.29.3:\n",
      "   ----- ----------------------------------  3/23 [rsa]\n",
      "      Successfully uninstalled protobuf-5.29.3\n",
      "   ----- ----------------------------------  3/23 [rsa]\n",
      "   ------ ---------------------------------  4/23 [protobuf]\n",
      "   ------ ---------------------------------  4/23 [protobuf]\n",
      "   ------ ---------------------------------  4/23 [protobuf]\n",
      "   -------- -------------------------------  5/23 [graphql-core]\n",
      "   -------- -------------------------------  5/23 [graphql-core]\n",
      "   -------- -------------------------------  5/23 [graphql-core]\n",
      "   -------- -------------------------------  5/23 [graphql-core]\n",
      "   -------- -------------------------------  5/23 [graphql-core]\n",
      "   ------------ ---------------------------  7/23 [uvicorn]\n",
      "   ------------- --------------------------  8/23 [starlette]\n",
      "   ------------- --------------------------  8/23 [starlette]\n",
      "   --------------- ------------------------  9/23 [opentelemetry-proto]\n",
      "   ----------------- ---------------------- 10/23 [opentelemetry-api]\n",
      "   -------------------- ------------------- 12/23 [google-auth]\n",
      "   -------------------- ------------------- 12/23 [google-auth]\n",
      "   -------------------- ------------------- 12/23 [google-auth]\n",
      "   ---------------------- ----------------- 13/23 [docker]\n",
      "   ---------------------- ----------------- 13/23 [docker]\n",
      "   -------------------- ------------ 14/23 [opentelemetry-semantic-conventions]\n",
      "   -------------------- ------------ 14/23 [opentelemetry-semantic-conventions]\n",
      "   -------------------- ------------ 14/23 [opentelemetry-semantic-conventions]\n",
      "   -------------------------- ------------- 15/23 [graphene]\n",
      "   -------------------------- ------------- 15/23 [graphene]\n",
      "   -------------------------- ------------- 15/23 [graphene]\n",
      "   -------------------------- ------------- 15/23 [graphene]\n",
      "   ----------------------------- ---------- 17/23 [fastapi]\n",
      "   ----------------------------- ---------- 17/23 [fastapi]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   ------------------------------- -------- 18/23 [databricks-sdk]\n",
      "   --------------------------------- ------ 19/23 [opentelemetry-sdk]\n",
      "   --------------------------------- ------ 19/23 [opentelemetry-sdk]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ---------------------------------- ----- 20/23 [mlflow-tracing]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   ------------------------------------ --- 21/23 [mlflow-skinny]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   -------------------------------------- - 22/23 [mlflow]\n",
      "   ---------------------------------------- 23/23 [mlflow]\n",
      "\n",
      "Successfully installed Flask-CORS-6.0.1 annotated-doc-0.0.4 databricks-sdk-0.74.0 docker-7.1.0 fastapi-0.124.4 google-auth-2.43.0 graphene-3.4.3 graphql-core-3.2.7 graphql-relay-3.2.0 huey-2.5.5 mlflow-3.7.0 mlflow-skinny-3.7.0 mlflow-tracing-3.7.0 opentelemetry-api-1.39.1 opentelemetry-proto-1.39.1 opentelemetry-sdk-1.39.1 opentelemetry-semantic-conventions-0.60b1 protobuf-6.33.2 rsa-4.9.1 sqlparse-0.5.4 starlette-0.50.0 uvicorn-0.38.0 waitress-3.0.2\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install mlflow\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "499e9019-b949-41ff-bab1-8187551cebcb",
   "metadata": {},
   "source": [
    "# TÍTULO PRÁCTICA 3: Optimización - Redes Neuronales\n",
    "# Integrantes: Heather Ulloa y Valentina Vallejos"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "deb50f78-1a78-4209-bb51-6ce86acd0683",
   "metadata": {},
   "source": [
    "# FASE 1: preparación de datos"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "189679d0-bd50-4b8d-9dce-354df493355d",
   "metadata": {},
   "source": [
    "### 1.1. Carga y descripción del dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b820ecca-691e-4d70-9b02-bb05032fbd79",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Archivos extraídos correctamente en: dataset_nf1\n",
      "Contenido del ZIP:\n",
      "['dataset-uci.xlsx']\n"
     ]
    }
   ],
   "source": [
    "import zipfile\n",
    "import os\n",
    "import pandas as pd\n",
    "\n",
    "# Ruta REAL del ZIP en Descargas\n",
    "zip_path = r\"C:\\Users\\ASUS\\Downloads\\neurofibromatosis+type+1+clinical+symptoms+of+familial+and+sporadic+cases.zip\"\n",
    "\n",
    "# Carpeta donde se extraerán los archivos\n",
    "extract_folder = \"dataset_nf1\"\n",
    "os.makedirs(extract_folder, exist_ok=True)\n",
    "\n",
    "with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n",
    "    zip_ref.extractall(extract_folder)\n",
    "    print(\"Archivos extraídos correctamente en:\", extract_folder)\n",
    "    print(\"Contenido del ZIP:\")\n",
    "    print(zip_ref.namelist())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "103ac6b8-684e-4775-84df-d8ecb2c1ce60",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columnas originales en el Excel: 19\n",
      "Index(['Case Type', 'Tumour Case', 'Age of Mother', 'Age of Father',\n",
      "       'Age at First Diagnosis', 'Café au lait (CLS)', 'Axillary Freckles',\n",
      "       'Inguinal Freckles', 'Lisch Nodules', 'Dermal Neurofibromins',\n",
      "       'Plexiform Neurofibromins', 'Optic Glioma', 'Skeletal Dysplasia',\n",
      "       'Learning Disability', 'Hypertension', 'Astrocytoma', 'Hamartoma',\n",
      "       'Scoliosis', 'Other Symptoms'],\n",
      "      dtype='object')\n",
      "Dataset NF1 cargado correctamente\n",
      "Cantidad de observaciones (pacientes): 296\n",
      "Cantidad de variables (características): 19\n",
      "Dimensiones totales (filas, columnas): (296, 19)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_TYPE</th>\n",
       "      <th>TUMOUR_CASE</th>\n",
       "      <th>AGE_MOTHER</th>\n",
       "      <th>AGE_FATHER</th>\n",
       "      <th>AGE_FIRST_DIAGNOSIS</th>\n",
       "      <th>CAFE_AU_LAIT</th>\n",
       "      <th>AXILLARY_FRECKLES</th>\n",
       "      <th>INGUINAL_FRECKLES</th>\n",
       "      <th>LISCH_NODULES</th>\n",
       "      <th>DERMAL_NEUROFIBROMINS</th>\n",
       "      <th>PLEXIFORM_NEUROFIBROMINS</th>\n",
       "      <th>OPTIC_GLIOMA</th>\n",
       "      <th>SKELETAL_DYSPLASIA</th>\n",
       "      <th>LEARNING_DISABILITY</th>\n",
       "      <th>HYPERTENSION</th>\n",
       "      <th>ASTROCYTOMA</th>\n",
       "      <th>HAMARTOMA</th>\n",
       "      <th>SCOLIOSIS</th>\n",
       "      <th>OTHER_SYMPTOMS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>28.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>27.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   CASE_TYPE  TUMOUR_CASE  AGE_MOTHER  AGE_FATHER  AGE_FIRST_DIAGNOSIS  \\\n",
       "0          0            1        30.0        31.0                  5.0   \n",
       "1          0            1        22.0        29.0                  7.0   \n",
       "2          1            1        28.0        26.0                  9.0   \n",
       "3          0            1        30.0        34.0                  9.0   \n",
       "4          0            1        27.0        34.0                  1.0   \n",
       "\n",
       "   CAFE_AU_LAIT  AXILLARY_FRECKLES  INGUINAL_FRECKLES  LISCH_NODULES  \\\n",
       "0             0                  0                  0              0   \n",
       "1             1                  1                  0              0   \n",
       "2             1                  1                  0              0   \n",
       "3             1                  1                  0              1   \n",
       "4             1                  1                  1              0   \n",
       "\n",
       "   DERMAL_NEUROFIBROMINS  PLEXIFORM_NEUROFIBROMINS  OPTIC_GLIOMA  \\\n",
       "0                      0                         0             1   \n",
       "1                      1                         0             0   \n",
       "2                      1                         0             0   \n",
       "3                      0                         1             0   \n",
       "4                      0                         0             1   \n",
       "\n",
       "   SKELETAL_DYSPLASIA  LEARNING_DISABILITY  HYPERTENSION  ASTROCYTOMA  \\\n",
       "0                   0                    0             0            0   \n",
       "1                   0                    0             0            0   \n",
       "2                   1                    0             0            0   \n",
       "3                   0                    0             0            0   \n",
       "4                   0                    0             0            0   \n",
       "\n",
       "   HAMARTOMA  SCOLIOSIS  OTHER_SYMPTOMS  \n",
       "0          0          0               1  \n",
       "1          0          0               1  \n",
       "2          0          0               1  \n",
       "3          0          0               1  \n",
       "4          0          0               1  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import copy\n",
    "import os\n",
    "\n",
    "# Ruta al archivo dentro de la carpeta extraída\n",
    "data_path = os.path.join(\"dataset_nf1\", \"dataset-uci.xlsx\")\n",
    "\n",
    "# 1) Cargar el Excel\n",
    "df = pd.read_excel(data_path)\n",
    "\n",
    "# 2) (Por si acaso) eliminar columna de índice automática si existiera\n",
    "if 'Unnamed: 0' in df.columns:\n",
    "    df = df.drop(columns=['Unnamed: 0'])\n",
    "\n",
    "# 3) Renombrar las 19 columnas con nombres \"tipo German Credit\"\n",
    "nombresVariables = [\n",
    "    'CASE_TYPE',             # Case Type: 0 = esporádico, 1 = familiar\n",
    "    'TUMOUR_CASE',           # Tumour Case: 0 = sin tumores, 1 = con tumores\n",
    "    'AGE_MOTHER',            # Age of Mother\n",
    "    'AGE_FATHER',            # Age of Father\n",
    "    'AGE_FIRST_DIAGNOSIS',   # Age at First Diagnosis\n",
    "    'CAFE_AU_LAIT',          # Café au lait (CLS)\n",
    "    'AXILLARY_FRECKLES',     # Axillary Freckles\n",
    "    'INGUINAL_FRECKLES',     # Inguinal Freckles\n",
    "    'LISCH_NODULES',         # Lisch Nodules\n",
    "    'DERMAL_NEUROFIBROMINS', # Dermal Neurofibromins\n",
    "    'PLEXIFORM_NEUROFIBROMINS', # Plexiform Neurofibromins\n",
    "    'OPTIC_GLIOMA',          # Optic Glioma\n",
    "    'SKELETAL_DYSPLASIA',    # Skeletal Dysplasia\n",
    "    'LEARNING_DISABILITY',   # Learning Disability\n",
    "    'HYPERTENSION',          # Hypertension\n",
    "    'ASTROCYTOMA',           # Astrocytoma\n",
    "    'HAMARTOMA',             # Hamartoma\n",
    "    'SCOLIOSIS',             # Scoliosis\n",
    "    'OTHER_SYMPTOMS'         # Other Symptoms\n",
    "]\n",
    "\n",
    "# Asegurarnos de que el número de nombres coincide\n",
    "print(\"Columnas originales en el Excel:\", len(df.columns))\n",
    "print(df.columns)\n",
    "\n",
    "df.columns = nombresVariables  # Asignamos los nombres \"limpios\"\n",
    "\n",
    "# 4) Copia de trabajo (como en tus otras prácticas)\n",
    "dataframe = copy.deepcopy(df)\n",
    "\n",
    "print(\"Dataset NF1 cargado correctamente\")\n",
    "print(\"Cantidad de observaciones (pacientes):\", dataframe.shape[0])\n",
    "print(\"Cantidad de variables (características):\", dataframe.shape[1])\n",
    "print(\"Dimensiones totales (filas, columnas):\", dataframe.shape)\n",
    "\n",
    "dataframe.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "552fe74e-a8c0-44d5-8f7b-e54fcfb04570",
   "metadata": {},
   "source": [
    "En esta sección se cargó el conjunto de datos clínicos de NF1 desde el archivo dataset-uci.xlsx, quedando un total de 296 pacientes y 19 variables originales.\n",
    "Estas variables incluyen la variable de salida CASE_TYPE (caso esporádico o familiar), la variable TUMOUR_CASE y diferentes signos/síntomas clínicos (café-au-lait, pecas axilares, glioma óptico, escoliosis, etc.). El resultado confirma que el dataset se cargó correctamente y que tiene el tamaño esperado para continuar con el preprocesamiento."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "784707b7-a9d1-44d7-9ae1-01842f7ee564",
   "metadata": {},
   "source": [
    "### 1.2.Formato a la variable de salida"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "514db3f9-43a4-429f-b45a-4486afeeb125",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Valores únicos en FAMILIAL antes de formatear:\n",
      "CASE_TYPE\n",
      "0    161\n",
      "1    135\n",
      "Name: count, dtype: int64\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CASE_TYPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   CASE_TYPE\n",
       "0          0\n",
       "1          0\n",
       "2          1\n",
       "3          0\n",
       "4          0"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Formato a la variable de salida (de estudio): FAMILIAL\n",
    "# 0 = caso esporádico, 1 = caso familiar\n",
    "\n",
    "# Verificar qué valores tiene actualmente\n",
    "print(\"Valores únicos en FAMILIAL antes de formatear:\")\n",
    "print(dataframe['CASE_TYPE'].value_counts())\n",
    "\n",
    "# Si ya está en 0 y 1, solo nos aseguramos de que sea entero\n",
    "dataframe['CASE_TYPE'] = dataframe['CASE_TYPE'].astype(int)\n",
    "\n",
    "# Vista rápida\n",
    "dataframe[['CASE_TYPE']].head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d0a05a81-7dee-473b-bde1-4ef4c2f3165a",
   "metadata": {},
   "source": [
    "En esta sección se cargó el conjunto de datos clínicos de NF1 desde el archivo dataset-uci.xlsx, quedando un total de 296 pacientes y 19 variables originales.\n",
    "Estas variables incluyen la variable de salida CASE_TYPE (caso esporádico o familiar), la variable TUMOUR_CASE y diferentes signos/síntomas clínicos (café-au-lait, pecas axilares, glioma óptico, escoliosis, etc.). El resultado confirma que el dataset se cargó correctamente y que tiene el tamaño esperado para continuar con el preprocesamiento."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8e53eaa9-6210-46ed-a06c-187084838cc7",
   "metadata": {},
   "source": [
    "### 1.3.Eliminación de variables y separación de variable de salida\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5527810e-43d3-429a-b7d5-0f55f415e68a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape de X después de eliminar variables: (296, 16)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TUMOUR_CASE</th>\n",
       "      <th>AGE_MOTHER</th>\n",
       "      <th>AGE_FIRST_DIAGNOSIS</th>\n",
       "      <th>CAFE_AU_LAIT</th>\n",
       "      <th>AXILLARY_FRECKLES</th>\n",
       "      <th>INGUINAL_FRECKLES</th>\n",
       "      <th>LISCH_NODULES</th>\n",
       "      <th>DERMAL_NEUROFIBROMINS</th>\n",
       "      <th>PLEXIFORM_NEUROFIBROMINS</th>\n",
       "      <th>OPTIC_GLIOMA</th>\n",
       "      <th>SKELETAL_DYSPLASIA</th>\n",
       "      <th>LEARNING_DISABILITY</th>\n",
       "      <th>ASTROCYTOMA</th>\n",
       "      <th>HAMARTOMA</th>\n",
       "      <th>SCOLIOSIS</th>\n",
       "      <th>OTHER_SYMPTOMS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>28.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>27.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   TUMOUR_CASE  AGE_MOTHER  AGE_FIRST_DIAGNOSIS  CAFE_AU_LAIT  \\\n",
       "0            1        30.0                  5.0             0   \n",
       "1            1        22.0                  7.0             1   \n",
       "2            1        28.0                  9.0             1   \n",
       "3            1        30.0                  9.0             1   \n",
       "4            1        27.0                  1.0             1   \n",
       "\n",
       "   AXILLARY_FRECKLES  INGUINAL_FRECKLES  LISCH_NODULES  DERMAL_NEUROFIBROMINS  \\\n",
       "0                  0                  0              0                      0   \n",
       "1                  1                  0              0                      1   \n",
       "2                  1                  0              0                      1   \n",
       "3                  1                  0              1                      0   \n",
       "4                  1                  1              0                      0   \n",
       "\n",
       "   PLEXIFORM_NEUROFIBROMINS  OPTIC_GLIOMA  SKELETAL_DYSPLASIA  \\\n",
       "0                         0             1                   0   \n",
       "1                         0             0                   0   \n",
       "2                         0             0                   1   \n",
       "3                         1             0                   0   \n",
       "4                         0             1                   0   \n",
       "\n",
       "   LEARNING_DISABILITY  ASTROCYTOMA  HAMARTOMA  SCOLIOSIS  OTHER_SYMPTOMS  \n",
       "0                    0            0          0          0               1  \n",
       "1                    0            0          0          0               1  \n",
       "2                    0            0          0          0               1  \n",
       "3                    0            0          0          0               1  \n",
       "4                    0            0          0          0               1  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Separación de variable de salida y eliminación de variables poco relevantes\n",
    "\n",
    "# Variable de salida (de estudio): tipo de caso (0 = esporádico, 1 = familiar)\n",
    "Y = dataframe['CASE_TYPE']\n",
    "\n",
    "# Eliminamos variables consideradas menos relevantes o redundantes\n",
    "dataframe = dataframe.drop(['AGE_FATHER'], axis=1)\n",
    "dataframe = dataframe.drop(['HYPERTENSION'], axis=1)\n",
    "\n",
    "# Eliminamos del X la columna de salida\n",
    "dataframe = dataframe.drop(['CASE_TYPE'], axis=1)\n",
    "\n",
    "print(\"Shape de X después de eliminar variables:\", dataframe.shape)\n",
    "dataframe.head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "890dfdb2-c0bd-44a5-8389-ca46b38a5b5b",
   "metadata": {},
   "source": [
    "En esta parte se separó la variable de salida Y = CASE_TYPE y, sobre las variables de entrada, se eliminaron AGE_FATHER y HYPERTENSION, además de quitar la propia columna CASE_TYPE del dataframe de entrada.\n",
    "El nuevo shape muestra que el modelo trabajará con 16 variables independientes. La idea de esta sección es simplificar el modelo eliminando variables con menor relevancia o redundantes, manteniendo aquellas que están más directamente relacionadas con la presencia de tumores y signos clínicos de NF1."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 281,
   "id": "1f6ac768-68e6-4e56-a9b8-5e7c9035195c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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RERqYAIlIiJSAxMoERGRGphAiYiI1MAESkREpAYmUCIiIjUwgRIREamBCZSIiEgNTKBERERqYAIlIiJSAxMoERGRGphAiYiI1MAESkREpAYmUCIiIjUwgRIREamBCZSIiEgNTKBERERqYAIlIiJSAxMoERGRGphAiYiI1FCpCfTo0aPo2bMn7O3toVAosGvXrlLrjho1CgqFAhEREbLynJwcjB07FjVr1oShoSF69eqFu3fvVmzgRERU7VVqAs3IyECTJk2wePHiMuvt2rULp06dgr29fbFlISEh2LlzJzZv3ozjx48jPT0dPXr0QEFBQUWFTUREBO3K3HjXrl3RtWvXMuv8/fffGDNmDPbv34/u3bvLlqWmpmLlypVYt24dOnbsCABYv349HB0dcfDgQfj7+1dY7EREVL1V6WughYWFGDp0KCZNmoRGjRoVW3727Fnk5eWhc+fOUpm9vT3c3d0RExNTars5OTlIS0uTTURERKqo0gl07ty50NbWxqefflri8qSkJOjq6sLc3FxWbmNjg6SkpFLbDQ8Ph6mpqTQ5OjpqNG4iInrzVdkEevbsWSxcuBCRkZFQKBQqrSuEKHOdqVOnIjU1VZru3LnzquESEVE1U2UT6LFjx5CcnAwnJydoa2tDW1sbt27dwoQJE+Di4gIAsLW1RW5uLlJSUmTrJicnw8bGptS2lUolTExMZBMREZEqqmwCHTp0KC5cuID4+Hhpsre3x6RJk7B//34AQNOmTaGjo4OoqChpvXv37uHSpUvw8fGprNCJiKgaqNRRuOnp6bh+/bo0n5iYiPj4eFhYWMDJyQmWlpay+jo6OrC1tYWbmxsAwNTUFMHBwZgwYQIsLS1hYWGBiRMnonHjxtKoXCIioopQqQn0zJkz8PPzk+bHjx8PAAgMDERkZGS52liwYAG0tbUREBCArKwsdOjQAZGRkdDS0qqIkImIiAAACiGEqOwgKltaWhpMTU2RmpqqkeuhTSet1UBURC939uthlR0C0RtD1VxQZa+BEhERVWVMoERERGqo1GugRPTm4qUM+rdU1qUM9kCJiIjUwARKRESkBiZQIiIiNTCBEhERqYEJlIiISA1MoERERGpgAiUiIlIDEygREZEamECJiIjUwARKRESkBiZQIiIiNTCBEhERqYEJlIiISA1MoERERGpgAiUiIlKDygk0Li4OFy9e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zSsUCoSGhiI0NLRS4iEiouqpSl8DJSIiqqqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqqdAINDw9Hs2bNYGxsDGtra/Tp0wcJCQmyOkIIhIaGwt7eHvr6+mjfvj0uX75cSRETEVF1UaUT6JEjR/DJJ5/g5MmTiIqKQn5+Pjp37oyMjAypzrx58zB//nwsXrwYsbGxsLW1RadOnfD06dNKjJyIiN502pUdQFn27dsnm1+9ejWsra1x9uxZtGvXDkIIREREYNq0aejbty8AYM2aNbCxscHGjRsxatSoygibiIiqgSrdA31RamoqAMDCwgIAkJiYiKSkJHTu3Fmqo1Qq4evri5iYmEqJkYiIqocq3QN9nhAC48ePR5s2beDu7g4ASEpKAgDY2NjI6trY2ODWrVultpWTk4OcnBxpPi0trQIiJiKiN9lr0wMdM2YMLly4gE2bNhVbplAoZPNCiGJlzwsPD4epqak0OTo6ajxeIiJ6s70WCXTs2LHYvXs3Dh8+jLfeeksqt7W1BfC/nmiR5OTkYr3S502dOhWpqanSdOfOnYoJnIiI3lhVOoEKITBmzBjs2LEDhw4dgqurq2y5q6srbG1tERUVJZXl5ubiyJEj8PHxKbVdpVIJExMT2URERKSKKn0N9JNPPsHGjRvx888/w9jYWOppmpqaQl9fHwqFAiEhIQgLC0PdunVRt25dhIWFwcDAAIMGDark6ImI6E1WpRPo0qVLAQDt27eXla9evRpBQUEAgMmTJyMrKwujR49GSkoKWrRogQMHDsDY2PhfjpaIiKqTKp1AhRAvraNQKBAaGorQ0NCKD4iIiOj/q9LXQImIiKoqJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREamACJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1vDEJdMmSJXB1dYWenh6aNm2KY8eOVXZIRET0BnsjEuiWLVsQEhKCadOm4dy5c2jbti26du2K27dvV3ZoRET0hnojEuj8+fMRHByMESNGoEGDBoiIiICjoyOWLl1a2aEREdEbSruyA3hVubm5OHv2LKZMmSIr79y5M2JiYkpcJycnBzk5OdJ8amoqACAtLU0jMRXkZGmkHaKX0dQxWxH4d0D/Fk39HRS1I4QoV/3XPoE+fPgQBQUFsLGxkZXb2NggKSmpxHXCw8Mxa9asYuWOjo4VEiNRRTFd9FFlh0BU6TT9d/D06VOYmpq+tN5rn0CLKBQK2bwQolhZkalTp2L8+PHSfGFhIR4/fgxLS8tS16GKlZaWBkdHR9y5cwcmJiaVHQ5RpeDfQeUSQuDp06ewt7cvV/3XPoHWrFkTWlpaxXqbycnJxXqlRZRKJZRKpazMzMysokIkFZiYmPCLg6o9/h1UnvL0PIu89oOIdHV10bRpU0RFRcnKo6Ki4OPjU0lRERHRm+6174ECwPjx4zF06FB4e3ujVatWWL58OW7fvo2PPuL1ISIiqhhvRALt378/Hj16hNmzZ+PevXtwd3fH3r174ezsXNmhUTkplUrMnDmz2Kl1ouqEfwevF4Uo73hdIiIikrz210CJiIgqAxMoERGRGphAiYiI1MAESlXW/fv3MXv2bKSkpFR2KET/KhcXF0REREjzCoUCu3btAgDcvHkTCoUC8fHxlRIb/Q8TKFVJQggMHToUSqUS5ubmZdZ98QslOjoaCoUCT548qfhAqVoICgqCQqEoNl2/fr1CthcbG4sPP/ywxGWOjo7S3QZUuZhAq6nSvhC6dOlS2aEBePa84lq1auHzzz9XeV0fHx/cu3dPpSeKEL1Mly5dcO/ePdnk6upaIduysrKCgYFBicu0tLRga2sLbW3170LMzc1Ve136HybQaqykL4RNmzZVSix5eXmy+S+++ALLli1Tqy1dXV3Y2tryucakUUqlEra2trJp4cKFaNy4MQwNDeHo6IjRo0cjPT1dWicyMhJmZmbYs2cP3NzcYGBggH79+iEjIwNr1qyBi4sLzM3NMXbsWBQUFEjrvXgK93kvnnEpKChAcHAwXF1doa+vDzc3NyxcuFC2TlBQEPr06YPw8HDY29ujXr16Gv98qiMm0GqspC+EotOloaGhcHJyglKphL29PT799FNpPRcXF/znP//BoEGDYGRkBHt7eyxatEjW9u3bt9G7d28YGRnBxMQEAQEBuH//vrQ8NDQUnp6eWLVqFWrVqgWlUgkhBPbt24c2bdrAzMwMlpaW6NGjB27cuCFr+/Tp0/Dy8oKenh68vb1x7tw52fKSTuH+/vvv8PX1hYGBAczNzeHv7y9dW83JycGnn34Ka2tr6OnpoU2bNoiNjdXIZ0xvtho1auC7777DpUuXsGbNGhw6dAiTJ0+W1cnMzMR3332HzZs3Y9++fYiOjkbfvn2xd+9e7N27F+vWrcPy5cuxbds2tWIoLCzEW2+9hZ9++glXrlzBjBkz8MUXX+Cnn36S1fvtt99w9epVREVFYc+ePWrvMz1HULUUGBgoevfuXeKyrVu3ChMTE7F3715x69YtcerUKbF8+XJpubOzszA2Nhbh4eEiISFBfPfdd0JLS0scOHBACCFEYWGh8PLyEm3atBFnzpwRJ0+eFG+//bbw9fWV2pg5c6YwNDQU/v7+Ii4uTpw/f14UFhaKn376SWzbtk1cu3ZNxMXFiW7duonGjRuLgoICIYQQ6enpwsrKSvTv319cunRJ/PLLL6JWrVoCgDh37pwQQojDhw8LACIlJUUIIcS5c+eEUqkUH3/8sYiPjxeXLl0SixYtEg8ePBBCCPHpp58Ke3t7sXfvXnH58mURGBgozM3NxaNHjzT7odNrKzAwUGhpaQlDQ0Np6tevX7F6P/30k7C0tJTmV69eLQCI69evS2WjRo0SBgYG4unTp1KZv7+/GDVqlDTv7OwsFixYIM0DEDt37hRCCJGYmCg73ksyevRo8d5778nit7GxETk5OarsNr3EG/EoP1LPnj17YGRkJCv7/PPPYWhoCFtbW3Ts2BE6OjpwcnJC8+bNZfVat24tvcS8Xr16+P3337FgwQJ06tQJBw8exIULF5CYmCi9Y3XdunVo1KgRYmNj0axZMwDPrsOsW7cOVlZWUrvvv/++bDurVq2Cra0trly5And3d2zYsAEFBQVYtWoVDAwM0KhRI9y9excff/xxqfs5b948eHt7Y8mSJVJZo0aNAAAZGRlYunQpIiMj0bVrVwDAihUrEBUVhZUrV2LSpEkqfab05vLz88PSpUuleUNDQxw+fBhhYWG4cuUK0tLSkJ+fj+zsbGRkZMDQ0BAAYGBggNq1a0vr2djYwMXFRfa3Z2Njg+TkZLVjW7ZsGX788UfcunULWVlZyM3Nhaenp6xO48aNoaurq/Y2qDiewq3G/Pz8EB8fL5s++eQTvP/++8jKykKtWrUwcuRI7Ny5E/n5+bJ1W7VqVWz+6tWrAICrV6/C0dFR9oLyhg0bwszMTKoDAM7OzrLkCTw79Tty5Eh4eHjA3t4eTZo0kcqL2m7SpIlsgMWLsbwoPj4eHTp0KHHZjRs3kJeXh9atW0tlOjo6aN68uSxWIkNDQ9SpU0eacnNz0a1bN7i7u2P79u04e/Ysvv/+ewDya/o6OjqydhQKRYllhYWFasX1008/Ydy4cfjggw9w4MABxMfHY/jw4cUGChUldNIc9kCrsaIvhBdZWFggISEBUVFROHjwIEaPHo2vv/4aR44cKfaH/7yiQTuilJeZv1he0h90jx494OrqihUrVsDe3h6FhYVwcXGRvgyEGo9u1tfXL3VZUXuqvJCdCADOnDmD/Px8fPvtt6hR41lf5MXrjv+GY8eOwcfHB6NHj5bKXhw3QBWDPVAqkb6+Pnr16oXvvvsO0dHROHHiBC5evCgtP3nypKz+yZMnUb9+fQDPepu3b9/GnTt3pOVXrlxBamoqGjRoUOo2Hz16hIsXL2LSpElo0aIFHB0dcfPmTVmdhg0b4vz588jKyio1lhd5eHjgt99+K3FZnTp1oKuri+PHj0tleXl5OHPmTJmxEtWuXRv5+flYtGgR/vrrL6xbt07tkeOvok6dOjhz5gz279+Pa9euYfr06RwE9y9hAq3GcnJykJSUJJsePnyIyMhIrFy5EpcuXZK+GPT19WWvh/v9998xb948XLt2Dd9//z22bt2Kzz77DADQsWNHeHh4YPDgwYiLi8Pp06cxbNgw+Pr6wtvbu9R4zMzMYGFhgWXLluH69ev47bffMGHCBFmdQYMGoUaNGggODsaVK1ewd+9efPPNN2Xu59SpUxEbG4vRo0fjwoUL+OOPP7B06VI8fPgQhoaG+PjjjzFp0iTs27cPV65cwciRI5GZmYng4OBX+HTpTefp6Yn58+dj7ty50vX58PDwfz2Ojz76CH379kX//v3RokULPHr0SNYbpQpUqUOYqNIEBgYKAMUmNzc3sXPnTtGiRQthYmIiDA0NRcuWLcXBgweldZ2dncWsWbNEQECAMDAwEDY2NiIiIkLW/q1bt0SvXr2EoaGhMDY2Fu+//75ISkqSls+cOVM0adKkWFxRUVGiQYMGQqlUCg8PDxEdHS0bgSiEECdOnBBNmjQRurq6wtPTU2zfvr3MUbhCCBEdHS18fHyEUqkUZmZmwt/fX1qelZUlxo4dK2rWrCmUSqVo3bq1OH369Ct/xkT0ZuP7QEllLi4uCAkJQUhISGWHQkRUaXgKl4iISA1MoERERGrgKVwiIiI1sAdKRESkBiZQIiIiNTCBEhERqYEJlIiISA1MoPRGKHq/aGUo6+XHr7OEhATY2tri6dOnlR3Ka23Pnj3w8vJS+2HxVHUxgVKVp1AoypyCgoIwceLEUp93S+qZNm0aPvnkExgbG0tlQggsX74cLVq0gJGREczMzODt7Y2IiAhkZmbK1r979y50dXWlZyS/6PDhw/Dz84OFhQUMDAxQt25dBAYGSm/+KXoxeklTUlJSmbG7uLiUecy4u7vD1tYWYWFhxdYNCAhAs2bNkJ+fj9DQUGkdLS0tODo6YsSIEXjw4IFUv7RtbN68GcCzFyQoFAps3LixfB88vTb4Nhaq8u7duyf9vGXLFsyYMQMJCQlSmb6+PoyMjIq925TUd/fuXezevbtYz3ro0KHYsWMHvvzySyxevBhWVlY4f/48IiIi4OLigj59+kh1IyMjERAQgKNHj+L333+XvTLu8uXL6Nq1Kz799FMsWrQI+vr6+PPPP7Ft27ZiPbWEhASYmJjIyqytrcuMPzY2FgUFBQCAmJgYvPfee7J2il4g8P7776Nnz55o3LgxAGDbtm345ZdfEBcXB23tZ1+PjRo1wsGDB1FQUIBz584hODgYf//9N3799Vdpe6tXr0aXLl1kMZiZmUk/Dx8+HIsWLcKQIUPKjJteM5X6IEEiFa1evVqYmpoWK3/x2bqBgYGid+/eIjQ0VFhZWQljY2Px4YcfipycHKlOdna2GDt2rLCysir3M3Dv378vevToIfT09ISLi4tYv369cHZ2FgsWLJDqPHnyRIwcOVLarp+fn4iPjy+z3Tt37oj+/fsLc3NzYWBgIJo2bSpOnjwphBDi+vXrolevXsLa2loYGhoKb29vERUVJVv/+++/F3Xq1BFKpVJYW1uL995775X289tvvxXe3t6ysi1btggAYteuXcXqFxYWiidPnsjma9WqJfbt2yc+//xzMXz4cFn9BQsWCBcXlzJjKOmZxuooq52goCDh6ekpcnNzRXJysrCyspL9Lkt6ZvOcOXNEjRo1RGZmphBCFHtWc0lu3rwpAIgbN2680r5Q1cJTuPTG+u2333D16lUcPnwYmzZtws6dOzFr1ixp+eTJk7F9+3asWbMGcXFxqFOnDvz9/fH48eNS2wwKCsLNmzdx6NAhbNu2DUuWLEFycrK0XAiB7t27IykpCXv37sXZs2fx9ttvo0OHDqW2m56eDl9fX/zzzz/YvXs3zp8/j8mTJ0s9sfT0dHTr1g0HDx7EuXPn4O/vj549e0ovGT9z5gw+/fRTzJ49GwkJCdi3bx/atWv3Svt59OjRYm/O2bBhA9zc3NC7d+9i9RUKBUxNTaX5w4cPIzMzEx07dsTQoUPx008/ya6l2tra4t69ezh69GipMfwbFi5ciMePH+M///kPRo8eDXd3d+mtQqXR19dHYWFhsZfMl8XZ2RnW1tY4duzYq4ZMVUllZ3AiVajSA7WwsBAZGRlS2dKlS4WRkZEoKCgQ6enpQkdHR2zYsEFanpubK+zt7cW8efNK3HZCQoIAIPUMhRDi6tWrAoDUa/ntt9+EiYmJyM7Olq1bu3Zt8cMPP5TY7g8//CCMjY3Fo0ePXrb7koYNG4pFixYJIYTYvn27MDExEWlpacXqqbOfQgjRpEkTMXv2bFlZgwYNRK9evcoV36BBg0RISIisvRUrVkjz+fn5IigoSAAQtra2ok+fPmLRokUiNTVVqlPUczQ0NJRN9erVK1cML7ZTWk/2t99+E1paWsLExETcvHlTtuzF4+rq1auiTp06onnz5lIZAKGnp1cszhd7m15eXiI0NFSl2Klq4zVQemM1adIEBgYG0nyrVq2Qnp6OO3fuIDU1FXl5ebLrcjo6OmjevDmuXr1aYntXr16Ftra2rGdWv3592bWus2fPIj09HZaWlrJ1s7KycOPGjRLbjY+Ph5eXFywsLEpcnpGRgVmzZmHPnj34559/kJ+fj6ysLKkH2qlTJzg7O6NWrVro0qULunTpgnfffRcGBga4ceOGyvtZFK+enp6sTAgBhUJR6jpFnjx5gh07dsheUj5kyBCsWrUKI0aMAABoaWlh9erVmDNnDg4dOoSTJ0/iq6++wty5c3H69GnY2dlJ6x47dkw2kKno2qSmvPPOO2jZsiU8PT1l77wtcvHiRRgZGaGgoAA5OTlo3749li9fLquzYMECdOzYUVbm6Ogom9fX1y820Ipeb0ygVO0oFAqI//8I6BcTQllJorR1nldYWAg7OztER0cXW/Z8on2evr5+mfFOmjQJ+/fvxzfffIM6depAX18f/fr1Q25uLgDA2NgYcXFxiI6OxoEDBzBjxgyEhoYiNjZWrf0EgJo1ayIlJUVWVq9evTKTbpGNGzciOzsbLVq0kG2vsLAQV65cQcOGDaVyBwcHDB06FEOHDsWcOXNQr149LFu2THaq3dXVtdTPTlO0tbVLTcxubm7YvXs3tLS0YG9vD6VSWayOra0t6tSpU+Y2Hj9+DCsrK43ES1UDr4HSG+v8+fPIysqS5k+ePAkjIyO89dZbqFOnjjQSs0heXh7OnDmDBg0alNhegwYNkJ+fjzNnzkhlCQkJePLkiTT/9ttvIykpCdra2qhTp45sqlmzZontenh4ID4+vtRrkseOHUNQUBDeffddNG7cGLa2trh586asjra2Njp27Ih58+bhwoUL0nVadfYTALy8vHDlyhVZ2aBBg3Dt2jX8/PPPxeoLIZCamgoAWLlyJSZMmID4+HhpOn/+PPz8/LBq1apSt2lubg47OztkZGSUWqcy6Orqok6dOnB1dS0xeZZHdnY2bty4AS8vLw1HR5WJPVB6Y+Xm5iI4OBhffvklbt26hZkzZ2LMmDGoUaMGDA0N8fHHH2PSpEmwsLCAk5MT5s2bh8zMTAQHB5fYnpubG7p06YKRI0di+fLl0NbWRkhIiKwH2bFjR7Rq1Qp9+vTB3Llz4ebmhn/++Qd79+5Fnz59ig3MAYCBAwciLCwMffr0QXh4OOzs7HDu3DnY29ujVatWqFOnDnbs2IGePXtCoVBg+vTpsls99uzZg7/++gvt2rWDubk59u7di8LCQri5uam1nwDg7++PESNGoKCgAFpaWgCe3R+5c+dODBw4ENOnT0enTp1gZWWFixcvYsGCBRg7dixcXFwQFxeHDRs2FLv/c+DAgZg2bRrCw8OxatUqxMfH491330Xt2rWRnZ2NtWvX4vLly1i0aJFsveTkZGRnZ8vKLC0toaOjU2r8/7YnT54UuzfV2NgYhoaGAJ7986ZUKtGqVavKCI8qSuVdfiVSnaq3scyYMUNYWloKIyMjMWLECNngnqysLDF27FhRs2bNct/ece/ePdG9e3ehVCqFk5OTWLt2bbHbWNLS0sTYsWOFvb290NHREY6OjmLw4MHi9u3bpbZ78+ZN8d577wkTExNhYGAgvL29xalTp4QQQiQmJgo/Pz+hr68vHB0dxeLFi4Wvr6/47LPPhBBCHDt2TPj6+gpzc3Ohr68vPDw8xJYtW15pP/Pz84WDg4PYt2+frLygoEAsXbpUNGvWTBgYGAgTExPRtGlTsXDhQpGZmSnGjBkjGjZsWGKbycnJQktLS2zfvl3ExcWJIUOGCFdXV6FUKoWlpaVo166d2L17t1S/aPBPSdOJEyfKjP955bkd5vnP83kl3cbyotJiDA8Pl+p8+OGHYtSoUeWOmV4PfB8ovZGCgoLw5MkT7Nq1q7JDeW0tWbIEP//8M/bv31/ZobzWHjx4gPr16+PMmTNwdXWt7HBIg3gKl4hK9OGHHyIlJQVPnz6VjYIl1SQmJmLJkiVMnm8g9kDpjcQe6JuvrEc3/vrrr2jbtu2/GA1VR0ygRPRaun79eqnLHBwcXnp7ENGrYgIlIiJSA+8DJSIiUgMTKBERkRqYQImIiNTABEpERKQGJlAiIiI1MIESERGpgQmUiIhIDUygREREavh/4zzS9Ku5d8wAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 500x400 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Asegúrate de que Y ya está definido como:\n",
    "# Y = dataframe_original['CASE_TYPE']   (antes de hacer los drops en X)\n",
    "\n",
    "plt.figure(figsize=(5,4))\n",
    "sns.countplot(x=Y)\n",
    "\n",
    "plt.xlabel('Tipo de caso (CASE_TYPE)')\n",
    "plt.ylabel('Cantidad de pacientes')\n",
    "plt.title('Frecuencia de casos: esporádicos vs familiares')\n",
    "plt.xticks([0, 1], ['Esporádico', 'Familiar'])\n",
    "\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "804e056c-7d27-4779-b21b-e4fea8a10016",
   "metadata": {},
   "source": [
    "### 1.4.Análisis de variables categóricas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b44afa01-e319-4f9f-8a8f-88d73b1945eb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Columnas actuales de X:\n",
      "['TUMOUR_CASE', 'AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS', 'CAFE_AU_LAIT', 'AXILLARY_FRECKLES', 'INGUINAL_FRECKLES', 'LISCH_NODULES', 'DERMAL_NEUROFIBROMINS', 'PLEXIFORM_NEUROFIBROMINS', 'OPTIC_GLIOMA', 'SKELETAL_DYSPLASIA', 'LEARNING_DISABILITY', 'ASTROCYTOMA', 'HAMARTOMA', 'SCOLIOSIS', 'OTHER_SYMPTOMS']\n",
      "Cantidad de variables antes de transformación de variables:  16\n",
      "Cantidad de categorías en la variable categórica nominal TUMOUR_CASE : 2\n",
      "Cantidad de categorías en la variable categórica nominal CAFE_AU_LAIT : 2\n",
      "Cantidad de categorías en la variable categórica nominal AXILLARY_FRECKLES : 2\n",
      "Cantidad de categorías en la variable categórica nominal INGUINAL_FRECKLES : 2\n",
      "Cantidad de categorías en la variable categórica nominal LISCH_NODULES : 2\n",
      "Cantidad de categorías en la variable categórica nominal DERMAL_NEUROFIBROMINS : 2\n",
      "Cantidad de categorías en la variable categórica nominal PLEXIFORM_NEUROFIBROMINS : 2\n",
      "Cantidad de categorías en la variable categórica nominal OPTIC_GLIOMA : 2\n",
      "Cantidad de categorías en la variable categórica nominal SKELETAL_DYSPLASIA : 2\n",
      "Cantidad de categorías en la variable categórica nominal LEARNING_DISABILITY : 2\n",
      "Cantidad de categorías en la variable categórica nominal ASTROCYTOMA : 2\n",
      "Cantidad de categorías en la variable categórica nominal HAMARTOMA : 2\n",
      "Cantidad de categorías en la variable categórica nominal SCOLIOSIS : 2\n",
      "Cantidad de categorías en la variable categórica nominal OTHER_SYMPTOMS : 2\n",
      "Cantidad de variables binarias que reemplazarán a las variables categóricas nominales:  28\n",
      "Cantidad de variables que habrá después de la transformación de variables:  30\n"
     ]
    }
   ],
   "source": [
    "# ==== Determinación de tipos de variables para NF1 ====\n",
    "\n",
    "# Verificamos las columnas actuales de X (solo por seguridad)\n",
    "print(\"Columnas actuales de X:\")\n",
    "print(list(dataframe.columns))\n",
    "\n",
    "# 1) Variables categóricas ordinales\n",
    "# En este dataset no hay una escala clara tipo \"bajo/medio/alto\",\n",
    "# así que dejamos esta lista vacía.\n",
    "categorical_ordinal_features = []\n",
    "\n",
    "# 2) Variables categóricas nominales (binarias 0/1)\n",
    "categorical_nominal_features = [\n",
    "    'TUMOUR_CASE',\n",
    "    'CAFE_AU_LAIT',\n",
    "    'AXILLARY_FRECKLES',\n",
    "    'INGUINAL_FRECKLES',\n",
    "    'LISCH_NODULES',\n",
    "    'DERMAL_NEUROFIBROMINS',\n",
    "    'PLEXIFORM_NEUROFIBROMINS',\n",
    "    'OPTIC_GLIOMA',\n",
    "    'SKELETAL_DYSPLASIA',\n",
    "    'LEARNING_DISABILITY',\n",
    "    'ASTROCYTOMA',\n",
    "    'HAMARTOMA',\n",
    "    'SCOLIOSIS',\n",
    "    'OTHER_SYMPTOMS'\n",
    "]\n",
    "\n",
    "# 3) Variables numéricas\n",
    "numeric_features = [\n",
    "    'AGE_MOTHER',\n",
    "    'AGE_FIRST_DIAGNOSIS'\n",
    "]\n",
    "\n",
    "def analisisVariables(dataframe, categorical_ordinal_features, categorical_nominal_features):\n",
    "    cantidadTotalVariables = len(dataframe.columns)\n",
    "    print('Cantidad de variables antes de transformación de variables: ', cantidadTotalVariables)\n",
    "\n",
    "    cantidadVariablesNominales = len(categorical_nominal_features)\n",
    "    cantidadVariablesBinarias = 0\n",
    "\n",
    "    for variable in categorical_nominal_features:\n",
    "        cantidadCategorias = dataframe[variable].nunique()\n",
    "        cantidadVariablesBinarias = cantidadVariablesBinarias + cantidadCategorias\n",
    "        print('Cantidad de categorías en la variable categórica nominal', variable, ':', cantidadCategorias)\n",
    "\n",
    "    print('Cantidad de variables binarias que reemplazarán a las variables categóricas nominales: ', cantidadVariablesBinarias)\n",
    "\n",
    "    cantidadTotalVariablesConTransformacion = cantidadTotalVariables - cantidadVariablesNominales + cantidadVariablesBinarias\n",
    "    return cantidadTotalVariablesConTransformacion\n",
    "\n",
    "cantidadTotalVariablesConTransformacion = analisisVariables(\n",
    "    dataframe,\n",
    "    categorical_ordinal_features,\n",
    "    categorical_nominal_features\n",
    ")\n",
    "\n",
    "print('Cantidad de variables que habrá después de la transformación de variables: ',\n",
    "      cantidadTotalVariablesConTransformacion)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2390f98e-afda-453d-94d3-5e9dfd03f6df",
   "metadata": {},
   "source": [
    "El conjunto de datos de NF1 utilizado para el modelo cuenta inicialmente con 16 variables independientes (X).\n",
    "En esta sección se clasificaron las variables de entrada en:\n",
    "\n",
    "14 Variables categóricas nominales (todas las clínicas 0/1):\n",
    "TUMOUR_CASE, CAFE_AU_LAIT, AXILLARY_FRECKLES, INGUINAL_FRECKLES, LISCH_NODULES, DERMAL_NEUROFIBROMINS,\n",
    "PLEXIFORM_NEUROFIBROMINS, OPTIC_GLIOMA, SKELETAL_DYSPLASIA, LEARNING_DISABILITY,\n",
    "ASTROCYTOMA, HAMARTOMA, SCOLIOSIS, OTHER_SYMPTOMS.\n",
    "\n",
    "2 Variables numéricas: AGE_MOTHER y AGE_FIRST_DIAGNOSIS.\n",
    "\n",
    "Al aplicar el análisis de transformación de variables, se determinó que cada variable categórica nominal presenta 2 categorías posibles (0 y 1). Por lo tanto, al transformar estas 14 variables mediante codificación binaria (One-Hot Encoding), se obtienen 28 variables binarias que reemplazarán a las 14 originales.\n",
    "\n",
    "El número total de variables después de la transformación se calcula como:\n",
    "\n",
    "Variables iniciales: 16\n",
    "\n",
    "Menos las 14 variables categóricas nominales originales\n",
    "\n",
    "Más las 28 variables binarias generadas\n",
    "\n",
    "Es decir:\n",
    "16 − 14 + 28 = 30 variables.\n",
    "\n",
    "En consecuencia, el dataframe transformado quedará conformado por 30 variables, que incluyen las nuevas variables binarias asociadas a los síntomas y tumores, junto con las variables numéricas de edad, quedando el conjunto de datos preparado para las siguientes etapas de normalización, estandarización y entrenamiento de la red neuronal."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a353437-859f-4f50-b84c-4ceeca8601dc",
   "metadata": {},
   "source": [
    "### 1.5. Diseño de transformadores"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "5c16a902-2f35-43eb-9eeb-3c9a3ea4dca0",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.preprocessing import OrdinalEncoder, OneHotEncoder, MinMaxScaler, StandardScaler\n",
    "from sklearn.impute import SimpleImputer\n",
    "\n",
    "# OJO: aquí se asume que YA definiste antes:\n",
    "# categorical_ordinal_features\n",
    "# categorical_nominal_features\n",
    "# cantidadTotalVariablesConTransformacion\n",
    "\n",
    "# 1. Preprocesador de variables categóricas a numéricas (ordinales y nominales)\n",
    "categorical_ordinal_transformer = Pipeline(steps=[\n",
    "    ('ordinal', OrdinalEncoder())\n",
    "])\n",
    "\n",
    "categorical_nominal_transformer_ConNombres = Pipeline(steps=[\n",
    "    ('onehot', OneHotEncoder(sparse_output=False, handle_unknown=\"ignore\"))  # corregido\n",
    "])\n",
    "\n",
    "preprocesorCategoricoNumericoConNombres = ColumnTransformer(\n",
    "    transformers=[\n",
    "        ('catord', categorical_ordinal_transformer, categorical_ordinal_features),\n",
    "        ('catnom', categorical_nominal_transformer_ConNombres, categorical_nominal_features)\n",
    "    ],\n",
    "    remainder='passthrough',\n",
    "    n_jobs=-1\n",
    ")\n",
    "\n",
    "# 2. Normalización y Scaling: MinMaxScaler\n",
    "minmax_transformer = Pipeline(steps=[\n",
    "    ('minmax', MinMaxScaler(feature_range=(0, 1)))\n",
    "])\n",
    "\n",
    "preprocesorMinMax = ColumnTransformer(\n",
    "    transformers=[\n",
    "        ('tranminmax', minmax_transformer, list(range(cantidadTotalVariablesConTransformacion)))\n",
    "    ],\n",
    "    remainder='passthrough'\n",
    ")\n",
    "\n",
    "# 3. Estandarización: StandardScaler\n",
    "standardscaler_transformer = Pipeline(steps=[\n",
    "    ('scaler', StandardScaler(with_mean=True, with_std=True))\n",
    "])\n",
    "\n",
    "preprocesorStandardScaler = ColumnTransformer(\n",
    "    transformers=[\n",
    "        ('transcaler', standardscaler_transformer, list(range(cantidadTotalVariablesConTransformacion)))\n",
    "    ],\n",
    "    remainder='passthrough'\n",
    ")\n",
    "\n",
    "# 4. Imputación de valores faltantes: SimpleImputer\n",
    "simpleimputer_transformer = Pipeline(steps=[\n",
    "    ('simpleimputer', SimpleImputer(strategy='median'))  # también puedes usar 'most_frequent'\n",
    "])\n",
    "\n",
    "preprocesorSimpleImputer = ColumnTransformer(\n",
    "    transformers=[\n",
    "        ('transimpleimputer', simpleimputer_transformer, list(range(cantidadTotalVariablesConTransformacion)))\n",
    "    ],\n",
    "    remainder='passthrough'\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "d6bcc304-12f1-456d-81fc-70367ac0b8b7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {\n",
       "  /* Definition of color scheme common for light and dark mode */\n",
       "  --sklearn-color-text: #000;\n",
       "  --sklearn-color-text-muted: #666;\n",
       "  --sklearn-color-line: gray;\n",
       "  /* Definition of color scheme for unfitted estimators */\n",
       "  --sklearn-color-unfitted-level-0: #fff5e6;\n",
       "  --sklearn-color-unfitted-level-1: #f6e4d2;\n",
       "  --sklearn-color-unfitted-level-2: #ffe0b3;\n",
       "  --sklearn-color-unfitted-level-3: chocolate;\n",
       "  /* Definition of color scheme for fitted estimators */\n",
       "  --sklearn-color-fitted-level-0: #f0f8ff;\n",
       "  --sklearn-color-fitted-level-1: #d4ebff;\n",
       "  --sklearn-color-fitted-level-2: #b3dbfd;\n",
       "  --sklearn-color-fitted-level-3: cornflowerblue;\n",
       "\n",
       "  /* Specific color for light theme */\n",
       "  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n",
       "  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-icon: #696969;\n",
       "\n",
       "  @media (prefers-color-scheme: dark) {\n",
       "    /* Redefinition of color scheme for dark theme */\n",
       "    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n",
       "    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-icon: #878787;\n",
       "  }\n",
       "}\n",
       "\n",
       "#sk-container-id-1 {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 pre {\n",
       "  padding: 0;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 input.sk-hidden--visually {\n",
       "  border: 0;\n",
       "  clip: rect(1px 1px 1px 1px);\n",
       "  clip: rect(1px, 1px, 1px, 1px);\n",
       "  height: 1px;\n",
       "  margin: -1px;\n",
       "  overflow: hidden;\n",
       "  padding: 0;\n",
       "  position: absolute;\n",
       "  width: 1px;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-dashed-wrapped {\n",
       "  border: 1px dashed var(--sklearn-color-line);\n",
       "  margin: 0 0.4em 0.5em 0.4em;\n",
       "  box-sizing: border-box;\n",
       "  padding-bottom: 0.4em;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-container {\n",
       "  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n",
       "     but bootstrap.min.css set `[hidden] { display: none !important; }`\n",
       "     so we also need the `!important` here to be able to override the\n",
       "     default hidden behavior on the sphinx rendered scikit-learn.org.\n",
       "     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n",
       "  display: inline-block !important;\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-text-repr-fallback {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       "div.sk-parallel-item,\n",
       "div.sk-serial,\n",
       "div.sk-item {\n",
       "  /* draw centered vertical line to link estimators */\n",
       "  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n",
       "  background-size: 2px 100%;\n",
       "  background-repeat: no-repeat;\n",
       "  background-position: center center;\n",
       "}\n",
       "\n",
       "/* Parallel-specific style estimator block */\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel-item::after {\n",
       "  content: \"\";\n",
       "  width: 100%;\n",
       "  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n",
       "  flex-grow: 1;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel {\n",
       "  display: flex;\n",
       "  align-items: stretch;\n",
       "  justify-content: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel-item {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel-item:first-child::after {\n",
       "  align-self: flex-end;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel-item:last-child::after {\n",
       "  align-self: flex-start;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-parallel-item:only-child::after {\n",
       "  width: 0;\n",
       "}\n",
       "\n",
       "/* Serial-specific style estimator block */\n",
       "\n",
       "#sk-container-id-1 div.sk-serial {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "  align-items: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  padding-right: 1em;\n",
       "  padding-left: 1em;\n",
       "}\n",
       "\n",
       "\n",
       "/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n",
       "clickable and can be expanded/collapsed.\n",
       "- Pipeline and ColumnTransformer use this feature and define the default style\n",
       "- Estimators will overwrite some part of the style using the `sk-estimator` class\n",
       "*/\n",
       "\n",
       "/* Pipeline and ColumnTransformer style (default) */\n",
       "\n",
       "#sk-container-id-1 div.sk-toggleable {\n",
       "  /* Default theme specific background. It is overwritten whether we have a\n",
       "  specific estimator or a Pipeline/ColumnTransformer */\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "/* Toggleable label */\n",
       "#sk-container-id-1 label.sk-toggleable__label {\n",
       "  cursor: pointer;\n",
       "  display: flex;\n",
       "  width: 100%;\n",
       "  margin-bottom: 0;\n",
       "  padding: 0.5em;\n",
       "  box-sizing: border-box;\n",
       "  text-align: center;\n",
       "  align-items: start;\n",
       "  justify-content: space-between;\n",
       "  gap: 0.5em;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 label.sk-toggleable__label .caption {\n",
       "  font-size: 0.6rem;\n",
       "  font-weight: lighter;\n",
       "  color: var(--sklearn-color-text-muted);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n",
       "  /* Arrow on the left of the label */\n",
       "  content: \"▸\";\n",
       "  float: left;\n",
       "  margin-right: 0.25em;\n",
       "  color: var(--sklearn-color-icon);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "/* Toggleable content - dropdown */\n",
       "\n",
       "#sk-container-id-1 div.sk-toggleable__content {\n",
       "  max-height: 0;\n",
       "  max-width: 0;\n",
       "  overflow: hidden;\n",
       "  text-align: left;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-toggleable__content.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-toggleable__content pre {\n",
       "  margin: 0.2em;\n",
       "  border-radius: 0.25em;\n",
       "  color: var(--sklearn-color-text);\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n",
       "  /* Expand drop-down */\n",
       "  max-height: 200px;\n",
       "  max-width: 100%;\n",
       "  overflow: auto;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n",
       "  content: \"▾\";\n",
       "}\n",
       "\n",
       "/* Pipeline/ColumnTransformer-specific style */\n",
       "\n",
       "#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator-specific style */\n",
       "\n",
       "/* Colorize estimator box */\n",
       "#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n",
       "#sk-container-id-1 div.sk-label label {\n",
       "  /* The background is the default theme color */\n",
       "  color: var(--sklearn-color-text-on-default-background);\n",
       "}\n",
       "\n",
       "/* On hover, darken the color of the background */\n",
       "#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "/* Label box, darken color on hover, fitted */\n",
       "#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator label */\n",
       "\n",
       "#sk-container-id-1 div.sk-label label {\n",
       "  font-family: monospace;\n",
       "  font-weight: bold;\n",
       "  display: inline-block;\n",
       "  line-height: 1.2em;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-label-container {\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       "/* Estimator-specific */\n",
       "#sk-container-id-1 div.sk-estimator {\n",
       "  font-family: monospace;\n",
       "  border: 1px dotted var(--sklearn-color-border-box);\n",
       "  border-radius: 0.25em;\n",
       "  box-sizing: border-box;\n",
       "  margin-bottom: 0.5em;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-estimator.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "/* on hover */\n",
       "#sk-container-id-1 div.sk-estimator:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-1 div.sk-estimator.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Specification for estimator info (e.g. \"i\" and \"?\") */\n",
       "\n",
       "/* Common style for \"i\" and \"?\" */\n",
       "\n",
       ".sk-estimator-doc-link,\n",
       "a:link.sk-estimator-doc-link,\n",
       "a:visited.sk-estimator-doc-link {\n",
       "  float: right;\n",
       "  font-size: smaller;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1em;\n",
       "  height: 1em;\n",
       "  width: 1em;\n",
       "  text-decoration: none !important;\n",
       "  margin-left: 0.5em;\n",
       "  text-align: center;\n",
       "  /* unfitted */\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted,\n",
       "a:link.sk-estimator-doc-link.fitted,\n",
       "a:visited.sk-estimator-doc-link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "/* Span, style for the box shown on hovering the info icon */\n",
       ".sk-estimator-doc-link span {\n",
       "  display: none;\n",
       "  z-index: 9999;\n",
       "  position: relative;\n",
       "  font-weight: normal;\n",
       "  right: .2ex;\n",
       "  padding: .5ex;\n",
       "  margin: .5ex;\n",
       "  width: min-content;\n",
       "  min-width: 20ex;\n",
       "  max-width: 50ex;\n",
       "  color: var(--sklearn-color-text);\n",
       "  box-shadow: 2pt 2pt 4pt #999;\n",
       "  /* unfitted */\n",
       "  background: var(--sklearn-color-unfitted-level-0);\n",
       "  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted span {\n",
       "  /* fitted */\n",
       "  background: var(--sklearn-color-fitted-level-0);\n",
       "  border: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link:hover span {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       "/* \"?\"-specific style due to the `<a>` HTML tag */\n",
       "\n",
       "#sk-container-id-1 a.estimator_doc_link {\n",
       "  float: right;\n",
       "  font-size: 1rem;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1rem;\n",
       "  height: 1rem;\n",
       "  width: 1rem;\n",
       "  text-decoration: none;\n",
       "  /* unfitted */\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 a.estimator_doc_link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "#sk-container-id-1 a.estimator_doc_link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;prepcn&#x27;,\n",
       "                 ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;catord&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 (&#x27;catnom&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                                   OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  [&#x27;TUMOUR_CASE&#x27;,\n",
       "                                                   &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                                   &#x27;AXILLARY_FRECKLES&#x27;,\n",
       "                                                   &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                                   &#x27;LISCH_NODULES&#x27;,\n",
       "                                                   &#x27;DERMAL_NEURO...\n",
       "                                                   &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;,\n",
       "                                                   &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                                   &#x27;SKELETAL_DYSPLASIA&#x27;,\n",
       "                                                   &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                                   &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;,\n",
       "                                                   &#x27;SCOLIOSIS&#x27;,\n",
       "                                                   &#x27;OTHER_SYMPTOMS&#x27;])])),\n",
       "                (&#x27;prepstandard&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;transcaler&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;scaler&#x27;,\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.pipeline.Pipeline.html\">?<span>Documentation for Pipeline</span></a><span class=\"sk-estimator-doc-link \">i<span>Not fitted</span></span></div></label><div class=\"sk-toggleable__content \"><pre>Pipeline(steps=[(&#x27;prepcn&#x27;,\n",
       "                 ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;catord&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 (&#x27;catnom&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                                   OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  [&#x27;TUMOUR_CASE&#x27;,\n",
       "                                                   &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                                   &#x27;AXILLARY_FRECKLES&#x27;,\n",
       "                                                   &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                                   &#x27;LISCH_NODULES&#x27;,\n",
       "                                                   &#x27;DERMAL_NEURO...\n",
       "                                                   &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;,\n",
       "                                                   &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                                   &#x27;SKELETAL_DYSPLASIA&#x27;,\n",
       "                                                   &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                                   &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;,\n",
       "                                                   &#x27;SCOLIOSIS&#x27;,\n",
       "                                                   &#x27;OTHER_SYMPTOMS&#x27;])])),\n",
       "                (&#x27;prepstandard&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;transcaler&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;scaler&#x27;,\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>prepcn: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for prepcn: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content \"><pre>ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;catord&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                  OrdinalEncoder())]),\n",
       "                                 []),\n",
       "                                (&#x27;catnom&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                sparse_output=False))]),\n",
       "                                 [&#x27;TUMOUR_CASE&#x27;, &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                  &#x27;AXILLARY_FRECKLES&#x27;, &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                  &#x27;LISCH_NODULES&#x27;, &#x27;DERMAL_NEUROFIBROMINS&#x27;,\n",
       "                                  &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;, &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                  &#x27;SKELETAL_DYSPLASIA&#x27;, &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                  &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;, &#x27;SCOLIOSIS&#x27;,\n",
       "                                  &#x27;OTHER_SYMPTOMS&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>catord</div></div></label><div class=\"sk-toggleable__content \"><pre>[]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>OrdinalEncoder</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OrdinalEncoder.html\">?<span>Documentation for OrdinalEncoder</span></a></div></label><div class=\"sk-toggleable__content \"><pre>OrdinalEncoder()</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>catnom</div></div></label><div class=\"sk-toggleable__content \"><pre>[&#x27;TUMOUR_CASE&#x27;, &#x27;CAFE_AU_LAIT&#x27;, &#x27;AXILLARY_FRECKLES&#x27;, &#x27;INGUINAL_FRECKLES&#x27;, &#x27;LISCH_NODULES&#x27;, &#x27;DERMAL_NEUROFIBROMINS&#x27;, &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;, &#x27;OPTIC_GLIOMA&#x27;, &#x27;SKELETAL_DYSPLASIA&#x27;, &#x27;LEARNING_DISABILITY&#x27;, &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;, &#x27;SCOLIOSIS&#x27;, &#x27;OTHER_SYMPTOMS&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content \"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;, sparse_output=False)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>remainder</div></div></label><div class=\"sk-toggleable__content \"><pre></pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-8\" type=\"checkbox\" ><label for=\"sk-estimator-id-8\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>passthrough</div></div></label><div class=\"sk-toggleable__content \"><pre>passthrough</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-9\" type=\"checkbox\" ><label for=\"sk-estimator-id-9\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>prepstandard: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for prepstandard: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content \"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;transcaler&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler())]),\n",
       "                                 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,\n",
       "                                  14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,\n",
       "                                  25, 26, 27, 28, 29])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-10\" type=\"checkbox\" ><label for=\"sk-estimator-id-10\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>transcaler</div></div></label><div class=\"sk-toggleable__content \"><pre>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-11\" type=\"checkbox\" ><label for=\"sk-estimator-id-11\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link \" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content \"><pre>StandardScaler()</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-12\" type=\"checkbox\" ><label for=\"sk-estimator-id-12\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>remainder</div></div></label><div class=\"sk-toggleable__content \"><pre></pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator  sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-13\" type=\"checkbox\" ><label for=\"sk-estimator-id-13\" class=\"sk-toggleable__label  sk-toggleable__label-arrow\"><div><div>passthrough</div></div></label><div class=\"sk-toggleable__content \"><pre>passthrough</pre></div> </div></div></div></div></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "Pipeline(steps=[('prepcn',\n",
       "                 ColumnTransformer(n_jobs=-1, remainder='passthrough',\n",
       "                                   transformers=[('catord',\n",
       "                                                  Pipeline(steps=[('ordinal',\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 ('catnom',\n",
       "                                                  Pipeline(steps=[('onehot',\n",
       "                                                                   OneHotEncoder(handle_unknown='ignore',\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  ['TUMOUR_CASE',\n",
       "                                                   'CAFE_AU_LAIT',\n",
       "                                                   'AXILLARY_FRECKLES',\n",
       "                                                   'INGUINAL_FRECKLES',\n",
       "                                                   'LISCH_NODULES',\n",
       "                                                   'DERMAL_NEURO...\n",
       "                                                   'PLEXIFORM_NEUROFIBROMINS',\n",
       "                                                   'OPTIC_GLIOMA',\n",
       "                                                   'SKELETAL_DYSPLASIA',\n",
       "                                                   'LEARNING_DISABILITY',\n",
       "                                                   'ASTROCYTOMA', 'HAMARTOMA',\n",
       "                                                   'SCOLIOSIS',\n",
       "                                                   'OTHER_SYMPTOMS'])])),\n",
       "                ('prepstandard',\n",
       "                 ColumnTransformer(remainder='passthrough',\n",
       "                                   transformers=[('transcaler',\n",
       "                                                  Pipeline(steps=[('scaler',\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn import set_config\n",
    "\n",
    "# Opcional: para ver el diagrama bonito del pipeline\n",
    "set_config(display='diagram')\n",
    "\n",
    "# Construcción de Pipeline con transformadores\n",
    "pipe = Pipeline(steps=[\n",
    "    ('prepcn', preprocesorCategoricoNumericoConNombres),  # 1) categóricas → numéricas (One-Hot)\n",
    "    ('prepstandard', preprocesorStandardScaler)           # 2) escalado StandardScaler\n",
    "    # Si en lugar de StandardScaler quisieras MinMax, usas esta línea:\n",
    "    # ('prepminmax', preprocesorMinMax)\n",
    "])\n",
    "\n",
    "pipe\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fba555e1-f08a-4d54-9ce0-5d40a80fbf8a",
   "metadata": {},
   "source": [
    "En esta parte se construyeron los distintos preprocesadores:\n",
    "\n",
    "    Un ColumnTransformer que aplica:\n",
    "\n",
    "        OneHotEncoder a las variables categóricas nominales.\n",
    "\n",
    "        passthrough al resto de columnas (numéricas).\n",
    "\n",
    "    Un StandardScaler para estandarizar todas las variables resultantes.\n",
    "\n",
    "    Además, se dejó preparado un SimpleImputer y un MinMaxScaler por si se quisiera usar otras estrategias.\n",
    "\n",
    "El diagrama del pipeline muestra claramente dos bloques principales:\n",
    "\n",
    "    1.prepcn → transformación categórica (OneHot) + paso directo de numéricas.\n",
    "\n",
    "    2.prepstandard → estandarización de todas las columnas resultantes.\n",
    "\n",
    "Este resultado evidencia que el preprocesamiento está modularizado y listo para ser encadenado con un modelo de red neuronal."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fc05c3a6-8281-4e99-a804-67fbd4d3254c",
   "metadata": {},
   "source": [
    "### 1.6. Transformación de variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "169475f1-6943-430c-ab5b-7a0c7a797075",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "********** Pipeline aplicado\n",
      "********** Transformador categórico nominal:\n",
      "('catnom', Pipeline(steps=[('onehot',\n",
      "                 OneHotEncoder(handle_unknown='ignore', sparse_output=False))]), ['TUMOUR_CASE', 'CAFE_AU_LAIT', 'AXILLARY_FRECKLES', 'INGUINAL_FRECKLES', 'LISCH_NODULES', 'DERMAL_NEUROFIBROMINS', 'PLEXIFORM_NEUROFIBROMINS', 'OPTIC_GLIOMA', 'SKELETAL_DYSPLASIA', 'LEARNING_DISABILITY', 'ASTROCYTOMA', 'HAMARTOMA', 'SCOLIOSIS', 'OTHER_SYMPTOMS'])\n",
      "********** Cantidad de variables: 30\n",
      "********** Lista de variables:\n",
      "['TUMOUR_CASE_0', 'TUMOUR_CASE_1', 'CAFE_AU_LAIT_0', 'CAFE_AU_LAIT_1', 'AXILLARY_FRECKLES_0', 'AXILLARY_FRECKLES_1', 'INGUINAL_FRECKLES_0', 'INGUINAL_FRECKLES_1', 'LISCH_NODULES_0', 'LISCH_NODULES_1', 'DERMAL_NEUROFIBROMINS_0', 'DERMAL_NEUROFIBROMINS_1', 'PLEXIFORM_NEUROFIBROMINS_0', 'PLEXIFORM_NEUROFIBROMINS_1', 'OPTIC_GLIOMA_0', 'OPTIC_GLIOMA_1', 'SKELETAL_DYSPLASIA_0', 'SKELETAL_DYSPLASIA_1', 'LEARNING_DISABILITY_0', 'LEARNING_DISABILITY_1', 'ASTROCYTOMA_0', 'ASTROCYTOMA_1', 'HAMARTOMA_0', 'HAMARTOMA_1', 'SCOLIOSIS_0', 'SCOLIOSIS_1', 'OTHER_SYMPTOMS_0', 'OTHER_SYMPTOMS_1', 'AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TUMOUR_CASE_0</th>\n",
       "      <th>TUMOUR_CASE_1</th>\n",
       "      <th>CAFE_AU_LAIT_0</th>\n",
       "      <th>CAFE_AU_LAIT_1</th>\n",
       "      <th>AXILLARY_FRECKLES_0</th>\n",
       "      <th>AXILLARY_FRECKLES_1</th>\n",
       "      <th>INGUINAL_FRECKLES_0</th>\n",
       "      <th>INGUINAL_FRECKLES_1</th>\n",
       "      <th>LISCH_NODULES_0</th>\n",
       "      <th>LISCH_NODULES_1</th>\n",
       "      <th>...</th>\n",
       "      <th>ASTROCYTOMA_1</th>\n",
       "      <th>HAMARTOMA_0</th>\n",
       "      <th>HAMARTOMA_1</th>\n",
       "      <th>SCOLIOSIS_0</th>\n",
       "      <th>SCOLIOSIS_1</th>\n",
       "      <th>OTHER_SYMPTOMS_0</th>\n",
       "      <th>OTHER_SYMPTOMS_1</th>\n",
       "      <th>AGE_MOTHER</th>\n",
       "      <th>AGE_FIRST_DIAGNOSIS</th>\n",
       "      <th>CASE_TYPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-1.615474</td>\n",
       "      <td>1.615474</td>\n",
       "      <td>3.714835</td>\n",
       "      <td>-3.714835</td>\n",
       "      <td>1.070013</td>\n",
       "      <td>-1.070013</td>\n",
       "      <td>0.608581</td>\n",
       "      <td>-0.608581</td>\n",
       "      <td>0.624237</td>\n",
       "      <td>-0.624237</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.131081</td>\n",
       "      <td>0.222812</td>\n",
       "      <td>-0.222812</td>\n",
       "      <td>0.214328</td>\n",
       "      <td>-0.214328</td>\n",
       "      <td>-1.389494</td>\n",
       "      <td>1.389494</td>\n",
       "      <td>0.487692</td>\n",
       "      <td>-0.642048</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-1.615474</td>\n",
       "      <td>1.615474</td>\n",
       "      <td>-0.269191</td>\n",
       "      <td>0.269191</td>\n",
       "      <td>-0.934568</td>\n",
       "      <td>0.934568</td>\n",
       "      <td>0.608581</td>\n",
       "      <td>-0.608581</td>\n",
       "      <td>0.624237</td>\n",
       "      <td>-0.624237</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.131081</td>\n",
       "      <td>0.222812</td>\n",
       "      <td>-0.222812</td>\n",
       "      <td>0.214328</td>\n",
       "      <td>-0.214328</td>\n",
       "      <td>-1.389494</td>\n",
       "      <td>1.389494</td>\n",
       "      <td>-0.893992</td>\n",
       "      <td>-0.455364</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>-1.615474</td>\n",
       "      <td>1.615474</td>\n",
       "      <td>-0.269191</td>\n",
       "      <td>0.269191</td>\n",
       "      <td>-0.934568</td>\n",
       "      <td>0.934568</td>\n",
       "      <td>0.608581</td>\n",
       "      <td>-0.608581</td>\n",
       "      <td>0.624237</td>\n",
       "      <td>-0.624237</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.131081</td>\n",
       "      <td>0.222812</td>\n",
       "      <td>-0.222812</td>\n",
       "      <td>0.214328</td>\n",
       "      <td>-0.214328</td>\n",
       "      <td>-1.389494</td>\n",
       "      <td>1.389494</td>\n",
       "      <td>0.142271</td>\n",
       "      <td>-0.268679</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>-1.615474</td>\n",
       "      <td>1.615474</td>\n",
       "      <td>-0.269191</td>\n",
       "      <td>0.269191</td>\n",
       "      <td>-0.934568</td>\n",
       "      <td>0.934568</td>\n",
       "      <td>0.608581</td>\n",
       "      <td>-0.608581</td>\n",
       "      <td>-1.601957</td>\n",
       "      <td>1.601957</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.131081</td>\n",
       "      <td>0.222812</td>\n",
       "      <td>-0.222812</td>\n",
       "      <td>0.214328</td>\n",
       "      <td>-0.214328</td>\n",
       "      <td>-1.389494</td>\n",
       "      <td>1.389494</td>\n",
       "      <td>0.487692</td>\n",
       "      <td>-0.268679</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>-1.615474</td>\n",
       "      <td>1.615474</td>\n",
       "      <td>-0.269191</td>\n",
       "      <td>0.269191</td>\n",
       "      <td>-0.934568</td>\n",
       "      <td>0.934568</td>\n",
       "      <td>-1.643168</td>\n",
       "      <td>1.643168</td>\n",
       "      <td>0.624237</td>\n",
       "      <td>-0.624237</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.131081</td>\n",
       "      <td>0.222812</td>\n",
       "      <td>-0.222812</td>\n",
       "      <td>0.214328</td>\n",
       "      <td>-0.214328</td>\n",
       "      <td>-1.389494</td>\n",
       "      <td>1.389494</td>\n",
       "      <td>-0.030439</td>\n",
       "      <td>-1.015418</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   TUMOUR_CASE_0  TUMOUR_CASE_1  CAFE_AU_LAIT_0  CAFE_AU_LAIT_1  \\\n",
       "0      -1.615474       1.615474        3.714835       -3.714835   \n",
       "1      -1.615474       1.615474       -0.269191        0.269191   \n",
       "2      -1.615474       1.615474       -0.269191        0.269191   \n",
       "3      -1.615474       1.615474       -0.269191        0.269191   \n",
       "4      -1.615474       1.615474       -0.269191        0.269191   \n",
       "\n",
       "   AXILLARY_FRECKLES_0  AXILLARY_FRECKLES_1  INGUINAL_FRECKLES_0  \\\n",
       "0             1.070013            -1.070013             0.608581   \n",
       "1            -0.934568             0.934568             0.608581   \n",
       "2            -0.934568             0.934568             0.608581   \n",
       "3            -0.934568             0.934568             0.608581   \n",
       "4            -0.934568             0.934568            -1.643168   \n",
       "\n",
       "   INGUINAL_FRECKLES_1  LISCH_NODULES_0  LISCH_NODULES_1  ...  ASTROCYTOMA_1  \\\n",
       "0            -0.608581         0.624237        -0.624237  ...      -0.131081   \n",
       "1            -0.608581         0.624237        -0.624237  ...      -0.131081   \n",
       "2            -0.608581         0.624237        -0.624237  ...      -0.131081   \n",
       "3            -0.608581        -1.601957         1.601957  ...      -0.131081   \n",
       "4             1.643168         0.624237        -0.624237  ...      -0.131081   \n",
       "\n",
       "   HAMARTOMA_0  HAMARTOMA_1  SCOLIOSIS_0  SCOLIOSIS_1  OTHER_SYMPTOMS_0  \\\n",
       "0     0.222812    -0.222812     0.214328    -0.214328         -1.389494   \n",
       "1     0.222812    -0.222812     0.214328    -0.214328         -1.389494   \n",
       "2     0.222812    -0.222812     0.214328    -0.214328         -1.389494   \n",
       "3     0.222812    -0.222812     0.214328    -0.214328         -1.389494   \n",
       "4     0.222812    -0.222812     0.214328    -0.214328         -1.389494   \n",
       "\n",
       "   OTHER_SYMPTOMS_1  AGE_MOTHER  AGE_FIRST_DIAGNOSIS  CASE_TYPE  \n",
       "0          1.389494    0.487692            -0.642048          0  \n",
       "1          1.389494   -0.893992            -0.455364          0  \n",
       "2          1.389494    0.142271            -0.268679          1  \n",
       "3          1.389494    0.487692            -0.268679          0  \n",
       "4          1.389494   -0.030439            -1.015418          0  \n",
       "\n",
       "[5 rows x 31 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import copy\n",
    "import pandas as pd\n",
    "\n",
    "# ==============================\n",
    "# 1. Ejecutar el pipeline\n",
    "# ==============================\n",
    "\n",
    "# Trabajamos solo con las variables de entrada (X)\n",
    "dataframeTransformado = copy.deepcopy(dataframe)\n",
    "\n",
    "X_Transformado = pipe.fit_transform(dataframeTransformado)\n",
    "\n",
    "print('********** Pipeline aplicado')\n",
    "print('********** Transformador categórico nominal:')\n",
    "print(pipe.named_steps['prepcn'].transformers_[1])   # bloque 'catnom'\n",
    "\n",
    "# ==============================\n",
    "# 2. Obtener los nombres de columnas nuevas\n",
    "# ==============================\n",
    "\n",
    "cnamesDataset1 = []\n",
    "\n",
    "# (1) Si hubiera ordinales (en tu caso está vacío, pero lo dejamos general)\n",
    "if len(categorical_ordinal_features) != 0:\n",
    "    cnamesDataset1.extend(categorical_ordinal_features)\n",
    "\n",
    "# (2) Nombres creados por OneHotEncoder para las variables nominales\n",
    "if len(categorical_nominal_features) != 0:\n",
    "    cnamesDataset2 = (\n",
    "        pipe.named_steps['prepcn']        # ColumnTransformer\n",
    "            .transformers_[1][1]          # [1] = ('catnom', pipeline, columnas) → [1] es el Pipeline interno\n",
    "            .named_steps['onehot']        # dentro del Pipeline\n",
    "            .get_feature_names_out(categorical_nominal_features)\n",
    "    )\n",
    "    cnamesDataset1.extend(list(cnamesDataset2))\n",
    "\n",
    "# (3) Agregar las variables numéricas al final\n",
    "cnamesDataset3 = numeric_features\n",
    "cnamesDataset1.extend(cnamesDataset3)\n",
    "\n",
    "print('********** Cantidad de variables:', len(cnamesDataset1))\n",
    "print('********** Lista de variables:')\n",
    "print(cnamesDataset1)\n",
    "\n",
    "# ==============================\n",
    "# 3. Formar el DataFrame transformado\n",
    "# ==============================\n",
    "\n",
    "dataframeTransformado = pd.DataFrame(\n",
    "    data=X_Transformado,\n",
    "    columns=cnamesDataset1\n",
    ")\n",
    "\n",
    "# Guardar dataset SIN etiquetas (solo X)\n",
    "dataframeTransformado.to_csv(\n",
    "    \"NF1_DatasetTransformadoSinEtiquetas.csv\",\n",
    "    sep=\";\",\n",
    "    index=False\n",
    ")\n",
    "\n",
    "# Agregar la variable de salida (Y = CASE_TYPE) al final\n",
    "dataframeTransformado = pd.concat(\n",
    "    [dataframeTransformado, Y.reset_index(drop=True)],\n",
    "    axis=1\n",
    ")\n",
    "\n",
    "# Guardar dataset CON etiquetas (X + Y)\n",
    "dataframeTransformado.to_csv(\n",
    "    \"NF1_DatasetTransformadoConEtiquetas.csv\",\n",
    "    sep=\";\",\n",
    "    index=False\n",
    ")\n",
    "\n",
    "# Ver primeras filas\n",
    "dataframeTransformado.head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "19e32cd7-5cab-4659-85c8-2d77dd02fe28",
   "metadata": {},
   "source": [
    "### 1.7.Diseño de pipeline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "aa48408f-6c28-493d-b79f-f9824fc25054",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pickle\n",
    "\n",
    "# Función para guardar un Pipeline (o cualquier modelo entrenado)\n",
    "def guardarPipeline(pipeline, nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'wb') as handle:\n",
    "        pickle.dump(pipeline, handle, protocol=pickle.HIGHEST_PROTOCOL)\n",
    "    print(f\" Pipeline guardado como {nombreArchivo}.pickle\")\n",
    "\n",
    "# Función para cargar un Pipeline (o modelo) previamente guardado\n",
    "def cargarPipeline(nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'rb') as handle:\n",
    "        pipeline = pickle.load(handle)\n",
    "    print(f\" Pipeline cargado desde {nombreArchivo}.pickle\")\n",
    "    return pipeline\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "1fc0f460-4de1-4f99-b2ed-c89a40dc3cfe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Pipeline guardado como NF1_Pipeline_Preprocesamiento.pickle\n"
     ]
    }
   ],
   "source": [
    "# El pipe ya está \"fit\" porque usaste fit_transform\n",
    "guardarPipeline(pipe, \"NF1_Pipeline_Preprocesamiento\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "c7f080b5-ec3d-4c45-9fb4-48799c7f0dbe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Pipeline guardado como: NF1_pipePreprocesadores.pickle\n"
     ]
    }
   ],
   "source": [
    "import pickle\n",
    "\n",
    "# Función para guardar un pipeline\n",
    "def guardarPipeline(pipeline, nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'wb') as handle:\n",
    "        pickle.dump(pipeline, handle, protocol=pickle.HIGHEST_PROTOCOL)\n",
    "\n",
    "# 🔹 Nombre que usaremos SIEMPRE para este dataset\n",
    "nombreArchivoPreprocesador = 'NF1_pipePreprocesadores'\n",
    "\n",
    "# 🔹 Guardar tu pipeline 'pipe' en un archivo .pickle\n",
    "guardarPipeline(pipe, nombreArchivoPreprocesador)\n",
    "\n",
    "print(\" Pipeline guardado como:\", nombreArchivoPreprocesador + \".pickle\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e4da6d2-88c9-45f6-9113-f3f3fc90d3c3",
   "metadata": {},
   "source": [
    "## FASE 2: Entrenamiento base de una red neuronal\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9f1f18d3-a2fa-4db1-9716-7cb167a3f138",
   "metadata": {},
   "source": [
    "### 2.1.Carga de pipeline de preparación del conjunto de datos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "51fbb7f8-6d6e-4fe4-9e12-c890e873e9c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# FASE 2 - Celda 2.1\n",
    "# Imports extra y funciones para guardar / cargar\n",
    "\n",
    "import copy\n",
    "import pickle\n",
    "import joblib\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn import set_config\n",
    "\n",
    "# Función para cargar el pipeline de preprocesamiento desde disco (.pickle)\n",
    "def cargarPipeline(nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'rb') as handle:\n",
    "        pipeline = pickle.load(handle)\n",
    "    return pipeline\n",
    "\n",
    "# Guardar la red neuronal (pipeline + MLPClassifier) en un archivo .joblib\n",
    "def guardarNN(model, nombreArchivo):\n",
    "    print(\"Guardando Red Neuronal (pipeline con MLPClassifier) en archivo...\")\n",
    "    joblib.dump(model, nombreArchivo + '.joblib')\n",
    "    print(\"Red Neuronal guardada en\", nombreArchivo + '.joblib')\n",
    "\n",
    "# Cargar la red neuronal (pipeline + MLPClassifier) desde un .joblib\n",
    "def cargarNN(nombreArchivo):\n",
    "    print(\"Cargando Red Neuronal (pipeline con MLPClassifier) desde archivo...\")\n",
    "    model = joblib.load(nombreArchivo + '.joblib')\n",
    "    print(\"Red Neuronal cargada correctamente\")\n",
    "    return model\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "ffd2eab0-2fe7-4ac4-a1ae-4d3bf7cd19a8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape de X: (296, 16)\n",
      "Shape de Y: (296,)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split \n",
    "import copy\n",
    "\n",
    "# Y ya lo definiste en la Fase 1 como:\n",
    "# Y = df['CASE_TYPE']   (o dataframe_original['CASE_TYPE'])\n",
    "Yval = Y.values\n",
    "\n",
    "# X es tu dataframe de entrada YA SIN:\n",
    "# 'CASE_TYPE', 'AGE_FATHER', 'HYPERTENSION'\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "print(\"Shape de X:\", X.shape)\n",
    "print(\"Shape de Y:\", Yval.shape)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "847fc5cf-9ae3-4e28-aa2a-685230156aad",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Valores faltantes por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "\n",
      "Valores faltantes por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# ==============================\n",
    "# 2. Revisar y corregir NaN en X\n",
    "# ==============================\n",
    "\n",
    "print(\"\\nValores faltantes por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# Columnas numéricas con NaN en este dataset\n",
    "columnas_con_nan = ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']\n",
    "\n",
    "for col in columnas_con_nan:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"\\nValores faltantes por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "e77ab53e-36f1-4c46-9310-0efde80872ec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X_train: (236, 16)\n",
      "X_test : (60, 16)\n"
     ]
    }
   ],
   "source": [
    "# ==============================\n",
    "# 3. División 80% / 20%\n",
    "# ==============================\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X,\n",
    "    Yval,\n",
    "    test_size=0.2,\n",
    "    random_state=42,\n",
    "    stratify=Yval\n",
    ")\n",
    "\n",
    "print(\"X_train:\", X_train.shape)\n",
    "print(\"X_test :\", X_test.shape)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "1535ede1-82e2-4afe-a8aa-8901fae62676",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape de X: (296, 16)\n",
      "Shape de Y: (296,)\n",
      "\n",
      "Valores faltantes por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "\n",
      "Valores faltantes por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# FASE 2 - Celda 2.2\n",
    "# Definir X (entradas) e y (salida) y corregir NaN\n",
    "\n",
    "# y: variable de salida (CASE_TYPE), viene de la Fase 1\n",
    "Yval = Y.values\n",
    "\n",
    "# X: todas las variables de entrada (dataframe ya SIN CASE_TYPE, AGE_FATHER, HYPERTENSION)\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "print(\"Shape de X:\", X.shape)\n",
    "print(\"Shape de Y:\", Yval.shape)\n",
    "\n",
    "print(\"\\nValores faltantes por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# Imputación por la mediana en las columnas numéricas con NaN\n",
    "for col in ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"\\nValores faltantes por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "2c18b991-03d0-4210-b9f0-1bee6cb06bf5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cantidad de pasos en pipe_prep: 2\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-2 {\n",
       "  /* Definition of color scheme common for light and dark mode */\n",
       "  --sklearn-color-text: #000;\n",
       "  --sklearn-color-text-muted: #666;\n",
       "  --sklearn-color-line: gray;\n",
       "  /* Definition of color scheme for unfitted estimators */\n",
       "  --sklearn-color-unfitted-level-0: #fff5e6;\n",
       "  --sklearn-color-unfitted-level-1: #f6e4d2;\n",
       "  --sklearn-color-unfitted-level-2: #ffe0b3;\n",
       "  --sklearn-color-unfitted-level-3: chocolate;\n",
       "  /* Definition of color scheme for fitted estimators */\n",
       "  --sklearn-color-fitted-level-0: #f0f8ff;\n",
       "  --sklearn-color-fitted-level-1: #d4ebff;\n",
       "  --sklearn-color-fitted-level-2: #b3dbfd;\n",
       "  --sklearn-color-fitted-level-3: cornflowerblue;\n",
       "\n",
       "  /* Specific color for light theme */\n",
       "  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n",
       "  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n",
       "  --sklearn-color-icon: #696969;\n",
       "\n",
       "  @media (prefers-color-scheme: dark) {\n",
       "    /* Redefinition of color scheme for dark theme */\n",
       "    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n",
       "    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n",
       "    --sklearn-color-icon: #878787;\n",
       "  }\n",
       "}\n",
       "\n",
       "#sk-container-id-2 {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 pre {\n",
       "  padding: 0;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 input.sk-hidden--visually {\n",
       "  border: 0;\n",
       "  clip: rect(1px 1px 1px 1px);\n",
       "  clip: rect(1px, 1px, 1px, 1px);\n",
       "  height: 1px;\n",
       "  margin: -1px;\n",
       "  overflow: hidden;\n",
       "  padding: 0;\n",
       "  position: absolute;\n",
       "  width: 1px;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-dashed-wrapped {\n",
       "  border: 1px dashed var(--sklearn-color-line);\n",
       "  margin: 0 0.4em 0.5em 0.4em;\n",
       "  box-sizing: border-box;\n",
       "  padding-bottom: 0.4em;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-container {\n",
       "  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n",
       "     but bootstrap.min.css set `[hidden] { display: none !important; }`\n",
       "     so we also need the `!important` here to be able to override the\n",
       "     default hidden behavior on the sphinx rendered scikit-learn.org.\n",
       "     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n",
       "  display: inline-block !important;\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-text-repr-fallback {\n",
       "  display: none;\n",
       "}\n",
       "\n",
       "div.sk-parallel-item,\n",
       "div.sk-serial,\n",
       "div.sk-item {\n",
       "  /* draw centered vertical line to link estimators */\n",
       "  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n",
       "  background-size: 2px 100%;\n",
       "  background-repeat: no-repeat;\n",
       "  background-position: center center;\n",
       "}\n",
       "\n",
       "/* Parallel-specific style estimator block */\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel-item::after {\n",
       "  content: \"\";\n",
       "  width: 100%;\n",
       "  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n",
       "  flex-grow: 1;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel {\n",
       "  display: flex;\n",
       "  align-items: stretch;\n",
       "  justify-content: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  position: relative;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel-item {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel-item:first-child::after {\n",
       "  align-self: flex-end;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel-item:last-child::after {\n",
       "  align-self: flex-start;\n",
       "  width: 50%;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-parallel-item:only-child::after {\n",
       "  width: 0;\n",
       "}\n",
       "\n",
       "/* Serial-specific style estimator block */\n",
       "\n",
       "#sk-container-id-2 div.sk-serial {\n",
       "  display: flex;\n",
       "  flex-direction: column;\n",
       "  align-items: center;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  padding-right: 1em;\n",
       "  padding-left: 1em;\n",
       "}\n",
       "\n",
       "\n",
       "/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n",
       "clickable and can be expanded/collapsed.\n",
       "- Pipeline and ColumnTransformer use this feature and define the default style\n",
       "- Estimators will overwrite some part of the style using the `sk-estimator` class\n",
       "*/\n",
       "\n",
       "/* Pipeline and ColumnTransformer style (default) */\n",
       "\n",
       "#sk-container-id-2 div.sk-toggleable {\n",
       "  /* Default theme specific background. It is overwritten whether we have a\n",
       "  specific estimator or a Pipeline/ColumnTransformer */\n",
       "  background-color: var(--sklearn-color-background);\n",
       "}\n",
       "\n",
       "/* Toggleable label */\n",
       "#sk-container-id-2 label.sk-toggleable__label {\n",
       "  cursor: pointer;\n",
       "  display: flex;\n",
       "  width: 100%;\n",
       "  margin-bottom: 0;\n",
       "  padding: 0.5em;\n",
       "  box-sizing: border-box;\n",
       "  text-align: center;\n",
       "  align-items: start;\n",
       "  justify-content: space-between;\n",
       "  gap: 0.5em;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 label.sk-toggleable__label .caption {\n",
       "  font-size: 0.6rem;\n",
       "  font-weight: lighter;\n",
       "  color: var(--sklearn-color-text-muted);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 label.sk-toggleable__label-arrow:before {\n",
       "  /* Arrow on the left of the label */\n",
       "  content: \"▸\";\n",
       "  float: left;\n",
       "  margin-right: 0.25em;\n",
       "  color: var(--sklearn-color-icon);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {\n",
       "  color: var(--sklearn-color-text);\n",
       "}\n",
       "\n",
       "/* Toggleable content - dropdown */\n",
       "\n",
       "#sk-container-id-2 div.sk-toggleable__content {\n",
       "  max-height: 0;\n",
       "  max-width: 0;\n",
       "  overflow: hidden;\n",
       "  text-align: left;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-toggleable__content.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-toggleable__content pre {\n",
       "  margin: 0.2em;\n",
       "  border-radius: 0.25em;\n",
       "  color: var(--sklearn-color-text);\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-toggleable__content.fitted pre {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n",
       "  /* Expand drop-down */\n",
       "  max-height: 200px;\n",
       "  max-width: 100%;\n",
       "  overflow: auto;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n",
       "  content: \"▾\";\n",
       "}\n",
       "\n",
       "/* Pipeline/ColumnTransformer-specific style */\n",
       "\n",
       "#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator-specific style */\n",
       "\n",
       "/* Colorize estimator box */\n",
       "#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-label label.sk-toggleable__label,\n",
       "#sk-container-id-2 div.sk-label label {\n",
       "  /* The background is the default theme color */\n",
       "  color: var(--sklearn-color-text-on-default-background);\n",
       "}\n",
       "\n",
       "/* On hover, darken the color of the background */\n",
       "#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "/* Label box, darken color on hover, fitted */\n",
       "#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n",
       "  color: var(--sklearn-color-text);\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Estimator label */\n",
       "\n",
       "#sk-container-id-2 div.sk-label label {\n",
       "  font-family: monospace;\n",
       "  font-weight: bold;\n",
       "  display: inline-block;\n",
       "  line-height: 1.2em;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-label-container {\n",
       "  text-align: center;\n",
       "}\n",
       "\n",
       "/* Estimator-specific */\n",
       "#sk-container-id-2 div.sk-estimator {\n",
       "  font-family: monospace;\n",
       "  border: 1px dotted var(--sklearn-color-border-box);\n",
       "  border-radius: 0.25em;\n",
       "  box-sizing: border-box;\n",
       "  margin-bottom: 0.5em;\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-0);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-estimator.fitted {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-0);\n",
       "}\n",
       "\n",
       "/* on hover */\n",
       "#sk-container-id-2 div.sk-estimator:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-2);\n",
       "}\n",
       "\n",
       "#sk-container-id-2 div.sk-estimator.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-2);\n",
       "}\n",
       "\n",
       "/* Specification for estimator info (e.g. \"i\" and \"?\") */\n",
       "\n",
       "/* Common style for \"i\" and \"?\" */\n",
       "\n",
       ".sk-estimator-doc-link,\n",
       "a:link.sk-estimator-doc-link,\n",
       "a:visited.sk-estimator-doc-link {\n",
       "  float: right;\n",
       "  font-size: smaller;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1em;\n",
       "  height: 1em;\n",
       "  width: 1em;\n",
       "  text-decoration: none !important;\n",
       "  margin-left: 0.5em;\n",
       "  text-align: center;\n",
       "  /* unfitted */\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted,\n",
       "a:link.sk-estimator-doc-link.fitted,\n",
       "a:visited.sk-estimator-doc-link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",
       ".sk-estimator-doc-link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover,\n",
       "div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",
       ".sk-estimator-doc-link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "/* Span, style for the box shown on hovering the info icon */\n",
       ".sk-estimator-doc-link span {\n",
       "  display: none;\n",
       "  z-index: 9999;\n",
       "  position: relative;\n",
       "  font-weight: normal;\n",
       "  right: .2ex;\n",
       "  padding: .5ex;\n",
       "  margin: .5ex;\n",
       "  width: min-content;\n",
       "  min-width: 20ex;\n",
       "  max-width: 50ex;\n",
       "  color: var(--sklearn-color-text);\n",
       "  box-shadow: 2pt 2pt 4pt #999;\n",
       "  /* unfitted */\n",
       "  background: var(--sklearn-color-unfitted-level-0);\n",
       "  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link.fitted span {\n",
       "  /* fitted */\n",
       "  background: var(--sklearn-color-fitted-level-0);\n",
       "  border: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "\n",
       ".sk-estimator-doc-link:hover span {\n",
       "  display: block;\n",
       "}\n",
       "\n",
       "/* \"?\"-specific style due to the `<a>` HTML tag */\n",
       "\n",
       "#sk-container-id-2 a.estimator_doc_link {\n",
       "  float: right;\n",
       "  font-size: 1rem;\n",
       "  line-height: 1em;\n",
       "  font-family: monospace;\n",
       "  background-color: var(--sklearn-color-background);\n",
       "  border-radius: 1rem;\n",
       "  height: 1rem;\n",
       "  width: 1rem;\n",
       "  text-decoration: none;\n",
       "  /* unfitted */\n",
       "  color: var(--sklearn-color-unfitted-level-1);\n",
       "  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 a.estimator_doc_link.fitted {\n",
       "  /* fitted */\n",
       "  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n",
       "  color: var(--sklearn-color-fitted-level-1);\n",
       "}\n",
       "\n",
       "/* On hover */\n",
       "#sk-container-id-2 a.estimator_doc_link:hover {\n",
       "  /* unfitted */\n",
       "  background-color: var(--sklearn-color-unfitted-level-3);\n",
       "  color: var(--sklearn-color-background);\n",
       "  text-decoration: none;\n",
       "}\n",
       "\n",
       "#sk-container-id-2 a.estimator_doc_link.fitted:hover {\n",
       "  /* fitted */\n",
       "  background-color: var(--sklearn-color-fitted-level-3);\n",
       "}\n",
       "</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;prepcn&#x27;,\n",
       "                 ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;catord&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 (&#x27;catnom&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                                   OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  [&#x27;TUMOUR_CASE&#x27;,\n",
       "                                                   &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                                   &#x27;AXILLARY_FRECKLES&#x27;,\n",
       "                                                   &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                                   &#x27;LISCH_NODULES&#x27;,\n",
       "                                                   &#x27;DERMAL_NEURO...\n",
       "                                                   &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;,\n",
       "                                                   &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                                   &#x27;SKELETAL_DYSPLASIA&#x27;,\n",
       "                                                   &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                                   &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;,\n",
       "                                                   &#x27;SCOLIOSIS&#x27;,\n",
       "                                                   &#x27;OTHER_SYMPTOMS&#x27;])])),\n",
       "                (&#x27;prepstandard&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;transcaler&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;scaler&#x27;,\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-14\" type=\"checkbox\" ><label for=\"sk-estimator-id-14\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>Pipeline</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.pipeline.Pipeline.html\">?<span>Documentation for Pipeline</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>Pipeline(steps=[(&#x27;prepcn&#x27;,\n",
       "                 ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;catord&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 (&#x27;catnom&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                                   OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  [&#x27;TUMOUR_CASE&#x27;,\n",
       "                                                   &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                                   &#x27;AXILLARY_FRECKLES&#x27;,\n",
       "                                                   &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                                   &#x27;LISCH_NODULES&#x27;,\n",
       "                                                   &#x27;DERMAL_NEURO...\n",
       "                                                   &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;,\n",
       "                                                   &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                                   &#x27;SKELETAL_DYSPLASIA&#x27;,\n",
       "                                                   &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                                   &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;,\n",
       "                                                   &#x27;SCOLIOSIS&#x27;,\n",
       "                                                   &#x27;OTHER_SYMPTOMS&#x27;])])),\n",
       "                (&#x27;prepstandard&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;transcaler&#x27;,\n",
       "                                                  Pipeline(steps=[(&#x27;scaler&#x27;,\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-15\" type=\"checkbox\" ><label for=\"sk-estimator-id-15\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>prepcn: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for prepcn: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(n_jobs=-1, remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;catord&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;ordinal&#x27;,\n",
       "                                                  OrdinalEncoder())]),\n",
       "                                 []),\n",
       "                                (&#x27;catnom&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;onehot&#x27;,\n",
       "                                                  OneHotEncoder(handle_unknown=&#x27;ignore&#x27;,\n",
       "                                                                sparse_output=False))]),\n",
       "                                 [&#x27;TUMOUR_CASE&#x27;, &#x27;CAFE_AU_LAIT&#x27;,\n",
       "                                  &#x27;AXILLARY_FRECKLES&#x27;, &#x27;INGUINAL_FRECKLES&#x27;,\n",
       "                                  &#x27;LISCH_NODULES&#x27;, &#x27;DERMAL_NEUROFIBROMINS&#x27;,\n",
       "                                  &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;, &#x27;OPTIC_GLIOMA&#x27;,\n",
       "                                  &#x27;SKELETAL_DYSPLASIA&#x27;, &#x27;LEARNING_DISABILITY&#x27;,\n",
       "                                  &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;, &#x27;SCOLIOSIS&#x27;,\n",
       "                                  &#x27;OTHER_SYMPTOMS&#x27;])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-16\" type=\"checkbox\" ><label for=\"sk-estimator-id-16\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>catord</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-17\" type=\"checkbox\" ><label for=\"sk-estimator-id-17\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OrdinalEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OrdinalEncoder.html\">?<span>Documentation for OrdinalEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OrdinalEncoder()</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-18\" type=\"checkbox\" ><label for=\"sk-estimator-id-18\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>catnom</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;TUMOUR_CASE&#x27;, &#x27;CAFE_AU_LAIT&#x27;, &#x27;AXILLARY_FRECKLES&#x27;, &#x27;INGUINAL_FRECKLES&#x27;, &#x27;LISCH_NODULES&#x27;, &#x27;DERMAL_NEUROFIBROMINS&#x27;, &#x27;PLEXIFORM_NEUROFIBROMINS&#x27;, &#x27;OPTIC_GLIOMA&#x27;, &#x27;SKELETAL_DYSPLASIA&#x27;, &#x27;LEARNING_DISABILITY&#x27;, &#x27;ASTROCYTOMA&#x27;, &#x27;HAMARTOMA&#x27;, &#x27;SCOLIOSIS&#x27;, &#x27;OTHER_SYMPTOMS&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-19\" type=\"checkbox\" ><label for=\"sk-estimator-id-19\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>OneHotEncoder</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html\">?<span>Documentation for OneHotEncoder</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;, sparse_output=False)</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-20\" type=\"checkbox\" ><label for=\"sk-estimator-id-20\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>remainder</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[&#x27;AGE_MOTHER&#x27;, &#x27;AGE_FIRST_DIAGNOSIS&#x27;]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-21\" type=\"checkbox\" ><label for=\"sk-estimator-id-21\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>passthrough</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>passthrough</pre></div> </div></div></div></div></div></div></div><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-22\" type=\"checkbox\" ><label for=\"sk-estimator-id-22\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>prepstandard: ColumnTransformer</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html\">?<span>Documentation for prepstandard: ColumnTransformer</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;transcaler&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;scaler&#x27;, StandardScaler())]),\n",
       "                                 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,\n",
       "                                  14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,\n",
       "                                  25, 26, 27, 28, 29])])</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-23\" type=\"checkbox\" ><label for=\"sk-estimator-id-23\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>transcaler</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-24\" type=\"checkbox\" ><label for=\"sk-estimator-id-24\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>StandardScaler</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html\">?<span>Documentation for StandardScaler</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>StandardScaler()</pre></div> </div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-25\" type=\"checkbox\" ><label for=\"sk-estimator-id-25\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>remainder</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>[]</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-26\" type=\"checkbox\" ><label for=\"sk-estimator-id-26\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>passthrough</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>passthrough</pre></div> </div></div></div></div></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "Pipeline(steps=[('prepcn',\n",
       "                 ColumnTransformer(n_jobs=-1, remainder='passthrough',\n",
       "                                   transformers=[('catord',\n",
       "                                                  Pipeline(steps=[('ordinal',\n",
       "                                                                   OrdinalEncoder())]),\n",
       "                                                  []),\n",
       "                                                 ('catnom',\n",
       "                                                  Pipeline(steps=[('onehot',\n",
       "                                                                   OneHotEncoder(handle_unknown='ignore',\n",
       "                                                                                 sparse_output=False))]),\n",
       "                                                  ['TUMOUR_CASE',\n",
       "                                                   'CAFE_AU_LAIT',\n",
       "                                                   'AXILLARY_FRECKLES',\n",
       "                                                   'INGUINAL_FRECKLES',\n",
       "                                                   'LISCH_NODULES',\n",
       "                                                   'DERMAL_NEURO...\n",
       "                                                   'PLEXIFORM_NEUROFIBROMINS',\n",
       "                                                   'OPTIC_GLIOMA',\n",
       "                                                   'SKELETAL_DYSPLASIA',\n",
       "                                                   'LEARNING_DISABILITY',\n",
       "                                                   'ASTROCYTOMA', 'HAMARTOMA',\n",
       "                                                   'SCOLIOSIS',\n",
       "                                                   'OTHER_SYMPTOMS'])])),\n",
       "                ('prepstandard',\n",
       "                 ColumnTransformer(remainder='passthrough',\n",
       "                                   transformers=[('transcaler',\n",
       "                                                  Pipeline(steps=[('scaler',\n",
       "                                                                   StandardScaler())]),\n",
       "                                                  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n",
       "                                                   10, 11, 12, 13, 14, 15, 16,\n",
       "                                                   17, 18, 19, 20, 21, 22, 23,\n",
       "                                                   24, 25, 26, 27, 28,\n",
       "                                                   29])]))])"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# FASE 2 - Celda 2.3\n",
    "# Carga del pipeline NF1_pipePreprocesadores que hiciste en la Fase 1\n",
    "\n",
    "nombreArchivoPreprocesador = 'NF1_pipePreprocesadores'\n",
    "\n",
    "pipe_prep = cargarPipeline(nombreArchivoPreprocesador)\n",
    "\n",
    "cantidadPasos = len(pipe_prep.steps)\n",
    "print(\"Cantidad de pasos en pipe_prep:\", cantidadPasos)\n",
    "\n",
    "# Mostrar el diagrama del pipeline\n",
    "set_config(display='diagram')\n",
    "pipe_prep\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d5e9200-e250-455f-9920-56855a6b8041",
   "metadata": {},
   "source": [
    "En esta sección se cargó desde disco el pipeline de preprocesamiento guardado como NF1_pipePreprocesadores.pickle.\n",
    "El mensaje de salida muestra la cantidad de pasos (normalmente 2: prepcn y prepstandard) y el diagrama confirma que el pipeline está intacto. Esto permite reutilizar exactamente las mismas transformaciones aplicadas en la Fase 1, asegurando coherencia entre entrenamiento y validación."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c759c2e-3b2d-4c20-8c03-df013553e2e0",
   "metadata": {},
   "source": [
    "### 2.2.Creación de la Red Neuronal"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "27b4ceb9-4242-4610-8bc3-3d8c73a621ce",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'prepcn': ColumnTransformer(n_jobs=-1, remainder='passthrough',\n",
      "                  transformers=[('catord',\n",
      "                                 Pipeline(steps=[('ordinal',\n",
      "                                                  OrdinalEncoder())]),\n",
      "                                 []),\n",
      "                                ('catnom',\n",
      "                                 Pipeline(steps=[('onehot',\n",
      "                                                  OneHotEncoder(handle_unknown='ignore',\n",
      "                                                                sparse_output=False))]),\n",
      "                                 ['TUMOUR_CASE', 'CAFE_AU_LAIT',\n",
      "                                  'AXILLARY_FRECKLES', 'INGUINAL_FRECKLES',\n",
      "                                  'LISCH_NODULES', 'DERMAL_NEUROFIBROMINS',\n",
      "                                  'PLEXIFORM_NEUROFIBROMINS', 'OPTIC_GLIOMA',\n",
      "                                  'SKELETAL_DYSPLASIA', 'LEARNING_DISABILITY',\n",
      "                                  'ASTROCYTOMA', 'HAMARTOMA', 'SCOLIOSIS',\n",
      "                                  'OTHER_SYMPTOMS'])]), 'prepstandard': ColumnTransformer(remainder='passthrough',\n",
      "                  transformers=[('transcaler',\n",
      "                                 Pipeline(steps=[('scaler', StandardScaler())]),\n",
      "                                 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,\n",
      "                                  14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,\n",
      "                                  25, 26, 27, 28, 29])])}\n"
     ]
    }
   ],
   "source": [
    "# Imprime los pasos del pipeline para verificar el nombre del paso con el modelo\n",
    "print(pipeNN.named_steps)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "502ca65d-e081-4eca-8c09-2ecdd9388f4e",
   "metadata": {},
   "source": [
    "Antes de entrenar la red, se revisaron los valores NaN en las columnas numéricas (AGE_MOTHER y AGE_FIRST_DIAGNOSIS) y se imputaron usando la mediana de cada variable.\n",
    "El resumen “ANTES / DESPUÉS de imputar” muestra que los NaN fueron eliminados. Esto es crucial porque MLPClassifier no acepta valores faltantes y el error que salía anteriormente se corrige con este paso."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b4331700-e12a-4691-840e-eafc3b0aa93e",
   "metadata": {},
   "source": [
    "### 2.3.Entrenamiento de la Red Neuronal"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "3453084f-3546-4f5e-acf9-390647746dff",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape de X: (296, 16)\n",
      "Shape de Y: (296,)\n",
      "\n",
      "Valores faltantes por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "\n",
      "Valores faltantes por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n",
      "X_train: (236, 16)\n",
      "X_test : (60, 16)\n",
      "Pasos de pipeNN: ['prepcn', 'prepstandard', 'modelNN']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (10) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Modelo base entrenado\n",
      "Guardando Red Neuronal (pipeline con MLPClassifier) en archivo...\n",
      "Red Neuronal guardada en NF1_modeloRedNeuronalBase.joblib\n",
      " Modelo Base Guardado\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAjsAAAHFCAYAAAAUpjivAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAT/hJREFUeJzt3XlYVGX/P/D3yDIssqMgPAiYiBggLqViimSCez6m5A5mZrkUuJCmJpJCYSL+8nErEzVNM5fM1MRQknBH3MMlFEwRV1BRQLh/f3hxvo4DyMCM4PH9uq65Luc+9znnc87MHN6ec58ZhRBCgIiIiEim6tR0AURERES6xLBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsPMcxMfHQ6FQlPmYOHFiTZdXq7i4uCAkJETn6+nUqRM6deqk8/U8KSIiAgqF4rmuU8727NkDhUKBPXv21HQpZXper/fChQsRHx+v8/WUel6f0arKz89HRERErX1f6EJISAhcXFx0uo4rV64gIiICaWlpOl2PrujXdAEvk+XLl6Np06YqbQ4ODjVUTe20adMmmJub13QZRNX2/vvvo2vXrjpfz8KFC2Fra1urA8jzlJ+fj5kzZwLAc/8PTU2ZPn06PvnkE52u48qVK5g5cyZcXFzg4+Oj03XpAsPOc+Tp6YnWrVtXqm9RUREUCgX09V+ul6hFixY1XQKRVvznP//Bf/7zn5oug54hPz8fJiYmNV1Gtbzyyis1XUKtx8tYtUDp6fhVq1ZhwoQJcHR0hFKpxPnz5wEAu3btQufOnWFubg4TExO0b98ef/zxh9py/v77bwwcOBB2dnZQKpVo2LAhhg0bhoKCAgDln1Yvvcx28eJFlfZ169ahXbt2MDU1Rd26dREYGIijR4+q9AkJCUHdunVx/vx5dO/eHXXr1oWTkxMmTJggrbdUQUEBIiMj4eHhASMjI9jY2MDf3x8pKSlSn6dPkT98+BATJkyAj48PLCwsYG1tjXbt2uGXX36p1L4VQiAmJgbOzs4wMjJCy5YtsX379jL75uXlYeLEiXB1dYWhoSEcHR0RGhqK+/fvV2pdO3bsQOfOnWFhYQETExN4eHggOjq6wnnWrVuHgIAANGjQAMbGxvDw8MDkyZPV1vnPP/9gwIABcHBwgFKphJ2dHTp37qx2Srkyr1lll1WWw4cPo3fv3rC2toaRkRFatGiBn376SaVP6ftp9+7d+Oijj2BrawsbGxv07dsXV65ceeY6KrseTfz777/44IMP4OTkBENDQzg4OKBfv364du2a1CczMxNDhgxB/fr1oVQq4eHhgblz56KkpETqc/HiRSgUCnz99deIjY2Fq6sr6tati3bt2mH//v0q6yzr86ZQKBAREaFW39Pv+8ruQxcXF5w6dQpJSUnSpfEnL2dUZpvKU1RUhPDwcNjb28PExARvvPEGDh48WGbf7OxsjBo1Cv/5z39gaGgIV1dXzJw5E48ePXrmegDtHWsuXryIevXqAQBmzpwp7ZPSfVv6mqSmpqJfv36wsrKSgoIQAgsXLoSPjw+MjY1hZWWFfv364Z9//lGpo1OnTvD09MShQ4fQoUMHmJiYoFGjRvjyyy9V9qsmxy6FQoGxY8di+fLlcHd3h7GxMVq3bo39+/dDCIE5c+ZI77U333xT+tvw5L55+jKWNrdnz549eO211wAAw4cPl/brk+/lLVu2oF27djAxMYGZmRm6dOmCffv2lfuaP3eCdG758uUCgNi/f78oKipSeQghxO7duwUA4ejoKPr16ye2bNkitm7dKm7evClWrVolFAqF6NOnj9i4caP49ddfRc+ePYWenp7YtWuXtI60tDRRt25d4eLiIhYvXiz++OMP8cMPP4igoCCRl5cnhBBixowZoqyXvLS+jIwMqW327NlCoVCI9957T2zdulVs3LhRtGvXTpiamopTp05J/YKDg4WhoaHw8PAQX3/9tdi1a5f4/PPPhUKhEDNnzpT6FRUVCX9/f6Gvry8mTpwotm3bJrZs2SI+++wz8eOPP0r9nJ2dRXBwsPT8zp07IiQkRKxatUokJiaKHTt2iIkTJ4o6deqIFStWPHPfl27ziBEjxPbt28XSpUuFo6OjsLe3F35+flK/+/fvCx8fH2FraytiY2PFrl27xPz584WFhYV48803RUlJSYXr+e6774RCoRCdOnUSa9asEbt27RILFy4Uo0ePVqvlSV988YWYN2+e+O2338SePXvE4sWLhaurq/D391fp5+7uLho3bixWrVolkpKSxIYNG8SECRPE7t27pT6Vfc0qs6yyJCYmCkNDQ9GhQwexbt06sWPHDhESEiIAiOXLl0v9St9PjRo1EuPGjRO///67+O6774SVlZXadlVnPaWfm2fVffnyZdGgQQOV13bdunXivffeE2fOnBFCCJGTkyMcHR1FvXr1xOLFi8WOHTvE2LFjBQDx0UcfScvKyMgQAISLi4vo2rWr2Lx5s9i8ebPw8vISVlZW4s6dO1Lfsl5vAGLGjBlqNT79vq/sPkxNTRWNGjUSLVq0EPv27RP79u0TqampGm1TeYKDg4VCoRCTJk0SO3fuFLGxscLR0VGYm5ur1Hr16lXh5OQknJ2dxZIlS8SuXbvEF198IZRKpQgJCXnmerR5rHn48KHYsWOH9Jkv3Sfnz59XeU2cnZ3Fp59+KhISEsTmzZuFEEKMHDlSGBgYiAkTJogdO3aINWvWiKZNmwo7OzuRnZ0t1eHn5ydsbGyEm5ubWLx4sUhISBCjR48WAFSOSZocu0pr8vX1FRs3bhSbNm0STZo0EdbW1iIsLEy8/fbbYuvWrWL16tXCzs5OeHt7qxyTgoODhbOzs8oytbk9ubm50nty2rRp0n7NysoSQgixevVqAUAEBASIzZs3i3Xr1olWrVoJQ0NDsXfv3me+B54Hhp3noPRNUtajqKhIOmh37NhRZb779+8La2tr0atXL5X24uJi0bx5c/H6669LbW+++aawtLQUOTk55dZR2bCTmZkp9PX1xbhx41T63b17V9jb24ugoCCpLTg4WAAQP/30k0rf7t27C3d3d+n5ypUrBQDx7bffllufEOoH/ac9evRIFBUViREjRogWLVpUuKzbt28LIyMj8d///lel/a+//hIAVMJOdHS0qFOnjjh06JBK359//lkAENu2bSt3PXfv3hXm5ubijTfeqDAUlbf/S5WUlIiioiKRlJQkAIhjx44JIYS4ceOGACDi4uLKnbeyr1llllWepk2bihYtWkghvVTPnj1FgwYNRHFxsRDi/95PTwY9IYSIiYkRAMTVq1e1sp7Khp333ntPGBgYiNOnT5fbZ/LkyQKAOHDggEr7Rx99JBQKhUhPTxdC/F/Y8fLyEo8ePZL6HTx4UABQCe7aCDuV2YevvvqqyntZ020qy5kzZwQAERYWptJe+kftyVpHjRol6tatKy5duqTS9+uvvxYAVALL03RxrLl+/Xq5+7n0Nfn8889V2vft2ycAiLlz56q0Z2VlCWNjYxEeHi61+fn5lblfmzVrJgIDA8vd1oqOXQCEvb29uHfvntS2efNmAUD4+PioHFfi4uIEAHH8+HGp7emwo4vtOXTokNp/OIR4/PfIwcFBeHl5SZ9NIR6/hvXr1xe+vr7l7pPniZexnqOVK1fi0KFDKo8nx+S88847Kv1TUlJw69YtBAcH49GjR9KjpKQEXbt2xaFDh3D//n3k5+cjKSkJQUFB0inc6vj999/x6NEjDBs2TGW9RkZG8PPzU7vLQaFQoFevXipt3t7euHTpkvR8+/btMDIywnvvvadxPevXr0f79u1Rt25d6Ovrw8DAAMuWLcOZM2cqnG/fvn14+PAhBg8erNLu6+sLZ2dnlbatW7fC09MTPj4+KtscGBj4zDt+UlJSkJeXh9GjR2t8980///yDQYMGwd7eHnp6ejAwMICfnx8ASNtnbW2NV155BXPmzEFsbCyOHj2qdhmisq9ZZZZVlvPnz+Pvv/+W9uWT6+jevTuuXr2K9PR0lXl69+6t8tzb2xsAVN4X2ljPs2zfvh3+/v7w8PAot09iYiKaNWuG119/XaU9JCQEQggkJiaqtPfo0QN6enoabVtVVGUfltJ0m560e/duAFD77AQFBamNI9y6dSv8/f3h4OCg8np169YNAJCUlFTuenRxrKmMp4+1W7duhUKhwJAhQ1TqsLe3R/PmzdXqsLe3V9uvZdWhybHL398fpqam0vPS92u3bt1Ujiul7RVts662pyzp6em4cuUKhg4dijp1/i9S1K1bF++88w7279+P/Pz8Zy5H116u0a81zMPDo8IByg0aNFB5XjqeoF+/fuXOc+vWLdSpUwfFxcVaGwxZut7Sa7RPe/INDQAmJiYwMjJSaVMqlXj48KH0/Pr163BwcFCb91k2btyIoKAg9O/fH5MmTYK9vT309fWxaNEifP/99xXOe/PmTQCPP8hPe7rt2rVrOH/+PAwMDMpc1o0bN8pdz/Xr1wFA4/1/7949dOjQAUZGRpg1axaaNGkCExMTZGVloW/fvnjw4AGAxwf4P/74A5GRkYiJicGECRNgbW2NwYMHY/bs2TAzM6v0a1aZZZWldPkTJ04s9+sSnt5HNjY2Ks+VSiUASNulrfU8y/Xr15/52ty8ebPMW3dL75YsfS+Vqsq2VUV11qPpNj09L6D+OdHX11er6dq1a/j111+r9NnRxbGmMso61gohYGdnV2b/Ro0aqTx/eh+U1vHk66Lpscva2lrluaGhYYXtFW2zLranPKXvlaf3KfD4vVZSUoLbt2/X+CBwhp1a5OmzAra2tgCAb775Bm3bti1zHjs7OxQXF0NPTw+XL1+ucPmlB4mCggLpoAmoH4xK1/vzzz+rnQGpqnr16iE5ORklJSUaBZ4ffvgBrq6uWLduncr+eXrwc1lKP8DZ2dlq07Kzs1X+ENja2sLY2LjcAFW6T8pSejbtWfv/aYmJibhy5Qr27Nkjnc0BgDt37qj1dXZ2xrJlywAAZ8+exU8//YSIiAgUFhZi8eLFGr1mz1pWWUqXP2XKFPTt27fMPu7u7hVvcCXoYj316tV75mtjY2ODq1evqrWXDgau6PXXhFKpLPO9W1HwqKrqbNOTnx1HR0ep/dGjR2q12trawtvbG7Nnzy5zWRV9vYYujjWVUdaxVqFQYO/evSrHxlJltT1LdY5d1aWL7SlP6XulvPdanTp1YGVlpbX1VRXDTi3Wvn17WFpa4vTp0xg7dmyFff38/LB+/XrMnj273INY6R/348ePq/xP6tdff1XpFxgYCH19fVy4cEHtdG9VdevWDT/++CPi4+M1upSlUChgaGiocrDIzs6u1N1Ybdu2hZGREVavXq2yHSkpKbh06ZJK2OnZsyeioqJgY2MDV1fXStcHPL4sZmFhgcWLF2PAgAGVvpRV2u/pA8+SJUsqnK9JkyaYNm0aNmzYgNTUVABVf83KWlZZ3N3d4ebmhmPHjiEqKqrSy9eULtbTrVs3rFq1Cunp6eUGpc6dOyM6Ohqpqalo2bKl1L5y5UooFAr4+/trpRYXFxccP35cpS0xMRH37t2r8jLL+x94dbap9PtpVq9ejVatWkntP/30k9odVj179sS2bdvwyiuvaPxHTRfHmqqcZevZsye+/PJL/PvvvwgKCtJKHdU5dlWXLranvP3q7u4OR0dHrFmzBhMnTpS29/79+9iwYYN0h1ZNY9ipxerWrYtvvvkGwcHBuHXrFvr164f69evj+vXrOHbsGK5fv45FixYBAGJjY/HGG2+gTZs2mDx5Mho3boxr165hy5YtWLJkCczMzNC9e3dYW1tjxIgRiIyMhL6+PuLj45GVlaWyXhcXF0RGRmLq1Kn4559/0LVrV1hZWeHatWs4ePAgTE1NpS/tqqyBAwdi+fLl+PDDD5Geng5/f3+UlJTgwIED8PDwwIABA8qcr2fPnti4cSNGjx6Nfv36ISsrC1988QUaNGiAc+fOVbhOKysrTJw4EbNmzcL777+P/v37IysrCxEREWqn50NDQ7FhwwZ07NgRYWFh8Pb2RklJCTIzM7Fz505MmDABbdq0KXM9devWxdy5c/H+++/jrbfewsiRI2FnZ4fz58/j2LFjWLBgQZnz+fr6wsrKCh9++CFmzJgBAwMDrF69GseOHVPpd/z4cYwdOxb9+/eHm5sbDA0NkZiYiOPHj2Py5MkAKv+aVWZZ5VmyZAm6deuGwMBAhISEwNHREbdu3cKZM2eQmpqK9evXVzh/ZWl7PZGRkdi+fTs6duyIzz77DF5eXrhz5w527NiB8ePHo2nTpggLC8PKlSvRo0cPREZGwtnZGb/99hsWLlyIjz76CE2aNNHKtg0dOhTTp0/H559/Dj8/P5w+fRoLFiyAhYVFlZfp5eWFtWvXYt26dWjUqBGMjIzg5eVVrW3y8PDAkCFDEBcXBwMDA7z11ls4efIkvv76a7Uv/YyMjERCQgJ8fX3x8ccfw93dHQ8fPsTFixexbds2LF68uNzLiLo41piZmcHZ2Rm//PILOnfuDGtra9ja2lb4DcPt27fHBx98gOHDh+Pw4cPo2LEjTE1NcfXqVSQnJ8PLywsfffSRRnVU59hVXbrYnldeeQXGxsZYvXo1PDw8ULduXTg4OMDBwQExMTEYPHgwevbsiVGjRqGgoABz5szBnTt38OWXX+poKzVUs+OjXw6ld1Y8fadPqdK7StavX1/m9KSkJNGjRw9hbW0tDAwMhKOjo+jRo4da/9OnT4v+/fsLGxsbYWhoKBo2bChCQkLEw4cPpT4HDx4Uvr6+wtTUVDg6OooZM2aI7777Tu3WcyEe3w3g7+8vzM3NhVKpFM7OzqJfv34qt7wHBwcLU1NTtZrLuhPlwYMH4vPPPxdubm7C0NBQ2NjYiDfffFOkpKRIfcq6G+vLL78ULi4uQqlUCg8PD/Htt98+886mUiUlJSI6Olo4OTkJQ0ND4e3tLX799Vfh5+endgfLvXv3xLRp04S7u7swNDQUFhYWwsvLS4SFhancqlmebdu2CT8/P2FqaipMTExEs2bNxFdffVXhPklJSRHt2rUTJiYmol69euL9998XqampKnc9XLt2TYSEhIimTZsKU1NTUbduXeHt7S3mzZunckeQEM9+zTRZVlmOHTsmgoKCRP369YWBgYGwt7cXb775pli8eLHUp7z3e2XvnqrsejRZXlZWlnjvvfeEvb29MDAwEA4ODiIoKEhcu3ZN6nPp0iUxaNAgYWNjIwwMDIS7u7uYM2eOyh0mpXdjzZkzR20deOoOoLJe74KCAhEeHi6cnJyEsbGx8PPzE2lpaeXejVWZfXjx4kUREBAgzMzMpFuYNdmm8hQUFIgJEyaI+vXrCyMjI9G2bVuxb9++Mj+j169fFx9//LFwdXUVBgYGwtraWrRq1UpMnTpV5Q6j8mj7WLNr1y7RokULoVQqVe4eK+17/fr1Muv4/vvvRZs2bYSpqakwNjYWr7zyihg2bJg4fPiw1MfPz0+8+uqravOWdft3ZY9dAMSYMWNU2sp7r5X196Ksdetie3788UfRtGlTYWBgoPZ+37x5s2jTpo0wMjISpqamonPnzuKvv/5SW25NUQghxPOLVkREL4ewsDCsWrVK4wHVRKR9vIxFRKRFOTk52LdvHzZu3Ih27drVdDlEBP5cBBGRVm3btg2DBw+Gm5sb5s+fX9PlEBEAXsYiIiIiWeOZHSIiIpI1hh0iIiKSNQ5QBlBSUoIrV67AzMxM4982IiIiopohhMDdu3ef+XNEDDt4/JXWTk5ONV0GERERVUFWVlaFv4HHsANIP36YlZWl9u2gREREVDvl5eXBycmp3B8xLsWwg//7jSJzc3OGHSIiohfMs4agcIAyERERyRrDDhEREckaww4RERHJGsMOERERyRrDDhEREckaww4RERHJGsMOERERyRrDDhEREckaww4RERHJGsMOERERyRrDDhEREckaww4RERHJGsMOERERyRrDDhEREckaww4RERHJmn5NF/AyaTVpZU2XQFTrHJkzrKZLICKZ45kdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpK1Gg07f/75J3r16gUHBwcoFAps3rxZmlZUVIRPP/0UXl5eMDU1hYODA4YNG4YrV66oLKOgoADjxo2Dra0tTE1N0bt3b1y+fPk5bwkRERHVVjUadu7fv4/mzZtjwYIFatPy8/ORmpqK6dOnIzU1FRs3bsTZs2fRu3dvlX6hoaHYtGkT1q5di+TkZNy7dw89e/ZEcXHx89oMIiIiqsX0a3Ll3bp1Q7du3cqcZmFhgYSEBJW2b775Bq+//joyMzPRsGFD5ObmYtmyZVi1ahXeeustAMAPP/wAJycn7Nq1C4GBgTrfBiIiIqrdXqgxO7m5uVAoFLC0tAQAHDlyBEVFRQgICJD6ODg4wNPTEykpKeUup6CgAHl5eSoPIiIikqcXJuw8fPgQkydPxqBBg2Bubg4AyM7OhqGhIaysrFT62tnZITs7u9xlRUdHw8LCQno4OTnptHYiIiKqOS9E2CkqKsKAAQNQUlKChQsXPrO/EAIKhaLc6VOmTEFubq70yMrK0ma5REREVIvU+rBTVFSEoKAgZGRkICEhQTqrAwD29vYoLCzE7du3VebJycmBnZ1ductUKpUwNzdXeRAREZE81eqwUxp0zp07h127dsHGxkZleqtWrWBgYKAykPnq1as4efIkfH19n3e5REREVAvV6N1Y9+7dw/nz56XnGRkZSEtLg7W1NRwcHNCvXz+kpqZi69atKC4ulsbhWFtbw9DQEBYWFhgxYgQmTJgAGxsbWFtbY+LEifDy8pLuziIiIqKXW42GncOHD8Pf3196Pn78eABAcHAwIiIisGXLFgCAj4+Pyny7d+9Gp06dAADz5s2Dvr4+goKC8ODBA3Tu3Bnx8fHQ09N7LttAREREtZtCCCFquoialpeXBwsLC+Tm5up0/E6rSSt1tmyiF9WROcNqugQiekFV9u93rR6zQ0RERFRdDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQka/o1XQARkRy0mrSypksgqnWOzBlW0yUA4JkdIiIikjmGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpI1hh0iIiKSNYYdIiIikjWGHSIiIpK1Gg07f/75J3r16gUHBwcoFAps3rxZZboQAhEREXBwcICxsTE6deqEU6dOqfQpKCjAuHHjYGtrC1NTU/Tu3RuXL19+jltBREREtVmNhp379++jefPmWLBgQZnTY2JiEBsbiwULFuDQoUOwt7dHly5dcPfuXalPaGgoNm3ahLVr1yI5ORn37t1Dz549UVxc/Lw2g4iIiGox/Zpcebdu3dCtW7cypwkhEBcXh6lTp6Jv374AgBUrVsDOzg5r1qzBqFGjkJubi2XLlmHVqlV46623AAA//PADnJycsGvXLgQGBj63bSEiIqLaqdaO2cnIyEB2djYCAgKkNqVSCT8/P6SkpAAAjhw5gqKiIpU+Dg4O8PT0lPqUpaCgAHl5eSoPIiIikqdaG3ays7MBAHZ2dirtdnZ20rTs7GwYGhrCysqq3D5liY6OhoWFhfRwcnLScvVERERUW9TasFNKoVCoPBdCqLU97Vl9pkyZgtzcXOmRlZWllVqJiIio9qm1Ycfe3h4A1M7Q5OTkSGd77O3tUVhYiNu3b5fbpyxKpRLm5uYqDyIiIpKnWht2XF1dYW9vj4SEBKmtsLAQSUlJ8PX1BQC0atUKBgYGKn2uXr2KkydPSn2IiIjo5Vajd2Pdu3cP58+fl55nZGQgLS0N1tbWaNiwIUJDQxEVFQU3Nze4ubkhKioKJiYmGDRoEADAwsICI0aMwIQJE2BjYwNra2tMnDgRXl5e0t1ZRERE9HKr0bBz+PBh+Pv7S8/Hjx8PAAgODkZ8fDzCw8Px4MEDjB49Grdv30abNm2wc+dOmJmZSfPMmzcP+vr6CAoKwoMHD9C5c2fEx8dDT0/vuW8PERER1T4KIYSo6SJqWl5eHiwsLJCbm6vT8TutJq3U2bKJXlRH5gyr6RK0gp9vInW6/nxX9u93rR2zQ0RERKQNDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrGoed1NRUnDhxQnr+yy+/oE+fPvjss89QWFio1eKIiIiIqkvjsDNq1CicPXsWAPDPP/9gwIABMDExwfr16xEeHq71AomIiIiqQ+Owc/bsWfj4+AAA1q9fj44dO2LNmjWIj4/Hhg0btF0fERERUbVoHHaEECgpKQEA7Nq1C927dwcAODk54caNG9qtjoiIiKiaNA47rVu3xqxZs7Bq1SokJSWhR48eAB7/YrmdnZ3WCyQiIiKqDo3DTlxcHFJTUzF27FhMnToVjRs3BgD8/PPP8PX11XqBRERERNWhr+kM3t7eKndjlZozZw709PS0UhQRERGRtlTpe3bu3LmD7777DlOmTMGtW7cAAKdPn0ZOTo5WiyMiIiKqLo3P7Bw/fhydO3eGpaUlLl68iJEjR8La2hqbNm3CpUuXsHLlSl3USURERFQlGp/ZGT9+PIYPH45z587ByMhIau/WrRv+/PNPrRZHREREVF0ah51Dhw5h1KhRau2Ojo7Izs7WSlFERERE2qJx2DEyMkJeXp5ae3p6OurVq6eVooiIiIi0ReOw8/bbbyMyMhJFRUUAAIVCgczMTEyePBnvvPOO1gskIiIiqg6Nw87XX3+N69evo379+njw4AH8/PzQuHFjmJmZYfbs2bqokYiIiKjKNL4by9zcHMnJyUhMTERqaipKSkrQsmVLvPXWW7qoj4iIiKhaNA47K1euxLvvvos333wTb775ptReWFiItWvXYtiwYVotkIiIiKg6NL6MNXz4cOTm5qq13717F8OHD9dKUURERETaUqVfPVcoFGrtly9fhoWFhVaKIiIiItKWSl/GatGiBRQKBRQKBTp37gx9/f+btbi4GBkZGejatatOiiQiIiKqqkqHnT59+gAA0tLSEBgYiLp160rTDA0N4eLiwlvPiYiIqNapdNiZMWMGAMDFxQXvvvuuyk9FEBEREdVWGt+NFRwcDODx3Vc5OTkoKSlRmd6wYUPtVEZERESkBRqHnXPnzuG9995DSkqKSnvpwOXi4mKtFUdERERUXRqHnZCQEOjr62Pr1q1o0KBBmXdmEREREdUWGoedtLQ0HDlyBE2bNtVFPURERERapfH37DRr1gw3btzQRS1EREREWqdx2Pnqq68QHh6OPXv24ObNm8jLy1N5EBEREdUmGl/GKv3Bz86dO6u0c4AyERER1UYah53du3frog4iIiIindA47Pj5+emiDiIiIiKd0HjMDgDs3bsXQ4YMga+vL/79918AwKpVq5CcnKzV4oiIiIiqS+Ows2HDBgQGBsLY2BipqakoKCgAANy9exdRUVFaL5CIiIioOjQOO7NmzcLixYvx7bffwsDAQGr39fVFamqqVosjIiIiqi6Nw056ejo6duyo1m5ubo47d+5ooyYiIiIirdE47DRo0ADnz59Xa09OTkajRo20UhQRERGRtmgcdkaNGoVPPvkEBw4cgEKhwJUrV7B69WpMnDgRo0eP1kWNRERERFWm8a3n4eHhyM3Nhb+/Px4+fIiOHTtCqVRi4sSJGDt2rC5qJCIiIqqyKt16Pnv2bNy4cQMHDx7E/v37cf36dXzxxRfarg2PHj3CtGnT4OrqCmNjYzRq1AiRkZEoKSmR+gghEBERAQcHBxgbG6NTp044deqU1mshIiKiF5PGZ3ZKmZiYoHXr1tqsRc1XX32FxYsXY8WKFXj11Vdx+PBhDB8+HBYWFvjkk08AADExMYiNjUV8fDyaNGmCWbNmoUuXLkhPT4eZmZlO6yMiIqLar1Jhp2/fvoiPj4e5uTn69u1bYd+NGzdqpTAA2LdvH95++2306NEDAODi4oIff/wRhw8fBvD4rE5cXBymTp0q1bVixQrY2dlhzZo1GDVqlNZqISIiohdTpS5jWVhYQKFQSP+u6KFNb7zxBv744w+cPXsWAHDs2DEkJyeje/fuAICMjAxkZ2cjICBAmkepVMLPzw8pKSnlLregoIC/1k5ERPSSqNSZneXLl5f5b1379NNPkZubi6ZNm0JPTw/FxcWYPXs2Bg4cCADIzs4GANjZ2anMZ2dnh0uXLpW73OjoaMycOVN3hRMREVGtofEA5YyMDJw7d06t/dy5c7h48aI2apKsW7cOP/zwA9asWYPU1FSsWLECX3/9NVasWKHSr/SsUykhhFrbk6ZMmYLc3FzpkZWVpdW6iYiIqPbQOOyEhISUeYnowIEDCAkJ0UZNkkmTJmHy5MkYMGAAvLy8MHToUISFhSE6OhoAYG9vD+D/zvCUysnJUTvb8ySlUglzc3OVBxEREcmTxmHn6NGjaN++vVp727ZtkZaWpo2aJPn5+ahTR7VEPT096dZzV1dX2NvbIyEhQZpeWFiIpKQk+Pr6arUWIiIiejFpfOu5QqHA3bt31dpzc3NRXFyslaJK9erVC7Nnz0bDhg3x6quv4ujRo4iNjcV7770n1RIaGoqoqCi4ubnBzc0NUVFRMDExwaBBg7RaCxEREb2YNA47HTp0QHR0NH788Ufo6ekBAIqLixEdHY033nhDq8V98803mD59OkaPHo2cnBw4ODhg1KhR+Pzzz6U+4eHhePDgAUaPHo3bt2+jTZs22LlzJ79jh4iIiAAACiGE0GSG06dPo2PHjrC0tESHDh0AAHv37kVeXh4SExPh6empk0J1KS8vDxYWFsjNzdXp+J1Wk1bqbNlEL6ojc4bVdAlawc83kTpdf74r+/db4zE7zZo1w/HjxxEUFIScnBzcvXsXw4YNw99///1CBh0iIiKStyr9XISDgwOioqK0XQsRERGR1lX5t7Hy8/ORmZmJwsJClXZvb+9qF0VERESkLRqHnevXr2P48OHYvn17mdO1fUcWERERUXVoPGYnNDQUt2/fxv79+2FsbIwdO3ZgxYoVcHNzw5YtW3RRIxEREVGVaXxmJzExEb/88gtee+011KlTB87OzujSpQvMzc0RHR0t/UI5ERERUW2g8Zmd+/fvo379+gAAa2trXL9+HQDg5eWF1NRU7VZHREREVE0ahx13d3ekp6cDAHx8fLBkyRL8+++/WLx4MRo0aKD1AomIiIiqQ+PLWKGhobh69SoAYMaMGQgMDMTq1athaGiI+Ph4bddHREREVC0ah53BgwdL/27RogUuXryIv//+Gw0bNoStra1WiyMiIiKqrip/zw4ACCFgbGyMli1baqseIiIiIq3SeMwOACxbtgyenp4wMjKCkZERPD098d1332m7NiIiIqJq0/jMzvTp0zFv3jyMGzcO7dq1AwDs27cPYWFhuHjxImbNmqX1IomIiIiqSuOws2jRInz77bcYOHCg1Na7d294e3tj3LhxDDtERERUq2h8Gau4uBitW7dWa2/VqhUePXqklaKIiIiItEXjsDNkyBAsWrRIrX3p0qUqd2oRERER1QZVuhtr2bJl2LlzJ9q2bQsA2L9/P7KysjBs2DCMHz9e6hcbG6udKomIiIiqSOOwc/LkSelW8wsXLgAA6tWrh3r16uHkyZNSP4VCoaUSiYiIiKpO47Cze/duXdRBREREpBNV+p4dIiIiohcFww4RERHJGsMOERERyRrDDhEREckaww4RERHJWpXCzqpVq9C+fXs4ODjg0qVLAIC4uDj88ssvWi2OiIiIqLo0DjuLFi3C+PHj0b17d9y5cwfFxcUAAEtLS8TFxWm7PiIiIqJq0TjsfPPNN/j2228xdepU6OnpSe2tW7fGiRMntFocERERUXVpHHYyMjLQokULtXalUon79+9rpSgiIiIibdE47Li6uiItLU2tffv27WjWrJk2aiIiIiLSGo1/LmLSpEkYM2YMHj58CCEEDh48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RESkDZUKOz4+PsjOzkb9+vXh4+MDhUIBIYRaP4VCwS8VJCIiolqlUmEnIyMD9erVk/5NRERE9KKoVNhxdnaW/n3p0iX4+vpCX1911kePHiElJUWlLxEREVFN0/huLH9/f9y6dUutPTc3F/7+/lopioiIiEhbNA47QogyfxT05s2bMDU11UpRRERERNpS6VvP+/btC+DxIOSQkBAolUppWnFxMY4fPw5fX1/tV0hERERUDZUOOxYWFgAen9kxMzODsbGxNM3Q0BBt27bFyJEjtV8hERERUTVUOuwsX74cAODi4oKJEyfykhURERG9EDT+BuUZM2boog4iIiIindB4gPK1a9cwdOhQODg4QF9fH3p6eioPIiIiotpE4zM7ISEhyMzMxPTp09GgQYMy78wiIiIiqi00DjvJycnYu3cvfHx8dFAOERERkXZpfBnLycmpzN/FIiIiIqqNNA47cXFxmDx5Mi5evKiDcoiIiIi0S+PLWO+++y7y8/PxyiuvwMTEBAYGBirTy/opCSIiIqKaonHYiYuL00EZRERERLqhcdgJDg7WRR1EREREOqFx2HnSgwcPUFRUpNJmbm5erYKIiIiItEnjAcr379/H2LFjUb9+fdStWxdWVlYqDyIiIqLaROOwEx4ejsTERCxcuBBKpRLfffcdZs6cCQcHB6xcuVIXNRIRERFVmcaXsX799VesXLkSnTp1wnvvvYcOHTqgcePGcHZ2xurVqzF48GBd1ElERERUJRqf2bl16xZcXV0BPB6fU3qr+RtvvIE///xTu9URERERVZPGYadRo0bSFwo2a9YMP/30E4DHZ3wsLS21WRsRERFRtWkcdoYPH45jx44BAKZMmSKN3QkLC8OkSZO0XiARERFRdWg8ZicsLEz6t7+/P/7++28cPnwYr7zyCpo3b67V4oiIiIiqq1rfswMADRs2RMOGDbVRCxEREZHWVfoyVmJiIpo1a4a8vDy1abm5uXj11Vexd+9erRb3tOjoaCgUCoSGhkptQghERETAwcEBxsbG6NSpE06dOqXTOoiIiOjFUemwExcXh5EjR5b5DckWFhYYNWoUYmNjtVrckw4dOoSlS5fC29tbpT0mJgaxsbFYsGABDh06BHt7e3Tp0gV3797VWS1ERET04qh02Dl27Bi6du1a7vSAgAAcOXJEK0U97d69exg8eDC+/fZblW9pFkIgLi4OU6dORd++feHp6YkVK1YgPz8fa9as0UktRERE9GKpdNi5du0aDAwMyp2ur6+P69eva6Wop40ZMwY9evTAW2+9pdKekZGB7OxsBAQESG1KpRJ+fn5ISUkpd3kFBQXIy8tTeRAREZE8VTrsODo64sSJE+VOP378OBo0aKCVop60du1apKamIjo6Wm1adnY2AMDOzk6l3c7OTppWlujoaFhYWEgPJycn7RZNREREtUalw0737t3x+eef4+HDh2rTHjx4gBkzZqBnz55aLS4rKwuffPIJfvjhBxgZGZXbT6FQqDwXQqi1PWnKlCnIzc2VHllZWVqrmYiIiGqXSt96Pm3aNGzcuBFNmjTB2LFj4e7uDoVCgTNnzuB///sfiouLMXXqVK0Wd+TIEeTk5KBVq1ZSW3FxMf78808sWLAA6enpAB6f4XnyrFJOTo7a2Z4nKZVKKJVKrdZKREREtVOlw46dnR1SUlLw0UcfYcqUKRBCAHh8ViUwMBALFy6sMGBURefOndUunQ0fPhxNmzbFp59+ikaNGsHe3h4JCQlo0aIFAKCwsBBJSUn46quvtFoLERERvZg0+lJBZ2dnbNu2Dbdv38b58+chhICbm5vKHVLaZGZmBk9PT5U2U1NT2NjYSO2hoaGIioqCm5sb3NzcEBUVBRMTEwwaNEgnNREREdGLpUrfoGxlZYXXXntN27VUSXh4OB48eIDRo0fj9u3baNOmDXbu3AkzM7OaLo2IiIhqgWr/XMTztmfPHpXnCoUCERERiIiIqJF6iIiIqHbT+FfPiYiIiF4kDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtEREQkaww7REREJGsMO0RERCRrDDtE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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "import copy\n",
    "\n",
    "# ==============================\n",
    "# 1. Definir X e y (igual que en el ejemplo)\n",
    "# ==============================\n",
    "\n",
    "# y: variable de salida (tipo de caso)\n",
    "Yval = Y.values   # Y viene de la fase 1: Y = dataframe_original['CASE_TYPE']\n",
    "\n",
    "# X: todas las variables de entrada (dataframe ya SIN CASE_TYPE, AGE_FATHER, HYPERTENSION)\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "print(\"Shape de X:\", X.shape)\n",
    "print(\"Shape de Y:\", Yval.shape)\n",
    "\n",
    "# ==============================\n",
    "# 2. Imputar valores faltantes en columnas numéricas\n",
    "# ==============================\n",
    "\n",
    "print(\"\\nValores faltantes por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "for col in ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"\\nValores faltantes por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# ==============================\n",
    "# 3. Partición entrenamiento / prueba (80% / 20%)\n",
    "# ==============================\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X,\n",
    "    Yval,\n",
    "    test_size=0.2,\n",
    "    random_state=42,\n",
    "    stratify=Yval\n",
    ")\n",
    "\n",
    "print(\"X_train:\", X_train.shape)\n",
    "print(\"X_test :\", X_test.shape)\n",
    "\n",
    "# ==============================\n",
    "# 4. Crear una copia del pipeline de preprocesamiento\n",
    "#    (el que cargaste desde NF1_pipePreprocesadores.pickle)\n",
    "# ==============================\n",
    "\n",
    "pipeNN = copy.deepcopy(pipe)   # pipe tiene: prepcn + prepstandard\n",
    "\n",
    "# ==============================\n",
    "# 5. Definir la \"Red Neuronal\" (MLPClassifier)\n",
    "#    Aquí se ven los análogos de optimizer, epochs y batch_size\n",
    "# ==============================\n",
    "\n",
    "modelNN = MLPClassifier(\n",
    "    hidden_layer_sizes=(4,),  # capas ocultas\n",
    "    activation='logistic',\n",
    "    solver='adam',               # ≈ optimizer\n",
    "    batch_size=16,               # ≈ batch_size\n",
    "    max_iter=10,                # ≈ epochs\n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "# ==============================\n",
    "# 6. Añadir el modelo como último paso del pipeline\n",
    "#    (equivalente a pipe.steps.append(['modelNN', model]) del ejemplo)\n",
    "# ==============================\n",
    "\n",
    "pipeNN.steps.append(('modelNN', modelNN))\n",
    "\n",
    "print(\"Pasos de pipeNN:\", [name for name, _ in pipeNN.steps])\n",
    "\n",
    "# ==============================\n",
    "# 7. Entrenar el pipeline completo\n",
    "# ==============================\n",
    "\n",
    "pipeNN.fit(X_train, y_train)\n",
    "print(' Modelo base entrenado')\n",
    "\n",
    "# ==============================\n",
    "# 8. Guardar el modelo entrenado\n",
    "# ==============================\n",
    "\n",
    "guardarNN(pipeNN, 'NF1_modeloRedNeuronalBase')\n",
    "print(' Modelo Base Guardado')\n",
    "\n",
    "# ==============================\n",
    "# 9. Gráfico de frecuencia de clases en entrenamiento\n",
    "# ==============================\n",
    "\n",
    "sns.countplot(x=y_train)\n",
    "plt.xlabel('CASE_TYPE (0 = esporádico, 1 = familiar)')\n",
    "plt.ylabel('Cantidad de pacientes')\n",
    "plt.title('Frecuencia de clases en el conjunto de entrenamiento')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7ed0f185-ac14-48ef-9d1e-0ec3b033add5",
   "metadata": {},
   "source": [
    "Se dividió el dataset en:\n",
    "\n",
    "80% para entrenamiento (X_train, y_train),\n",
    "\n",
    "20% para prueba (X_test, y_test),\n",
    "\n",
    "utilizando stratify=Yval para mantener la misma proporción de casos esporádicos y familiares en ambas particiones.\n",
    "El shape de cada matriz confirma que la división se realizó correctamente y que el tamaño de los datos es adecuado para entrenar el modelo."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "369460d5-a44f-4740-935d-6d25c694ffcd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy en test: 0.5666666666666667\n",
      "\n",
      "Matriz de confusión:\n",
      " [[33  0]\n",
      " [26  1]]\n",
      "\n",
      "Reporte de clasificación:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           0       0.56      1.00      0.72        33\n",
      "           1       1.00      0.04      0.07        27\n",
      "\n",
      "    accuracy                           0.57        60\n",
      "   macro avg       0.78      0.52      0.39        60\n",
      "weighted avg       0.76      0.57      0.43        60\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n",
    "\n",
    "y_pred = pipeNN.predict(X_test)\n",
    "\n",
    "print(\"Accuracy en test:\", accuracy_score(y_test, y_pred))\n",
    "print(\"\\nMatriz de confusión:\\n\", confusion_matrix(y_test, y_pred))\n",
    "print(\"\\nReporte de clasificación:\\n\", classification_report(y_test, y_pred))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2d84519e-3155-46ee-bee1-44d98d3205cd",
   "metadata": {},
   "source": [
    "Aquí se definió el modelo de red neuronal usando MLPClassifier con:\n",
    "\n",
    "    Capas ocultas: (4,) neuronas,\n",
    "    \n",
    "    Función de activación: logistic (funcion signoidal),\n",
    "    \n",
    "    Optimizador: adam, (es debido que no se pudo con la funcion RMSprop para que el modelo sea compatible con el MLPClassifier de sklearn.)\n",
    "    \n",
    "    batch_size = 16,\n",
    "    \n",
    "    max_iter = 10 (equivalente a epochs).\n",
    "\n",
    "Luego se construyó pipeNN con tres pasos:\n",
    "\n",
    "    1.prepcn → OneHot Encoder + passthrough,\n",
    "    \n",
    "    2.prepstandard → StandardScaler,\n",
    "    \n",
    "    3.modelNN → MLPClassifier.\n",
    "\n",
    "La lista de pasos y el diagrama muestran que el modelo de red neuronal está correctamente integrado al final del pipeline de preprocesamiento, tal como pide la práctica."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a00b25cf-41c6-4fa5-af88-aa9f49a74c91",
   "metadata": {},
   "source": [
    "### 2.3.Predicción con modelo base y evaluación de calidad: MAE, MSE, RMSE, Accuracy, Precision, Recall y F1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "e8324a5d-9881-411f-992d-35ef9e44370d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>real</th>\n",
       "      <th>prediccion</th>\n",
       "      <th>prob_clase_1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.391677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.431806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.443549</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.386802</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.442858</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.488683</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.452098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.328227</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.412355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.446586</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.503385</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.436865</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.473456</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.480272</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.434979</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.445706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.490759</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.402425</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.423595</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.419052</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    real  prediccion  prob_clase_1\n",
       "0      0           0      0.391677\n",
       "1      0           0      0.431806\n",
       "2      0           0      0.443549\n",
       "3      0           0      0.386802\n",
       "4      0           0      0.442858\n",
       "5      0           0      0.488683\n",
       "6      0           0      0.452098\n",
       "7      0           0      0.328227\n",
       "8      1           0      0.412355\n",
       "9      0           0      0.446586\n",
       "10     1           1      0.503385\n",
       "11     0           0      0.436865\n",
       "12     0           0      0.473456\n",
       "13     1           0      0.480272\n",
       "14     1           0      0.434979\n",
       "15     1           0      0.445706\n",
       "16     1           0      0.490759\n",
       "17     0           0      0.402425\n",
       "18     1           0      0.423595\n",
       "19     1           0      0.419052"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "from sklearn.metrics import (\n",
    "    mean_absolute_error,\n",
    "    mean_squared_error,\n",
    "    accuracy_score,\n",
    "    precision_score,\n",
    "    recall_score,\n",
    "    f1_score\n",
    ")\n",
    "\n",
    "# ==============================\n",
    "# 1. Predicción con el modelo base\n",
    "# ==============================\n",
    "\n",
    "# pipeNN es tu pipeline entrenado (prepcn + prepstandard + modelNN)\n",
    "y_pred = pipeNN.predict(X_test)          # ya devuelve 0 o 1 directamente\n",
    "\n",
    "# Si también quieres las probabilidades (por ejemplo, para ver el umbral 0.5)\n",
    "y_prob = pipeNN.predict_proba(X_test)[:, 1]   # prob de clase 1\n",
    "\n",
    "# DataFrame con valores reales vs predichos\n",
    "dataframeFinal = pd.DataFrame({\n",
    "    'real': y_test,\n",
    "    'prediccion': y_pred,\n",
    "    'prob_clase_1': y_prob\n",
    "})\n",
    "\n",
    "np.set_printoptions(formatter={'float': lambda X: \"{0:0.0f}\".format(X)})\n",
    "dataframeFinal.head(20)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b254576e-309c-4f86-a306-8188031b542e",
   "metadata": {},
   "source": [
    "Se ajustó el pipeline completo con pipeNN.fit(X_train, y_train) y luego se evaluó con pipeNN.predict(X_test).\n",
    "Las métricas calculadas (MAE, MSE, RMSE, Accuracy, Precision, Recall, F1 y matriz de confusión) permiten:\n",
    "\n",
    "Ver qué tan bien distingue el modelo entre casos familiares y esporádicos.\n",
    "\n",
    "Detectar posibles errores del tipo falso positivo y falso negativo.\n",
    "\n",
    "Confirmar si el modelo base tiene un desempeño razonable o si necesita optimización.\n",
    "\n",
    "Aunque los valores exactos dependen de la ejecución, en general un accuracy moderado y un F1 aceptable indican que el modelo base captura cierta información relevante, pero aún tiene margen de mejora."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "33fabafe-783a-4689-9bdf-bea1ffe724ca",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mean Absolute Error (MAE): 0.4333\n",
      "Mean Squared Error (MSE): 0.4333\n",
      "Root Mean Squared Error (RMSE): 0.6583\n",
      "Accuracy: 0.5667\n",
      "Confusion_matrix:\n",
      "[[33  0]\n",
      " [26  1]]\n",
      "33 0 26 1\n",
      "Precision: 1.0\n",
      "Recall   : 0.037\n",
      "F1       : 0.0714\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "from sklearn import metrics\n",
    "from sklearn.metrics import (\n",
    "    accuracy_score,\n",
    "    confusion_matrix,\n",
    "    precision_score,\n",
    "    recall_score,\n",
    "    f1_score\n",
    ")\n",
    "\n",
    "# y_pred viene de tu modelo:\n",
    "# y_pred = pipeNN.predict(X_test)\n",
    "\n",
    "# ---- Errores tipo regresión (con etiquetas 0/1) ----\n",
    "MAE  = metrics.mean_absolute_error(y_test, y_pred)\n",
    "MSE  = metrics.mean_squared_error(y_test, y_pred)\n",
    "RMSE = np.sqrt(metrics.mean_squared_error(y_test, y_pred))\n",
    "accuracy = accuracy_score(y_test, y_pred)\n",
    "\n",
    "MAE  = str(round(MAE, 4))\n",
    "MSE  = str(round(MSE, 4))\n",
    "RMSE = str(round(RMSE, 4))\n",
    "\n",
    "print('Mean Absolute Error (MAE):', MAE)  \n",
    "print('Mean Squared Error (MSE):', MSE)  \n",
    "print('Root Mean Squared Error (RMSE):', RMSE) \n",
    "print('Accuracy:', round(accuracy,4)) \n",
    "\n",
    "# ---- Matriz de confusión ----\n",
    "print('Confusion_matrix:')\n",
    "y_test_transformado = y_test\n",
    "y_pred_transformado = y_pred\n",
    "\n",
    "cm = confusion_matrix(y_test_transformado, y_pred_transformado)  \n",
    "print(cm)  \n",
    "tn, fp, fn, tp = cm.ravel()\n",
    "print(tn, fp, fn, tp)\n",
    "\n",
    "# ---- Precision, Recall, F1 ----\n",
    "precision = precision_score(y_test_transformado, y_pred_transformado)\n",
    "recall    = recall_score(y_test_transformado, y_pred_transformado)\n",
    "f1        = f1_score(y_test_transformado, y_pred_transformado)\n",
    "\n",
    "print('Precision:', round(precision,4))\n",
    "print('Recall   :', round(recall,4))\n",
    "print('F1       :', round(f1,4))\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ee0c38de-3e0f-423c-9e22-26c2816c809f",
   "metadata": {},
   "source": [
    "El modelo entrenado se guardó con guardarNN(pipeNN, 'NF1_modeloRedNeuronalBase') en un archivo .joblib.\n",
    "Esto deja disponible una versión estable del modelo base que se puede recargar más adelante para comparación con el modelo optimizado o para realizar predicciones sin tener que reentrenar."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3f5c8196-df1a-4323-9f8c-0e0000c471d9",
   "metadata": {},
   "source": [
    "## FASE 3: Optimización del modelo de red neuronal (Fine Tuning con MLFLOW)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "830d45fb-480f-4e8f-ac5f-02de286d4a70",
   "metadata": {},
   "source": [
    "### 3.1.Evaluación de modelo base: promedio de N experimentos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "cbd1b449-44bc-4f69-b68a-be9076148173",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Pasos del pipeline de preprocesamiento:\n",
      "['prepcn', 'prepstandard']\n",
      "Shape de X completo: (296, 16)\n",
      "Shape de Y completo: (296,)\n",
      "Pasos en pipeCV: ['prepcn', 'prepstandard', 'modelNN']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025/12/12 14:52:23 INFO mlflow.store.db.utils: Creating initial MLflow database tables...\n",
      "2025/12/12 14:52:23 INFO mlflow.store.db.utils: Updating database tables\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Context impl SQLiteImpl.\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Will assume non-transactional DDL.\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade  -> 451aebb31d03, add metric step\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 451aebb31d03 -> 90e64c465722, migrate user column to tags\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 90e64c465722 -> 181f10493468, allow nulls for metric values\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 181f10493468 -> df50e92ffc5e, Add Experiment Tags Table\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade df50e92ffc5e -> 7ac759974ad8, Update run tags with larger limit\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 7ac759974ad8 -> 89d4b8295536, create latest metrics table\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 89d4b8295536 -> 2b4d017a5e9b, add model registry tables to db\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 2b4d017a5e9b -> cfd24bdc0731, Update run status constraint with killed\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade cfd24bdc0731 -> 0a8213491aaa, drop_duplicate_killed_constraint\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 0a8213491aaa -> 728d730b5ebd, add registered model tags table\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 728d730b5ebd -> 27a6a02d2cf1, add model version tags table\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 27a6a02d2cf1 -> 84291f40a231, add run_link to model_version\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 84291f40a231 -> a8c4a736bde6, allow nulls for run_id\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade a8c4a736bde6 -> 39d1c3be5f05, add_is_nan_constraint_for_metrics_tables_if_necessary\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 39d1c3be5f05 -> c48cb773bb87, reset_default_value_for_is_nan_in_metrics_table_for_mysql\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade c48cb773bb87 -> bd07f7e963c5, create index on run_uuid\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade bd07f7e963c5 -> 0c779009ac13, add deleted_time field to runs table\n",
      "2025/12/12 14:52:23 INFO alembic.runtime.migration: Running upgrade 0c779009ac13 -> cc1f77228345, change param value length to 500\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade cc1f77228345 -> 97727af70f4d, Add creation_time and last_update_time to experiments table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 97727af70f4d -> 3500859a5d39, Add Model Aliases table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 3500859a5d39 -> 7f2a7d5fae7d, add datasets inputs input_tags tables\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 7f2a7d5fae7d -> 2d6e25af4d3e, increase max param val length from 500 to 8000\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 2d6e25af4d3e -> acf3f17fdcc7, add storage location field to model versions\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade acf3f17fdcc7 -> 867495a8f9d4, add trace tables\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 867495a8f9d4 -> 5b0e9adcef9c, add cascade deletion to trace tables foreign keys\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 5b0e9adcef9c -> 4465047574b1, increase max dataset schema size\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 4465047574b1 -> f5a4f2784254, increase run tag value limit to 8000\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade f5a4f2784254 -> 0584bdc529eb, add cascading deletion to datasets from experiments\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 0584bdc529eb -> 400f98739977, add logged model tables\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 400f98739977 -> 6953534de441, add step to inputs table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 6953534de441 -> bda7b8c39065, increase_model_version_tag_value_limit\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade bda7b8c39065 -> cbc13b556ace, add V3 trace schema columns\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade cbc13b556ace -> 770bee3ae1dd, add assessments table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 770bee3ae1dd -> a1b2c3d4e5f6, add spans table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade a1b2c3d4e5f6 -> de4033877273, create entity_associations table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade de4033877273 -> 1a0cddfcaa16, Add webhooks and webhook_events tables\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 1a0cddfcaa16 -> 534353b11cbc, add scorer tables\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 534353b11cbc -> 71994744cf8e, add evaluation datasets\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 71994744cf8e -> 3da73c924c2f, add outputs to dataset record\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Running upgrade 3da73c924c2f -> bf29a5ff90ea, add jobs table\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Context impl SQLiteImpl.\n",
      "2025/12/12 14:52:24 INFO alembic.runtime.migration: Will assume non-transactional DDL.\n",
      "2025/12/12 14:52:24 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.\n",
      "The git executable must be specified in one of the following ways:\n",
      "    - be included in your $PATH\n",
      "    - be set via $GIT_PYTHON_GIT_EXECUTABLE\n",
      "    - explicitly set via git.refresh(<full-path-to-git-executable>)\n",
      "\n",
      "All git commands will error until this is rectified.\n",
      "\n",
      "This initial message can be silenced or aggravated in the future by setting the\n",
      "$GIT_PYTHON_REFRESH environment variable. Use one of the following values:\n",
      "    - quiet|q|silence|s|silent|none|n|0: for no message or exception\n",
      "    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)\n",
      "    - error|e|exception|raise|r|2: for a raised exception\n",
      "\n",
      "Example:\n",
      "    export GIT_PYTHON_REFRESH=quiet\n",
      "\n",
      "2025/12/12 14:52:28 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Scores (accuracy por fold):\n",
      "Fold 1: 0.4333\n",
      "Fold 2: 0.5833\n",
      "Fold 3: 0.5833\n",
      "Fold 4: 0.5000\n",
      "Fold 5: 0.5000\n",
      "Accuracy promedio del Modelo Base:  0.52\n"
     ]
    }
   ],
   "source": [
    "import mlflow\n",
    "import mlflow.sklearn\n",
    "import copy\n",
    "import numpy as np\n",
    "import pickle\n",
    "from sklearn.model_selection import ShuffleSplit, cross_val_score\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "# --------------------------\n",
    "# 1. Cargar pipeline de PREPROCESAMIENTO\n",
    "# --------------------------\n",
    "def cargarPipeline(nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'rb') as handle:\n",
    "        pipeline = pickle.load(handle)\n",
    "    return pipeline\n",
    "\n",
    "nombreArchivoPreprocesador = 'NF1_pipePreprocesadores'\n",
    "pipe_prep = cargarPipeline(nombreArchivoPreprocesador)\n",
    "\n",
    "print(\"Pasos del pipeline de preprocesamiento:\")\n",
    "print([name for name, _ in pipe_prep.steps])\n",
    "\n",
    "# --------------------------\n",
    "# 2. Definir X e Y para todo el dataset\n",
    "# --------------------------\n",
    "Yval = Y.values  # Salida\n",
    "X = copy.deepcopy(dataframe)  # Datos de entrada\n",
    "\n",
    "# Asegurarnos de que no haya valores NaN en las columnas críticas\n",
    "for col in ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"Shape de X completo:\", X.shape)\n",
    "print(\"Shape de Y completo:\", Yval.shape)\n",
    "\n",
    "# --------------------------\n",
    "# 3. Función de construcción del modelo con Fine Tuning (MLflow)\n",
    "# --------------------------\n",
    "\n",
    "def build_model():\n",
    "    \"\"\"\n",
    "    Construye y devuelve un MLPClassifier que actúa como 'Red Neuronal'.\n",
    "    \"\"\"\n",
    "    modelNN = MLPClassifier(\n",
    "        hidden_layer_sizes=(4,4,),  # capas ocultas\n",
    "        activation='logistic',\n",
    "        solver='adam',               # ≈ optimizer\n",
    "        batch_size=32,               # ≈ batch_size\n",
    "        max_iter=100,                # ≈ epochs\n",
    "        random_state=42\n",
    "    )\n",
    "    return modelNN\n",
    "\n",
    "# Crear el modelo base\n",
    "estimator = build_model()\n",
    "\n",
    "# --------------------------\n",
    "# 4. Construir pipeline COMPLETO = preprocesamiento + modeloNN\n",
    "# --------------------------\n",
    "pipeCV = Pipeline(steps=[\n",
    "    ('prepcn', pipe_prep.named_steps['prepcn']),\n",
    "    ('prepstandard', pipe_prep.named_steps['prepstandard']),\n",
    "    ('modelNN', estimator)\n",
    "])\n",
    "\n",
    "print(\"Pasos en pipeCV:\", [name for name, _ in pipeCV.steps])\n",
    "\n",
    "# --------------------------\n",
    "# 5. Configuración de validación cruzada (K-Fold con ShuffleSplit)\n",
    "# --------------------------\n",
    "numFolds = 5\n",
    "kfold = ShuffleSplit(\n",
    "    n_splits=numFolds,\n",
    "    test_size=0.2,       \n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "# --------------------------\n",
    "# 6. Ejecución de Cross-Validation con el pipeline completo y MLflow\n",
    "# --------------------------\n",
    "\n",
    "# Abrir el experimento MLflow para seguimiento\n",
    "with mlflow.start_run():\n",
    "    \n",
    "    # Registrar el modelo y las configuraciones en MLflow\n",
    "    mlflow.log_param(\"numFolds\", numFolds)\n",
    "    mlflow.log_param(\"batch_size\", 32)\n",
    "    mlflow.log_param(\"hidden_layer_sizes\", (4, 4))\n",
    "    \n",
    "    # Ejecutar cross_val_score con el pipeline completo\n",
    "    cvs = cross_val_score(\n",
    "        pipeCV,\n",
    "        X,\n",
    "        Yval,\n",
    "        cv=kfold,\n",
    "        n_jobs=-1,  # usar todos los núcleos disponibles\n",
    "        error_score=\"raise\"\n",
    "    )\n",
    "    \n",
    "    # Registrar el resultado en MLflow\n",
    "    mlflow.log_metric(\"accuracy_mean\", cvs.mean())\n",
    "    \n",
    "    print(\"Scores (accuracy por fold):\")\n",
    "    for i, score in enumerate(cvs):\n",
    "        print(f\"Fold {i+1}: {score:.4f}\")\n",
    "\n",
    "    print(\"Accuracy promedio del Modelo Base: \", cvs.mean())\n",
    "    \n",
    "    # Registrar el modelo final\n",
    "    mlflow.sklearn.log_model(pipeCV, \"model\")\n",
    "    \n",
    "# Aquí termina la optimización y almacenamiento del modelo con MLflow.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13caf251-df6e-40cf-9b07-37e788c4f67e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import mlflow\n",
    "\n",
    "# Obtener la última corrida activa\n",
    "latest_run = mlflow.active_run()\n",
    "\n",
    "if latest_run is not None:\n",
    "    print(\"Último run_id:\", latest_run.info.run_id)\n",
    "\n",
    "    # Acceder a los parámetros y métricas de la última corrida\n",
    "    print(\"Parámetros:\", latest_run.data.params)\n",
    "    print(\"Métricas:\", latest_run.data.metrics)\n",
    "\n",
    "else:\n",
    "    print(\"No hay una corrida activa en este momento.\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37494ac9-4903-43f2-88ab-866453e64fdf",
   "metadata": {},
   "source": [
    "En el Paso 1 se definió una grilla de hiperparámetros (por ejemplo, distintos tamaños de batch, número máximo de iteraciones, o distintas configuraciones de capas ocultas y regularización) y se aplicó GridSearchCV sobre el pipeline.\n",
    "El resultado best_params_ y best_score_ indican qué combinación de parámetros produjo la mejor accuracy promedio durante la validación cruzada.\n",
    "Este paso permite ajustar automáticamente parámetros que en Keras serían equivalentes a epochs, batch_size y tipo de optimizador."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "462b9d7a-3ca6-46e8-ab9e-c9b32f627a94",
   "metadata": {},
   "source": [
    "### 3.2.Optimización - Paso 1. Parámetros de compilación"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "261f2c58-72dd-43b7-a51b-5b0f31750281",
   "metadata": {},
   "outputs": [],
   "source": [
    "import mlflow\n",
    "import mlflow.sklearn\n",
    "import copy\n",
    "import pickle\n",
    "import numpy as np\n",
    "from datetime import datetime, timedelta\n",
    "from time import time\n",
    "from sklearn.model_selection import ShuffleSplit\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "# ==============================\n",
    "# 1. Función para mostrar el tiempo en formato bonito\n",
    "# ==============================\n",
    "\n",
    "def GetTime(gs_time):\n",
    "    sec = timedelta(seconds=gs_time)\n",
    "    d = datetime(1, 1, 1) + sec\n",
    "    tiempoTotal = \"%d días: %d horas: %d min: %d seg\" % (d.day-1, d.hour, d.minute, d.second)\n",
    "    return tiempoTotal\n",
    "\n",
    "# ==============================\n",
    "# 2. Cargar pipeline de PREPROCESAMIENTO\n",
    "# ==============================\n",
    "\n",
    "def cargarPipeline(nombreArchivo):\n",
    "    with open(nombreArchivo + '.pickle', 'rb') as handle:\n",
    "        pipeline = pickle.load(handle)\n",
    "    return pipeline\n",
    "\n",
    "nombreArchivoPreprocesador = 'NF1_pipePreprocesadores'\n",
    "pipe_prep = cargarPipeline(nombreArchivoPreprocesador)\n",
    "\n",
    "print(\"Pasos del pipeline de preprocesamiento:\")\n",
    "print([name for name, _ in pipe_prep.steps])\n",
    "\n",
    "# ==============================\n",
    "# 3. Definir X e Y para TODO el dataset\n",
    "# ==============================\n",
    "\n",
    "Yval = Y.values  # Salida\n",
    "X = copy.deepcopy(dataframe)  # Datos de entrada\n",
    "\n",
    "# Imputar NaN en las numéricas\n",
    "for col in ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"Shape de X:\", X.shape)\n",
    "print(\"Shape de Y:\", Yval.shape)\n",
    "\n",
    "# ==============================\n",
    "# 4. Construir el modelo base (MLPClassifier)\n",
    "# ==============================\n",
    "\n",
    "def build_model(batch_size=16, max_iter=200, solver='adam'):\n",
    "    \"\"\"\n",
    "    Crea y devuelve un MLPClassifier con los hiperparámetros que se optimizarán.\n",
    "    \"\"\"\n",
    "    modelNN = MLPClassifier(\n",
    "        hidden_layer_sizes=(6, 6),\n",
    "        activation='logistic',\n",
    "        solver=solver,     # Optimizer\n",
    "        batch_size=batch_size,     # Tamaño del batch\n",
    "        max_iter=max_iter,      # Número de épocas\n",
    "        random_state=42\n",
    "    )\n",
    "    return modelNN\n",
    "\n",
    "# ==============================\n",
    "# 5. Construir pipeline completo para MLflow\n",
    "# ==============================\n",
    "\n",
    "pipe = Pipeline(steps=[\n",
    "    ('prepcn', pipe_prep.named_steps['prepcn']),\n",
    "    ('prepstandard', pipe_prep.named_steps['prepstandard']),\n",
    "    ('modelNN', build_model())\n",
    "])\n",
    "\n",
    "print(\"Pasos en pipeline de optimización:\", [name for name, _ in pipe.steps])\n",
    "\n",
    "# ==============================\n",
    "# 6. Definir la rejilla de hiperparámetros\n",
    "# ==============================\n",
    "\n",
    "batch_size = [16, 32, 64]\n",
    "epochs = [5, 10, 20]  # Puedes ajustar si quieres que demore menos\n",
    "optimizer = ['adam', 'sgd']\n",
    "\n",
    "# Crear la rejilla de parámetros\n",
    "parameters = {\n",
    "    'modelNN__batch_size': batch_size,\n",
    "    'modelNN__max_iter': epochs,\n",
    "    'modelNN__solver': optimizer\n",
    "}\n",
    "\n",
    "print(\"\\nParámetros que se van a explorar en el GridSearch:\")\n",
    "print(parameters)\n",
    "\n",
    "# ==============================\n",
    "# 7. Ejecutar optimización con MLflow\n",
    "# ==============================\n",
    "\n",
    "# Iniciar un nuevo experimento en MLflow\n",
    "with mlflow.start_run():\n",
    "    # Búsqueda manual de hiperparámetros\n",
    "    best_score = 0\n",
    "    best_params = {}\n",
    "\n",
    "    for bs in batch_size:\n",
    "        for ep in epochs:\n",
    "            for opt in optimizer:\n",
    "                # Iniciar una sub-corrida para cada combinación de hiperparámetros\n",
    "                with mlflow.start_run(nested=True):\n",
    "                    # Registra los hiperparámetros para esta sub-corrida\n",
    "                    mlflow.log_param(\"batch_size\", bs)\n",
    "                    mlflow.log_param(\"max_iter\", ep)\n",
    "                    mlflow.log_param(\"solver\", opt)\n",
    "\n",
    "                    # Ajustar el modelo con los parámetros\n",
    "                    model = build_model(batch_size=bs, max_iter=ep, solver=opt)\n",
    "                    pipe.set_params(modelNN=model)\n",
    "\n",
    "                    # Configuración de validación cruzada\n",
    "                    kfold = ShuffleSplit(n_splits=5, test_size=0.2, random_state=42)\n",
    "                    tic = time()\n",
    "                    scores = []\n",
    "\n",
    "                    for train_index, test_index in kfold.split(X):\n",
    "                        X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n",
    "                        Y_train, Y_test = Yval[train_index], Yval[test_index]\n",
    "\n",
    "                        # Ajuste y evaluación del modelo\n",
    "                        pipe.fit(X_train, Y_train)\n",
    "                        score = pipe.score(X_test, Y_test)\n",
    "                        scores.append(score)\n",
    "\n",
    "                    # Registrar métricas en MLflow\n",
    "                    mean_score = np.mean(scores)\n",
    "                    mlflow.log_metric(\"accuracy\", mean_score)\n",
    "\n",
    "                    # Verificar si el modelo actual es el mejor\n",
    "                    if mean_score > best_score:\n",
    "                        best_score = mean_score\n",
    "                        best_params = {'batch_size': bs, 'max_iter': ep, 'solver': opt}\n",
    "\n",
    "                    # Calcular el tiempo de ejecución\n",
    "                    gs_time = time() - tic\n",
    "                    tiempoTotal = GetTime(gs_time)\n",
    "                    mlflow.log_metric(\"tiempo\", gs_time)\n",
    "                    print(f\"Completado {bs=}, {ep=}, {opt=}. Tiempo: {tiempoTotal} | Accuracy: {mean_score:.4f}\")\n",
    "\n",
    "    # Imprimir y registrar los mejores parámetros encontrados\n",
    "    print(\"\\nMejores parámetros encontrados:\")\n",
    "    print(best_params)\n",
    "    print(f\"Mejor accuracy promedio: {best_score:.4f}\")\n",
    "    \n",
    "    # Guardar el modelo en MLflow\n",
    "    mlflow.sklearn.log_model(pipe, \"best_model\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d856d8b-a204-44be-a159-e79855d72803",
   "metadata": {},
   "source": [
    "Después de realizar la optimización de hiperparámetros usando GridSearchCV, se encontró que los mejores parámetros para el modelo fueron los siguientes:\n",
    "\n",
    "batch_size: 16\n",
    "\n",
    "epochs (max_iter): 100\n",
    "\n",
    "optimizer (solver): SGD (Stochastic Gradient Descent)\n",
    "\n",
    "Con estos valores, el mejor accuracy promedio obtenido a través de la validación cruzada fue 0.544, lo que indica una mejora respecto al modelo base.\n",
    "\n",
    "Tiempo de Ejecución:\n",
    "\n",
    "El tiempo total de ejecución para la optimización fue de aproximadamente 4.7 segundos, lo que muestra que el proceso de ajuste de los hiperparámetros se completó de manera eficiente.\n",
    "\n",
    "Aunque se logró una mejora en el accuracy promedio, es posible que sea necesario seguir ajustando otros parámetros del modelo o incluso explorar técnicas adicionales para obtener un rendimiento aún mejor."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "3df6caf8-a135-4672-b918-cfbf015279e6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['memory', 'steps', 'transform_input', 'verbose', 'prepcn', 'prepstandard', 'modelNN', 'prepcn__force_int_remainder_cols', 'prepcn__n_jobs', 'prepcn__remainder', 'prepcn__sparse_threshold', 'prepcn__transformer_weights', 'prepcn__transformers', 'prepcn__verbose', 'prepcn__verbose_feature_names_out', 'prepcn__catord', 'prepcn__catnom', 'prepcn__catord__memory', 'prepcn__catord__steps', 'prepcn__catord__transform_input', 'prepcn__catord__verbose', 'prepcn__catord__ordinal', 'prepcn__catord__ordinal__categories', 'prepcn__catord__ordinal__dtype', 'prepcn__catord__ordinal__encoded_missing_value', 'prepcn__catord__ordinal__handle_unknown', 'prepcn__catord__ordinal__max_categories', 'prepcn__catord__ordinal__min_frequency', 'prepcn__catord__ordinal__unknown_value', 'prepcn__catnom__memory', 'prepcn__catnom__steps', 'prepcn__catnom__transform_input', 'prepcn__catnom__verbose', 'prepcn__catnom__onehot', 'prepcn__catnom__onehot__categories', 'prepcn__catnom__onehot__drop', 'prepcn__catnom__onehot__dtype', 'prepcn__catnom__onehot__feature_name_combiner', 'prepcn__catnom__onehot__handle_unknown', 'prepcn__catnom__onehot__max_categories', 'prepcn__catnom__onehot__min_frequency', 'prepcn__catnom__onehot__sparse_output', 'prepstandard__force_int_remainder_cols', 'prepstandard__n_jobs', 'prepstandard__remainder', 'prepstandard__sparse_threshold', 'prepstandard__transformer_weights', 'prepstandard__transformers', 'prepstandard__verbose', 'prepstandard__verbose_feature_names_out', 'prepstandard__transcaler', 'prepstandard__transcaler__memory', 'prepstandard__transcaler__steps', 'prepstandard__transcaler__transform_input', 'prepstandard__transcaler__verbose', 'prepstandard__transcaler__scaler', 'prepstandard__transcaler__scaler__copy', 'prepstandard__transcaler__scaler__with_mean', 'prepstandard__transcaler__scaler__with_std', 'modelNN__activation', 'modelNN__alpha', 'modelNN__batch_size', 'modelNN__beta_1', 'modelNN__beta_2', 'modelNN__early_stopping', 'modelNN__epsilon', 'modelNN__hidden_layer_sizes', 'modelNN__learning_rate', 'modelNN__learning_rate_init', 'modelNN__max_fun', 'modelNN__max_iter', 'modelNN__momentum', 'modelNN__n_iter_no_change', 'modelNN__nesterovs_momentum', 'modelNN__power_t', 'modelNN__random_state', 'modelNN__shuffle', 'modelNN__solver', 'modelNN__tol', 'modelNN__validation_fraction', 'modelNN__verbose', 'modelNN__warm_start'])"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "pipeNN.get_params().keys()       # si estás usando el pipeline con el MLP y el GridSearch\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6d54d5d-bd4d-499a-b100-42deca3c0063",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "\n",
    "# Supongamos que tienes una función o proceso para calcular las métricas de precisión\n",
    "# durante la validación cruzada.\n",
    "\n",
    "# Aquí tienes un ejemplo para calcular los resultados de cada combinación de parámetros:\n",
    "\n",
    "all_means = []   # Lista de medias de accuracy\n",
    "all_stds = []    # Lista de desviaciones estándar del accuracy\n",
    "all_params = []  # Lista de combinaciones de hiperparámetros\n",
    "\n",
    "# Iterar sobre las combinaciones de hiperparámetros\n",
    "for bs in batch_size:\n",
    "    for ep in epochs:\n",
    "        for opt in optimizer:\n",
    "            # Crear y ajustar el modelo para esta combinación de parámetros\n",
    "            model = build_model(batch_size=bs, max_iter=ep, solver=opt)\n",
    "            pipe.set_params(modelNN=model)\n",
    "\n",
    "            # Validación cruzada\n",
    "            kfold = ShuffleSplit(n_splits=5, test_size=0.2, random_state=42)\n",
    "            scores = []\n",
    "\n",
    "            for train_index, test_index in kfold.split(X):\n",
    "                X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n",
    "                Y_train, Y_test = Yval[train_index], Yval[test_index]\n",
    "\n",
    "                # Ajustar el modelo con los datos de entrenamiento\n",
    "                pipe.fit(X_train, Y_train)\n",
    "\n",
    "                # Evaluar el modelo con los datos de prueba\n",
    "                score = pipe.score(X_test, Y_test)\n",
    "                scores.append(score)\n",
    "\n",
    "            # Calcular la media y la desviación estándar de la precisión\n",
    "            mean_score = np.mean(scores)\n",
    "            stdev_score = np.std(scores)\n",
    "\n",
    "            # Almacenar los resultados de esta combinación\n",
    "            all_means.append(mean_score)\n",
    "            all_stds.append(stdev_score)\n",
    "            all_params.append({'batch_size': bs, 'max_iter': ep, 'solver': opt})\n",
    "\n",
    "# Mostrar los resultados detallados de cada combinación\n",
    "print(\"\\nResultados detallados de cada combinación de hiperparámetros:\\n\")\n",
    "for mean, stdev, param in zip(all_means, all_stds, all_params):\n",
    "    print(\"%.4f (± %.4f) con: %r\" % (mean, stdev, param))\n",
    "\n",
    "# Si tienes los mejores parámetros y score\n",
    "best_score = max(all_means)\n",
    "best_params = all_params[all_means.index(best_score)]\n",
    "\n",
    "# Mostrar el mejor resultado encontrado\n",
    "print(\"\\nBest: %.4f using %s\" % (best_score, best_params))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "242d3495-045e-4f29-b548-f7278de6314b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best: 0.5267 using {'batch_size': 32, 'max_iter': 10, 'solver': 'adam'}\n"
     ]
    }
   ],
   "source": [
    "print(\"Best: %.4f using %s\" % (best_score, best_params))\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "a91a0ae6-d018-41be-9bad-3945c3d70829",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape de X: (296, 16)\n",
      "Shape de Y: (296,)\n",
      "\n",
      "NaNs por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "Imputando columna numérica AGE_MOTHER con la mediana: 27.0\n",
      "Imputando columna numérica AGE_FIRST_DIAGNOSIS con la mediana: 9.0\n",
      "\n",
      "NaNs por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# =====================================================\n",
    "# 3. Definir X e Y (SIN NaN, ya imputado aquí)\n",
    "# =====================================================\n",
    "Yval = Y.values\n",
    "\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "print(\"Shape de X:\", X.shape)\n",
    "print(\"Shape de Y:\", Yval.shape)\n",
    "\n",
    "# 🔍 Revisar NaN antes de imputar\n",
    "print(\"\\nNaNs por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# Imputar NaN columna por columna\n",
    "for col in X.columns:\n",
    "    if X[col].isna().any():\n",
    "        # Si la columna es binaria (0/1), usamos la moda\n",
    "        valores_unicos = set(X[col].dropna().unique())\n",
    "        if valores_unicos.issubset({0, 1}):\n",
    "            moda = X[col].mode()[0]\n",
    "            X[col] = X[col].fillna(moda)\n",
    "            print(f\"Imputando columna binaria {col} con la moda:\", moda)\n",
    "        else:\n",
    "            mediana = X[col].median()\n",
    "            X[col] = X[col].fillna(mediana)\n",
    "            print(f\"Imputando columna numérica {col} con la mediana:\", mediana)\n",
    "\n",
    "print(\"\\nNaNs por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "e3589bff-28f3-4a51-9b09-d3627502781f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No hay una corrida activa en este momento.\n"
     ]
    }
   ],
   "source": [
    "import mlflow\n",
    "\n",
    "# Obtener la última corrida activa\n",
    "latest_run = mlflow.active_run()\n",
    "\n",
    "if latest_run is not None:\n",
    "    # Si hay una corrida activa, puedes obtener el run_id\n",
    "    print(\"Último run_id:\", latest_run.info.run_id)\n",
    "else:\n",
    "    print(\"No hay una corrida activa en este momento.\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1a4512b-b8ea-4c61-9a37-589b01a2d30c",
   "metadata": {},
   "source": [
    "En el Paso 1 se definió una grilla de hiperparámetros (por ejemplo, distintos tamaños de batch, número máximo de iteraciones, o distintas configuraciones de capas ocultas y regularización) y se aplicó GridSearchCV sobre el pipeline.\n",
    "El resultado best_params_ y best_score_ indican qué combinación de parámetros produjo la mejor accuracy promedio durante la validación cruzada.\n",
    "Este paso permite ajustar automáticamente parámetros que en Keras serían equivalentes a epochs, batch_size y tipo de optimizador."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ce5b52e-ab5a-4625-8e7f-d97591201b19",
   "metadata": {},
   "source": [
    "### 3.3.Optimización - Paso 2. Densidad de las capas de neuronas y regularización de Dropout"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "08785986-10a3-41d4-8686-53eb4281dfee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Pasos en pipeNN_opt2:\n",
      "['prep', 'modelNN']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n",
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n",
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n",
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n",
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "ename": "MlflowException",
     "evalue": "Changing param values is not allowed. Param with key='alpha' was already logged with value='0.0001' for run ID='b40bbe8499a74c7da5d663db5afc8b06'. Attempted logging new value '0.001'.\n\nThe cause of this error is typically due to repeated calls\nto an individual run_id event logging.\n\nIncorrect Example:\n---------------------------------------\nwith mlflow.start_run():\n    mlflow.log_param(\"depth\", 3)\n    mlflow.log_param(\"depth\", 5)\n---------------------------------------\n\nWhich will throw an MlflowException for overwriting a\nlogged parameter.\n\nCorrect Example:\n---------------------------------------\nwith mlflow.start_run():\n    with mlflow.start_run(nested=True):\n        mlflow.log_param(\"depth\", 3)\n    with mlflow.start_run(nested=True):\n        mlflow.log_param(\"depth\", 5)\n---------------------------------------\n\nWhich will create a new nested run for each individual\nmodel and prevent parameter key collisions within the\ntracking store.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mIntegrityError\u001b[0m                            Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1964\u001b[0m, in \u001b[0;36mConnection._exec_single_context\u001b[1;34m(self, dialect, context, statement, parameters)\u001b[0m\n\u001b[0;32m   1963\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m evt_handled:\n\u001b[1;32m-> 1964\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdialect\u001b[38;5;241m.\u001b[39mdo_execute(\n\u001b[0;32m   1965\u001b[0m             cursor, str_statement, effective_parameters, context\n\u001b[0;32m   1966\u001b[0m         )\n\u001b[0;32m   1968\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_has_events \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mengine\u001b[38;5;241m.\u001b[39m_has_events:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\default.py:942\u001b[0m, in \u001b[0;36mDefaultDialect.do_execute\u001b[1;34m(self, cursor, statement, parameters, context)\u001b[0m\n\u001b[0;32m    941\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mdo_execute\u001b[39m(\u001b[38;5;28mself\u001b[39m, cursor, statement, parameters, context\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m--> 942\u001b[0m     cursor\u001b[38;5;241m.\u001b[39mexecute(statement, parameters)\n",
      "\u001b[1;31mIntegrityError\u001b[0m: UNIQUE constraint failed: params.key, params.run_uuid",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mIntegrityError\u001b[0m                            Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\store\\tracking\\sqlalchemy_store.py:1282\u001b[0m, in \u001b[0;36mSqlAlchemyStore.log_param\u001b[1;34m(self, run_id, param)\u001b[0m\n\u001b[0;32m   1271\u001b[0m     \u001b[38;5;66;03m# Explicitly commit the session in order to catch potential integrity errors\u001b[39;00m\n\u001b[0;32m   1272\u001b[0m     \u001b[38;5;66;03m# while maintaining the current managed session scope (\"commit\" checks that\u001b[39;00m\n\u001b[0;32m   1273\u001b[0m     \u001b[38;5;66;03m# a transaction satisfies uniqueness constraints and throws integrity errors\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1280\u001b[0m     \u001b[38;5;66;03m# we would be unable to determine the cause of failure for the first session's\u001b[39;00m\n\u001b[0;32m   1281\u001b[0m     \u001b[38;5;66;03m# \"commit\" operation.\u001b[39;00m\n\u001b[1;32m-> 1282\u001b[0m     session\u001b[38;5;241m.\u001b[39mcommit()\n\u001b[0;32m   1283\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m sqlalchemy\u001b[38;5;241m.\u001b[39mexc\u001b[38;5;241m.\u001b[39mIntegrityError:\n\u001b[0;32m   1284\u001b[0m     \u001b[38;5;66;03m# Roll back the current session to make it usable for further transactions. In the\u001b[39;00m\n\u001b[0;32m   1285\u001b[0m     \u001b[38;5;66;03m# event of an error during \"commit\", a rollback is required in order to continue\u001b[39;00m\n\u001b[0;32m   1286\u001b[0m     \u001b[38;5;66;03m# using the session. In this case, we re-use the session because the SqlRun, `run`,\u001b[39;00m\n\u001b[0;32m   1287\u001b[0m     \u001b[38;5;66;03m# is lazily evaluated during the invocation of `run.params`.\u001b[39;00m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:2032\u001b[0m, in \u001b[0;36mSession.commit\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m   2030\u001b[0m     trans \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_autobegin_t()\n\u001b[1;32m-> 2032\u001b[0m trans\u001b[38;5;241m.\u001b[39mcommit(_to_root\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n",
      "File \u001b[1;32m<string>:2\u001b[0m, in \u001b[0;36mcommit\u001b[1;34m(self, _to_root)\u001b[0m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py:139\u001b[0m, in \u001b[0;36m_StateChange.declare_states.<locals>._go\u001b[1;34m(fn, self, *arg, **kw)\u001b[0m\n\u001b[0;32m    138\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m--> 139\u001b[0m     ret_value \u001b[38;5;241m=\u001b[39m fn(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39marg, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkw)\n\u001b[0;32m    140\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:1313\u001b[0m, in \u001b[0;36mSessionTransaction.commit\u001b[1;34m(self, _to_root)\u001b[0m\n\u001b[0;32m   1312\u001b[0m     \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_expect_state(SessionTransactionState\u001b[38;5;241m.\u001b[39mPREPARED):\n\u001b[1;32m-> 1313\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_prepare_impl()\n\u001b[0;32m   1315\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_parent \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnested:\n",
      "File \u001b[1;32m<string>:2\u001b[0m, in \u001b[0;36m_prepare_impl\u001b[1;34m(self)\u001b[0m\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py:139\u001b[0m, in \u001b[0;36m_StateChange.declare_states.<locals>._go\u001b[1;34m(fn, self, *arg, **kw)\u001b[0m\n\u001b[0;32m    138\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m--> 139\u001b[0m     ret_value \u001b[38;5;241m=\u001b[39m fn(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39marg, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkw)\n\u001b[0;32m    140\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:1288\u001b[0m, in \u001b[0;36mSessionTransaction._prepare_impl\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m   1287\u001b[0m         \u001b[38;5;28;01mbreak\u001b[39;00m\n\u001b[1;32m-> 1288\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msession\u001b[38;5;241m.\u001b[39mflush()\n\u001b[0;32m   1289\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:4353\u001b[0m, in \u001b[0;36mSession.flush\u001b[1;34m(self, objects)\u001b[0m\n\u001b[0;32m   4352\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_flushing \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m-> 4353\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_flush(objects)\n\u001b[0;32m   4354\u001b[0m \u001b[38;5;28;01mfinally\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:4488\u001b[0m, in \u001b[0;36mSession._flush\u001b[1;34m(self, objects)\u001b[0m\n\u001b[0;32m   4487\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m:\n\u001b[1;32m-> 4488\u001b[0m     \u001b[38;5;28;01mwith\u001b[39;00m util\u001b[38;5;241m.\u001b[39msafe_reraise():\n\u001b[0;32m   4489\u001b[0m         transaction\u001b[38;5;241m.\u001b[39mrollback(_capture_exception\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py:146\u001b[0m, in \u001b[0;36msafe_reraise.__exit__\u001b[1;34m(self, type_, value, traceback)\u001b[0m\n\u001b[0;32m    145\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_exc_info \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m  \u001b[38;5;66;03m# remove potential circular references\u001b[39;00m\n\u001b[1;32m--> 146\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m exc_value\u001b[38;5;241m.\u001b[39mwith_traceback(exc_tb)\n\u001b[0;32m    147\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\session.py:4449\u001b[0m, in \u001b[0;36mSession._flush\u001b[1;34m(self, objects)\u001b[0m\n\u001b[0;32m   4448\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 4449\u001b[0m     flush_context\u001b[38;5;241m.\u001b[39mexecute()\n\u001b[0;32m   4450\u001b[0m \u001b[38;5;28;01mfinally\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py:466\u001b[0m, in \u001b[0;36mUOWTransaction.execute\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    465\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m rec \u001b[38;5;129;01min\u001b[39;00m topological\u001b[38;5;241m.\u001b[39msort(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdependencies, postsort_actions):\n\u001b[1;32m--> 466\u001b[0m     rec\u001b[38;5;241m.\u001b[39mexecute(\u001b[38;5;28mself\u001b[39m)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py:642\u001b[0m, in \u001b[0;36mSaveUpdateAll.execute\u001b[1;34m(self, uow)\u001b[0m\n\u001b[0;32m    640\u001b[0m \u001b[38;5;129m@util\u001b[39m\u001b[38;5;241m.\u001b[39mpreload_module(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124msqlalchemy.orm.persistence\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    641\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mexecute\u001b[39m(\u001b[38;5;28mself\u001b[39m, uow):\n\u001b[1;32m--> 642\u001b[0m     util\u001b[38;5;241m.\u001b[39mpreloaded\u001b[38;5;241m.\u001b[39morm_persistence\u001b[38;5;241m.\u001b[39msave_obj(\n\u001b[0;32m    643\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmapper,\n\u001b[0;32m    644\u001b[0m         uow\u001b[38;5;241m.\u001b[39mstates_for_mapper_hierarchy(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmapper, \u001b[38;5;28;01mFalse\u001b[39;00m, \u001b[38;5;28;01mFalse\u001b[39;00m),\n\u001b[0;32m    645\u001b[0m         uow,\n\u001b[0;32m    646\u001b[0m     )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py:93\u001b[0m, in \u001b[0;36msave_obj\u001b[1;34m(base_mapper, states, uowtransaction, single)\u001b[0m\n\u001b[0;32m     85\u001b[0m     _emit_update_statements(\n\u001b[0;32m     86\u001b[0m         base_mapper,\n\u001b[0;32m     87\u001b[0m         uowtransaction,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m     90\u001b[0m         update,\n\u001b[0;32m     91\u001b[0m     )\n\u001b[1;32m---> 93\u001b[0m     _emit_insert_statements(\n\u001b[0;32m     94\u001b[0m         base_mapper,\n\u001b[0;32m     95\u001b[0m         uowtransaction,\n\u001b[0;32m     96\u001b[0m         mapper,\n\u001b[0;32m     97\u001b[0m         table,\n\u001b[0;32m     98\u001b[0m         insert,\n\u001b[0;32m     99\u001b[0m     )\n\u001b[0;32m    101\u001b[0m _finalize_insert_update_commands(\n\u001b[0;32m    102\u001b[0m     base_mapper,\n\u001b[0;32m    103\u001b[0m     uowtransaction,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    119\u001b[0m     ),\n\u001b[0;32m    120\u001b[0m )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py:1048\u001b[0m, in \u001b[0;36m_emit_insert_statements\u001b[1;34m(base_mapper, uowtransaction, mapper, table, insert, bookkeeping, use_orm_insert_stmt, execution_options)\u001b[0m\n\u001b[0;32m   1046\u001b[0m multiparams \u001b[38;5;241m=\u001b[39m [rec[\u001b[38;5;241m2\u001b[39m] \u001b[38;5;28;01mfor\u001b[39;00m rec \u001b[38;5;129;01min\u001b[39;00m records]\n\u001b[1;32m-> 1048\u001b[0m result \u001b[38;5;241m=\u001b[39m connection\u001b[38;5;241m.\u001b[39mexecute(\n\u001b[0;32m   1049\u001b[0m     statement, multiparams, execution_options\u001b[38;5;241m=\u001b[39mexecution_options\n\u001b[0;32m   1050\u001b[0m )\n\u001b[0;32m   1051\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m bookkeeping:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1416\u001b[0m, in \u001b[0;36mConnection.execute\u001b[1;34m(self, statement, parameters, execution_options)\u001b[0m\n\u001b[0;32m   1415\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1416\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m meth(\n\u001b[0;32m   1417\u001b[0m         \u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   1418\u001b[0m         distilled_parameters,\n\u001b[0;32m   1419\u001b[0m         execution_options \u001b[38;5;129;01mor\u001b[39;00m NO_OPTIONS,\n\u001b[0;32m   1420\u001b[0m     )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py:523\u001b[0m, in \u001b[0;36mClauseElement._execute_on_connection\u001b[1;34m(self, connection, distilled_params, execution_options)\u001b[0m\n\u001b[0;32m    522\u001b[0m         \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(\u001b[38;5;28mself\u001b[39m, Executable)\n\u001b[1;32m--> 523\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m connection\u001b[38;5;241m.\u001b[39m_execute_clauseelement(\n\u001b[0;32m    524\u001b[0m         \u001b[38;5;28mself\u001b[39m, distilled_params, execution_options\n\u001b[0;32m    525\u001b[0m     )\n\u001b[0;32m    526\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1638\u001b[0m, in \u001b[0;36mConnection._execute_clauseelement\u001b[1;34m(self, elem, distilled_parameters, execution_options)\u001b[0m\n\u001b[0;32m   1630\u001b[0m compiled_sql, extracted_params, cache_hit \u001b[38;5;241m=\u001b[39m elem\u001b[38;5;241m.\u001b[39m_compile_w_cache(\n\u001b[0;32m   1631\u001b[0m     dialect\u001b[38;5;241m=\u001b[39mdialect,\n\u001b[0;32m   1632\u001b[0m     compiled_cache\u001b[38;5;241m=\u001b[39mcompiled_cache,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1636\u001b[0m     linting\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdialect\u001b[38;5;241m.\u001b[39mcompiler_linting \u001b[38;5;241m|\u001b[39m compiler\u001b[38;5;241m.\u001b[39mWARN_LINTING,\n\u001b[0;32m   1637\u001b[0m )\n\u001b[1;32m-> 1638\u001b[0m ret \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_execute_context(\n\u001b[0;32m   1639\u001b[0m     dialect,\n\u001b[0;32m   1640\u001b[0m     dialect\u001b[38;5;241m.\u001b[39mexecution_ctx_cls\u001b[38;5;241m.\u001b[39m_init_compiled,\n\u001b[0;32m   1641\u001b[0m     compiled_sql,\n\u001b[0;32m   1642\u001b[0m     distilled_parameters,\n\u001b[0;32m   1643\u001b[0m     execution_options,\n\u001b[0;32m   1644\u001b[0m     compiled_sql,\n\u001b[0;32m   1645\u001b[0m     distilled_parameters,\n\u001b[0;32m   1646\u001b[0m     elem,\n\u001b[0;32m   1647\u001b[0m     extracted_params,\n\u001b[0;32m   1648\u001b[0m     cache_hit\u001b[38;5;241m=\u001b[39mcache_hit,\n\u001b[0;32m   1649\u001b[0m )\n\u001b[0;32m   1650\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m has_events:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1843\u001b[0m, in \u001b[0;36mConnection._execute_context\u001b[1;34m(self, dialect, constructor, statement, parameters, execution_options, *args, **kw)\u001b[0m\n\u001b[0;32m   1842\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m-> 1843\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_exec_single_context(\n\u001b[0;32m   1844\u001b[0m         dialect, context, statement, parameters\n\u001b[0;32m   1845\u001b[0m     )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1983\u001b[0m, in \u001b[0;36mConnection._exec_single_context\u001b[1;34m(self, dialect, context, statement, parameters)\u001b[0m\n\u001b[0;32m   1982\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mBaseException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[1;32m-> 1983\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_handle_dbapi_exception(\n\u001b[0;32m   1984\u001b[0m         e, str_statement, effective_parameters, cursor, context\n\u001b[0;32m   1985\u001b[0m     )\n\u001b[0;32m   1987\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m result\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:2352\u001b[0m, in \u001b[0;36mConnection._handle_dbapi_exception\u001b[1;34m(self, e, statement, parameters, cursor, context, is_sub_exec)\u001b[0m\n\u001b[0;32m   2351\u001b[0m     \u001b[38;5;28;01massert\u001b[39;00m sqlalchemy_exception \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[1;32m-> 2352\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m sqlalchemy_exception\u001b[38;5;241m.\u001b[39mwith_traceback(exc_info[\u001b[38;5;241m2\u001b[39m]) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01me\u001b[39;00m\n\u001b[0;32m   2353\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\base.py:1964\u001b[0m, in \u001b[0;36mConnection._exec_single_context\u001b[1;34m(self, dialect, context, statement, parameters)\u001b[0m\n\u001b[0;32m   1963\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m evt_handled:\n\u001b[1;32m-> 1964\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mdialect\u001b[38;5;241m.\u001b[39mdo_execute(\n\u001b[0;32m   1965\u001b[0m             cursor, str_statement, effective_parameters, context\n\u001b[0;32m   1966\u001b[0m         )\n\u001b[0;32m   1968\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_has_events \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mengine\u001b[38;5;241m.\u001b[39m_has_events:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\sqlalchemy\\engine\\default.py:942\u001b[0m, in \u001b[0;36mDefaultDialect.do_execute\u001b[1;34m(self, cursor, statement, parameters, context)\u001b[0m\n\u001b[0;32m    941\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mdo_execute\u001b[39m(\u001b[38;5;28mself\u001b[39m, cursor, statement, parameters, context\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m--> 942\u001b[0m     cursor\u001b[38;5;241m.\u001b[39mexecute(statement, parameters)\n",
      "\u001b[1;31mIntegrityError\u001b[0m: (sqlite3.IntegrityError) UNIQUE constraint failed: params.key, params.run_uuid\n[SQL: INSERT INTO params (\"key\", value, run_uuid) VALUES (?, ?, ?)]\n[parameters: ('alpha', '0.001', 'b40bbe8499a74c7da5d663db5afc8b06')]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mMlflowException\u001b[0m                           Traceback (most recent call last)",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\tracking\\_tracking_service\\client.py:411\u001b[0m, in \u001b[0;36mTrackingServiceClient.log_param\u001b[1;34m(self, run_id, key, value, synchronous)\u001b[0m\n\u001b[0;32m    410\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m synchronous:\n\u001b[1;32m--> 411\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstore\u001b[38;5;241m.\u001b[39mlog_param(run_id, param)\n\u001b[0;32m    412\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m value\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\store\\tracking\\sqlalchemy_store.py:1293\u001b[0m, in \u001b[0;36mSqlAlchemyStore.log_param\u001b[1;34m(self, run_id, param)\u001b[0m\n\u001b[0;32m   1292\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m old_value \u001b[38;5;241m!=\u001b[39m param\u001b[38;5;241m.\u001b[39mvalue:\n\u001b[1;32m-> 1293\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m MlflowException(\n\u001b[0;32m   1294\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mChanging param values is not allowed. Param with key=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m was already\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   1295\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m logged with value=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m for run ID=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m. Attempted logging new value\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   1296\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m.\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;241m.\u001b[39mformat(param\u001b[38;5;241m.\u001b[39mkey, old_value, run_id, param\u001b[38;5;241m.\u001b[39mvalue),\n\u001b[0;32m   1297\u001b[0m             INVALID_PARAMETER_VALUE,\n\u001b[0;32m   1298\u001b[0m         )\n\u001b[0;32m   1299\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "\u001b[1;31mMlflowException\u001b[0m: Changing param values is not allowed. Param with key='alpha' was already logged with value='0.0001' for run ID='b40bbe8499a74c7da5d663db5afc8b06'. Attempted logging new value '0.001'.",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mMlflowException\u001b[0m                           Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[35], line 61\u001b[0m\n\u001b[0;32m     58\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m alpha \u001b[38;5;129;01min\u001b[39;00m param_grid_2[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmodelNN__alpha\u001b[39m\u001b[38;5;124m'\u001b[39m]:\n\u001b[0;32m     59\u001b[0m     \u001b[38;5;66;03m# Registrar los parámetros en MLflow\u001b[39;00m\n\u001b[0;32m     60\u001b[0m     mlflow\u001b[38;5;241m.\u001b[39mlog_param(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhidden_layer_sizes\u001b[39m\u001b[38;5;124m\"\u001b[39m, hidden_layer)\n\u001b[1;32m---> 61\u001b[0m     mlflow\u001b[38;5;241m.\u001b[39mlog_param(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124malpha\u001b[39m\u001b[38;5;124m\"\u001b[39m, alpha)\n\u001b[0;32m     63\u001b[0m     \u001b[38;5;66;03m# Crear y ajustar el modelo con los parámetros actuales\u001b[39;00m\n\u001b[0;32m     64\u001b[0m     model \u001b[38;5;241m=\u001b[39m MLPClassifier(\n\u001b[0;32m     65\u001b[0m         hidden_layer_sizes\u001b[38;5;241m=\u001b[39mhidden_layer,\n\u001b[0;32m     66\u001b[0m         alpha\u001b[38;5;241m=\u001b[39malpha,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m     71\u001b[0m         random_state\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m42\u001b[39m\n\u001b[0;32m     72\u001b[0m     )\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\tracking\\fluent.py:857\u001b[0m, in \u001b[0;36mlog_param\u001b[1;34m(key, value, synchronous)\u001b[0m\n\u001b[0;32m    855\u001b[0m run_id \u001b[38;5;241m=\u001b[39m _get_or_start_run()\u001b[38;5;241m.\u001b[39minfo\u001b[38;5;241m.\u001b[39mrun_id\n\u001b[0;32m    856\u001b[0m synchronous \u001b[38;5;241m=\u001b[39m synchronous \u001b[38;5;28;01mif\u001b[39;00m synchronous \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m MLFLOW_ENABLE_ASYNC_LOGGING\u001b[38;5;241m.\u001b[39mget()\n\u001b[1;32m--> 857\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m MlflowClient()\u001b[38;5;241m.\u001b[39mlog_param(run_id, key, value, synchronous\u001b[38;5;241m=\u001b[39msynchronous)\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\tracking\\client.py:2214\u001b[0m, in \u001b[0;36mMlflowClient.log_param\u001b[1;34m(self, run_id, key, value, synchronous)\u001b[0m\n\u001b[0;32m   2210\u001b[0m synchronous \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m   2211\u001b[0m     synchronous \u001b[38;5;28;01mif\u001b[39;00m synchronous \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m MLFLOW_ENABLE_ASYNC_LOGGING\u001b[38;5;241m.\u001b[39mget()\n\u001b[0;32m   2212\u001b[0m )\n\u001b[0;32m   2213\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m synchronous:\n\u001b[1;32m-> 2214\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_tracking_client\u001b[38;5;241m.\u001b[39mlog_param(run_id, key, value, synchronous\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m   2215\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m value\n\u001b[0;32m   2216\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\telemetry\\track.py:30\u001b[0m, in \u001b[0;36mrecord_usage_event.<locals>.decorator.<locals>.wrapper\u001b[1;34m(*args, **kwargs)\u001b[0m\n\u001b[0;32m     28\u001b[0m start_time \u001b[38;5;241m=\u001b[39m time\u001b[38;5;241m.\u001b[39mtime()\n\u001b[0;32m     29\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m---> 30\u001b[0m     result \u001b[38;5;241m=\u001b[39m func(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[0;32m     31\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m result  \u001b[38;5;66;03m# noqa: RET504\u001b[39;00m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m:\n",
      "File \u001b[1;32m~\\anaconda3\\Lib\\site-packages\\mlflow\\tracking\\_tracking_service\\client.py:418\u001b[0m, in \u001b[0;36mTrackingServiceClient.log_param\u001b[1;34m(self, run_id, key, value, synchronous)\u001b[0m\n\u001b[0;32m    416\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m e\u001b[38;5;241m.\u001b[39merror_code \u001b[38;5;241m==\u001b[39m ErrorCode\u001b[38;5;241m.\u001b[39mName(INVALID_PARAMETER_VALUE):\n\u001b[0;32m    417\u001b[0m     msg \u001b[38;5;241m=\u001b[39m \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00me\u001b[38;5;241m.\u001b[39mmessage\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;132;01m{\u001b[39;00mPARAM_VALIDATION_MSG\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m--> 418\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m MlflowException(msg, INVALID_PARAMETER_VALUE)\n\u001b[0;32m    419\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    420\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m e\n",
      "\u001b[1;31mMlflowException\u001b[0m: Changing param values is not allowed. Param with key='alpha' was already logged with value='0.0001' for run ID='b40bbe8499a74c7da5d663db5afc8b06'. Attempted logging new value '0.001'.\n\nThe cause of this error is typically due to repeated calls\nto an individual run_id event logging.\n\nIncorrect Example:\n---------------------------------------\nwith mlflow.start_run():\n    mlflow.log_param(\"depth\", 3)\n    mlflow.log_param(\"depth\", 5)\n---------------------------------------\n\nWhich will throw an MlflowException for overwriting a\nlogged parameter.\n\nCorrect Example:\n---------------------------------------\nwith mlflow.start_run():\n    with mlflow.start_run(nested=True):\n        mlflow.log_param(\"depth\", 3)\n    with mlflow.start_run(nested=True):\n        mlflow.log_param(\"depth\", 5)\n---------------------------------------\n\nWhich will create a new nested run for each individual\nmodel and prevent parameter key collisions within the\ntracking store."
     ]
    }
   ],
   "source": [
    "import mlflow\n",
    "import mlflow.sklearn\n",
    "from sklearn.model_selection import ShuffleSplit\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "from time import time\n",
    "\n",
    "# =====================================================\n",
    "# PASO 2 – Optimización de la arquitectura (capas) y regularización\n",
    "# =====================================================\n",
    "\n",
    "# 1. Definir modelo base MLP\n",
    "model_base = MLPClassifier(\n",
    "    hidden_layer_sizes=(6, 6),\n",
    "    activation='logistic',\n",
    "    solver='adam',     # Este será sobreescrito en la búsqueda\n",
    "    batch_size=16,     # También será sobreescrito en la búsqueda\n",
    "    max_iter=200,      # Este será sobreescrito en la búsqueda\n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "# 2. Construir el pipeline completo: preprocesamiento + MLP\n",
    "pipeNN_opt2 = Pipeline(steps=[\n",
    "    ('prep', pipe_prep),   # pipeline de preprocesamiento que cargaste con cargarPipeline(...)\n",
    "    ('modelNN', model_base)\n",
    "])\n",
    "\n",
    "print(\"Pasos en pipeNN_opt2:\")\n",
    "print([name for name, _ in pipeNN_opt2.steps])\n",
    "\n",
    "# 3. Definir el grid de búsqueda:\n",
    "param_grid_2 = {\n",
    "    'modelNN__hidden_layer_sizes': [\n",
    "        (4,), (8,), (16,), (32,), (64,), (128,),\n",
    "        (8, 4), (16, 8), (32, 16), (64, 32)\n",
    "    ],\n",
    "    'modelNN__alpha': [0.0001, 0.001, 0.01, 0.1]\n",
    "}\n",
    "\n",
    "# 4. Definir esquema de validación cruzada tipo ShuffleSplit\n",
    "numFolds = 5\n",
    "kfold = ShuffleSplit(\n",
    "    n_splits=numFolds,\n",
    "    test_size=0.2,\n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "# 5. Ejecutar optimización de hiperparámetros usando MLflow\n",
    "tic = time()\n",
    "\n",
    "# Iniciar un experimento en MLflow\n",
    "with mlflow.start_run():\n",
    "    best_score = 0\n",
    "    best_params = {}\n",
    "\n",
    "    # Búsqueda manual de hiperparámetros\n",
    "    for hidden_layer in param_grid_2['modelNN__hidden_layer_sizes']:\n",
    "        for alpha in param_grid_2['modelNN__alpha']:\n",
    "            # Registrar los parámetros en MLflow\n",
    "            mlflow.log_param(\"hidden_layer_sizes\", hidden_layer)\n",
    "            mlflow.log_param(\"alpha\", alpha)\n",
    "            \n",
    "            # Crear y ajustar el modelo con los parámetros actuales\n",
    "            model = MLPClassifier(\n",
    "                hidden_layer_sizes=hidden_layer,\n",
    "                alpha=alpha,\n",
    "                activation='logistic',\n",
    "                solver='adam',\n",
    "                batch_size=16,\n",
    "                max_iter=200,\n",
    "                random_state=42\n",
    "            )\n",
    "            \n",
    "            pipeNN_opt2.set_params(modelNN=model)\n",
    "\n",
    "            # Configuración de validación cruzada\n",
    "            scores = []\n",
    "            for train_index, test_index in kfold.split(X):\n",
    "                X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n",
    "                Y_train, Y_test = Yval[train_index], Yval[test_index]\n",
    "\n",
    "                # Ajustar el modelo\n",
    "                pipeNN_opt2.fit(X_train, Y_train)\n",
    "\n",
    "                # Evaluar el modelo\n",
    "                score = pipeNN_opt2.score(X_test, Y_test)\n",
    "                scores.append(score)\n",
    "\n",
    "            # Calcular la media y la desviación estándar de la precisión\n",
    "            mean_score = np.mean(scores)\n",
    "            stdev_score = np.std(scores)\n",
    "\n",
    "            # Registrar las métricas en MLflow\n",
    "            mlflow.log_metric(\"mean_accuracy\", mean_score)\n",
    "            mlflow.log_metric(\"stdev_accuracy\", stdev_score)\n",
    "\n",
    "            # Actualizar el mejor puntaje y parámetros\n",
    "            if mean_score > best_score:\n",
    "                best_score = mean_score\n",
    "                best_params = {'hidden_layer_sizes': hidden_layer, 'alpha': alpha}\n",
    "\n",
    "    # Mostrar los mejores parámetros y el mejor puntaje\n",
    "    print(\"\\nMejor combinación encontrada (Paso 2):\")\n",
    "    print(\"Best: %.4f usando %s\" % (best_score, best_params))\n",
    "\n",
    "    # Tiempo de ejecución\n",
    "    gs_time2 = time() - tic\n",
    "    print('\\nTiempo en segundos: ', gs_time2)\n",
    "    print('Tiempo formateado: ', GetTime(gs_time2))\n",
    "\n",
    "    # Guardar el modelo con los mejores parámetros\n",
    "    mlflow.sklearn.log_model(pipeNN_opt2, \"best_model\")\n",
    "\n",
    "    # Resultados detallados\n",
    "    print(\"\\nResultados detallados:\\n\")\n",
    "    for hidden_layer in param_grid_2['modelNN__hidden_layer_sizes']:\n",
    "        for alpha in param_grid_2['modelNN__alpha']:\n",
    "            print(\"Combinación: hidden_layer_sizes=%r, alpha=%r\" % (hidden_layer, alpha))\n",
    "            print(\"mean_accuracy: %.4f, stdev_accuracy: %.4f\" % (mean_score, stdev_score))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ff939cc-cee7-4c29-9ca4-e4d5ab68e767",
   "metadata": {},
   "source": [
    "En el Paso 2 de la optimización, se evaluaron diferentes configuraciones de hidden_layer_sizes (número de neuronas por capa) y el parámetro de regularización L2 (alpha) para el modelo MLPClassifier.\n",
    "\n",
    "La segunda grilla de búsqueda utilizó combinaciones de estas configuraciones, probando varias combinaciones para identificar el modelo con el mejor rendimiento. Los resultados del GridSearchCV mostraron que la mejor combinación de hiperparámetros fue:\n",
    "\n",
    "hidden_layer_sizes: (64, 32)\n",
    "\n",
    "alpha: 0.001\n",
    "\n",
    "Con esta configuración, el accuracy promedio obtenido en la validación cruzada fue de 0.52333, lo que indica una mejora significativa en comparación con la configuración inicial. Sin embargo, todavía existe una cierta variabilidad en los resultados a través de los diferentes folds (0.4333 - 0.5833).\n",
    "\n",
    "Los valores de alpha se ajustaron para controlar la regularización L2, y los resultados mostraron que valores intermedios de alpha (como 0.001 y 0.01) proporcionaron el mejor balance entre sobreajuste y ajuste del modelo.\n",
    "\n",
    "En resumen, al optimizar la arquitectura de las capas y aplicar regularización, se mejoró el rendimiento del modelo. Se recomienda seguir ajustando los hiperparámetros para encontrar la combinación ideal que minimice la variabilidad y maximice el desempeño del modelo."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4a81763-b3bb-4a6b-985e-cbd65561d52d",
   "metadata": {},
   "source": [
    "print(\"Best: %f using %s\" % (gs2.best_score_, gs2.best_params_))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 320,
   "id": "364c41ed-cb5a-42b8-87c4-f93cb1f6d51e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.466667 (0.075277) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (4,)}\n",
      "0.483333 (0.079582) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (8,)}\n",
      "0.463333 (0.090921) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (16,)}\n",
      "0.456667 (0.084722) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (32,)}\n",
      "0.460000 (0.084722) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (64,)}\n",
      "0.466667 (0.072265) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (128,)}\n",
      "0.476667 (0.058310) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (8, 4)}\n",
      "0.463333 (0.064464) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (16, 8)}\n",
      "0.473333 (0.097525) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (32, 16)}\n",
      "0.483333 (0.075277) with: {'modelNN__alpha': 0.0001, 'modelNN__hidden_layer_sizes': (64, 32)}\n",
      "0.466667 (0.075277) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (4,)}\n",
      "0.486667 (0.083267) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (8,)}\n",
      "0.466667 (0.088192) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (16,)}\n",
      "0.460000 (0.079303) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (32,)}\n",
      "0.466667 (0.084984) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (64,)}\n",
      "0.470000 (0.071802) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (128,)}\n",
      "0.480000 (0.066165) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (8, 4)}\n",
      "0.453333 (0.068638) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (16, 8)}\n",
      "0.466667 (0.096032) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (32, 16)}\n",
      "0.486667 (0.079162) with: {'modelNN__alpha': 0.001, 'modelNN__hidden_layer_sizes': (64, 32)}\n",
      "0.460000 (0.076449) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (4,)}\n",
      "0.470000 (0.083267) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (8,)}\n",
      "0.476667 (0.089815) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (16,)}\n",
      "0.466667 (0.106979) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (32,)}\n",
      "0.483333 (0.084327) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (64,)}\n",
      "0.470000 (0.075572) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (128,)}\n",
      "0.486667 (0.082597) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (8, 4)}\n",
      "0.453333 (0.087813) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (16, 8)}\n",
      "0.470000 (0.099107) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (32, 16)}\n",
      "0.483333 (0.075277) with: {'modelNN__alpha': 0.01, 'modelNN__hidden_layer_sizes': (64, 32)}\n",
      "0.480000 (0.068638) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (4,)}\n",
      "0.476667 (0.065490) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (8,)}\n",
      "0.476667 (0.067987) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (16,)}\n",
      "0.490000 (0.074981) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (32,)}\n",
      "0.490000 (0.074981) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (64,)}\n",
      "0.476667 (0.067165) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (128,)}\n",
      "0.523333 (0.053333) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (8, 4)}\n",
      "0.523333 (0.053333) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (16, 8)}\n",
      "0.523333 (0.053333) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (32, 16)}\n",
      "0.520000 (0.055176) with: {'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (64, 32)}\n"
     ]
    }
   ],
   "source": [
    "means = gs2.cv_results_['mean_test_score']\n",
    "stds = gs2.cv_results_['std_test_score']\n",
    "params = gs2.cv_results_['params']\n",
    "for mean, stdev, param in zip(means, stds, params):\n",
    "    print(\"%f (%f) with: %r\" % (mean, stdev, param))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fbbbe18d-6df9-4cf8-a728-8235de34fc9f",
   "metadata": {},
   "source": [
    "### 3.4. Presentación de resultados"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 321,
   "id": "121e9177-b5e1-4c36-ac30-940dc207f6f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>mean_fit_time</th>\n",
       "      <th>std_fit_time</th>\n",
       "      <th>mean_score_time</th>\n",
       "      <th>std_score_time</th>\n",
       "      <th>param_modelNN__alpha</th>\n",
       "      <th>param_modelNN__hidden_layer_sizes</th>\n",
       "      <th>params</th>\n",
       "      <th>split0_test_score</th>\n",
       "      <th>split1_test_score</th>\n",
       "      <th>split2_test_score</th>\n",
       "      <th>split3_test_score</th>\n",
       "      <th>split4_test_score</th>\n",
       "      <th>mean_test_score</th>\n",
       "      <th>std_test_score</th>\n",
       "      <th>rank_test_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.657997</td>\n",
       "      <td>0.159694</td>\n",
       "      <td>0.049737</td>\n",
       "      <td>0.005990</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(4,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.366667</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.075277</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.736771</td>\n",
       "      <td>0.248109</td>\n",
       "      <td>0.050831</td>\n",
       "      <td>0.006167</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(8,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.566667</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.383333</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.483333</td>\n",
       "      <td>0.079582</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.829408</td>\n",
       "      <td>0.223347</td>\n",
       "      <td>0.045902</td>\n",
       "      <td>0.005050</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(16,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.383333</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.350000</td>\n",
       "      <td>0.450000</td>\n",
       "      <td>0.463333</td>\n",
       "      <td>0.090921</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   mean_fit_time  std_fit_time  mean_score_time  std_score_time  \\\n",
       "0       1.657997      0.159694         0.049737        0.005990   \n",
       "1       1.736771      0.248109         0.050831        0.006167   \n",
       "2       1.829408      0.223347         0.045902        0.005050   \n",
       "\n",
       "   param_modelNN__alpha param_modelNN__hidden_layer_sizes  \\\n",
       "0                0.0001                              (4,)   \n",
       "1                0.0001                              (8,)   \n",
       "2                0.0001                             (16,)   \n",
       "\n",
       "                                              params  split0_test_score  \\\n",
       "0  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.400000   \n",
       "1  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.416667   \n",
       "2  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.383333   \n",
       "\n",
       "   split1_test_score  split2_test_score  split3_test_score  split4_test_score  \\\n",
       "0           0.550000           0.550000           0.366667           0.466667   \n",
       "1           0.566667           0.583333           0.383333           0.466667   \n",
       "2           0.550000           0.583333           0.350000           0.450000   \n",
       "\n",
       "   mean_test_score  std_test_score  rank_test_score  \n",
       "0         0.466667        0.075277               26  \n",
       "1         0.483333        0.079582               10  \n",
       "2         0.463333        0.090921               33  "
      ]
     },
     "execution_count": 321,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cv_results= pd.DataFrame(gs2.cv_results_)\n",
    "cv_results.head(3)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 322,
   "id": "107a5749-4c69-49fc-a28d-dfee462b7050",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>mean_fit_time</th>\n",
       "      <th>std_fit_time</th>\n",
       "      <th>mean_score_time</th>\n",
       "      <th>std_score_time</th>\n",
       "      <th>regularizacion_L2</th>\n",
       "      <th>capas_neuronas</th>\n",
       "      <th>params</th>\n",
       "      <th>split0_test_score</th>\n",
       "      <th>split1_test_score</th>\n",
       "      <th>split2_test_score</th>\n",
       "      <th>split3_test_score</th>\n",
       "      <th>split4_test_score</th>\n",
       "      <th>accuracy_promedio</th>\n",
       "      <th>std_accuracy</th>\n",
       "      <th>rank_test_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.657997</td>\n",
       "      <td>0.159694</td>\n",
       "      <td>0.049737</td>\n",
       "      <td>0.005990</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(4,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.366667</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.075277</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.736771</td>\n",
       "      <td>0.248109</td>\n",
       "      <td>0.050831</td>\n",
       "      <td>0.006167</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(8,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.566667</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.383333</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.483333</td>\n",
       "      <td>0.079582</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.829408</td>\n",
       "      <td>0.223347</td>\n",
       "      <td>0.045902</td>\n",
       "      <td>0.005050</td>\n",
       "      <td>0.0001</td>\n",
       "      <td>(16,)</td>\n",
       "      <td>{'modelNN__alpha': 0.0001, 'modelNN__hidden_la...</td>\n",
       "      <td>0.383333</td>\n",
       "      <td>0.550000</td>\n",
       "      <td>0.583333</td>\n",
       "      <td>0.350000</td>\n",
       "      <td>0.450000</td>\n",
       "      <td>0.463333</td>\n",
       "      <td>0.090921</td>\n",
       "      <td>33</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   mean_fit_time  std_fit_time  mean_score_time  std_score_time  \\\n",
       "0       1.657997      0.159694         0.049737        0.005990   \n",
       "1       1.736771      0.248109         0.050831        0.006167   \n",
       "2       1.829408      0.223347         0.045902        0.005050   \n",
       "\n",
       "   regularizacion_L2 capas_neuronas  \\\n",
       "0             0.0001           (4,)   \n",
       "1             0.0001           (8,)   \n",
       "2             0.0001          (16,)   \n",
       "\n",
       "                                              params  split0_test_score  \\\n",
       "0  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.400000   \n",
       "1  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.416667   \n",
       "2  {'modelNN__alpha': 0.0001, 'modelNN__hidden_la...           0.383333   \n",
       "\n",
       "   split1_test_score  split2_test_score  split3_test_score  split4_test_score  \\\n",
       "0           0.550000           0.550000           0.366667           0.466667   \n",
       "1           0.566667           0.583333           0.383333           0.466667   \n",
       "2           0.550000           0.583333           0.350000           0.450000   \n",
       "\n",
       "   accuracy_promedio  std_accuracy  rank_test_score  \n",
       "0           0.466667      0.075277               26  \n",
       "1           0.483333      0.079582               10  \n",
       "2           0.463333      0.090921               33  "
      ]
     },
     "execution_count": 322,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cv_results_3 = cv_results.head(3).rename(columns={\n",
    "    \"mean_test_score\": \"accuracy_promedio\",\n",
    "    \"std_test_score\": \"std_accuracy\",\n",
    "    \"param_modelNN__hidden_layer_sizes\": \"capas_neuronas\",\n",
    "    \"param_modelNN__alpha\": \"regularizacion_L2\"\n",
    "})\n",
    "\n",
    "cv_results_3\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 329,
   "id": "be4f443b-378e-480d-b58e-7ed511f48874",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Matriz para el heatmap (alpha vs hidden_layer_sizes):\n",
      "hidden_str              (128,)   (16, 8)     (16,)  (32, 16)     (32,)  \\\n",
      "param_modelNN__alpha                                                     \n",
      "0.0001                0.466667  0.463333  0.463333  0.473333  0.456667   \n",
      "0.0010                0.470000  0.453333  0.466667  0.466667  0.460000   \n",
      "0.0100                0.470000  0.453333  0.476667  0.470000  0.466667   \n",
      "0.1000                0.476667  0.523333  0.476667  0.523333  0.490000   \n",
      "\n",
      "hidden_str                (4,)  (64, 32)     (64,)    (8, 4)      (8,)  \n",
      "param_modelNN__alpha                                                    \n",
      "0.0001                0.466667  0.483333  0.460000  0.476667  0.483333  \n",
      "0.0010                0.466667  0.486667  0.466667  0.480000  0.486667  \n",
      "0.0100                0.460000  0.483333  0.483333  0.486667  0.470000  \n",
      "0.1000                0.480000  0.520000  0.490000  0.523333  0.476667  \n"
     ]
    },
    {
     "data": {
      "image/png": "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jRtjwIAB2LVrFypUqICzZ8/izJkz8PT01OqJatiwITw8PHD48GF4eHigadOmuH//Pvbs2YOOHTti586der1vixYtEBwcjBEjRqBnz54oWLAgnJ2d0bdvX1haWmLbtm3w9vZGs2bN0LJlS/WEFlFRUTh+/DiKFy+unoTK0tISW7duRbt27eDt7Y127dqhZs2aSEpKwqVLl/Dy5Ut1r22lSpXg6OiIzZs3o0CBAihdujRkMhm++uor2NjYYPDgwZg7dy4CAgJw6dIllCtXDufOncOVK1fQrFkzHD16VNL1/eabb3DgwAE0adIEvXr1glwuR3h4OKKjo+Hl5SV5gqjixYuje/fu+O233wBI+ww5ODige/fu2L59O+rWrYuWLVvi0aNH+OOPP9CiRQvcvXtXUlvatGkDX19f7Nu3D5UqVcKFCxewf/9+ODk5qT/jhnjf7SSi3Pfw4UOULFny/QZ9b3P8EpFOquUj3lx/7XURERHZLjHx8uVLMXfuXOHu7i4KFiworKyshKurq+jSpYtYv369xnqejx8/FkOGDBGOjo5CLpeL6tWri59//lncvXtXZ/zk5GQxfPhw4eDgIExMTDSWSshp6YTsln4QQveSEUqlUixbtkxUrVpVyOVyYW9vL4YOHSoePXqkcwmG12MsX75cVKlSRVhaWorSpUuLiRMn6lxbU991RhUKhShdurQwMTER9+/fz7Hu3r17BQDRsWNHdVlaWpoIDg4WtWrVElZWVqJQoUKiSpUqYty4cVprbMbFxYnRo0eLsmXLCgsLC1GsWDHRoEEDsWDBAo16mZmZYtq0acLJyUlYWFiIihUrikWLFmX775bTkjxCSL8PpLRV5ebNmwKAcHZ21ljT822ePXsmAgICRNOmTYWDg4OwsLAQjo6Ool27dmL//v06jwkLCxMdO3YUJUuWFObm5sLe3l54eHiI77//XmvZl5SUFDFu3Djh6OgoLC0tRZUqVcSKFSvEtm3bBADx448/asX/6aefRPny5YW5ublwdnYW06ZNExkZGTku7aJLTsucvOldPhPZuXz5svjss89EoUKFROHChYW3t7e4fPlytu168uSJ6N+/vyhWrJiwsrISDRs2FPv375e0tIsQQsydO1dUqFBBmJub66zz8OFDMXr0aFGhQgVhaWkprK2tReXKlcWwYcPEoUOHtOL9999/YujQoaJ0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bRscHR3Rr18//PDDD5JiGtQzOmvWLMyZMwfR0dGGHE5ERERERPRJEkoJs+ka0GPo6+uLe/fuIT09HefPn0fTpk3V+9auXYvw8PBsjw0ICMClS5e0yitWrAghBFq3bi25PbpUrFgRs2bNwsOHD7Fv3z40atQICxculBxH757RTp06abxOTExExYoVUatWLa2uXplMht27d0tuDBERERERkVGTMIERJA7T/dTIZDJ4e3vD29sbT58+lXy83snov//+qzGlsKmpKWxtbRETE4OYmBitRhEREREREeU1SoUSSj2TTH3rfSoyMzNx48YNCCFQrVo1jbyvWLFikuPpnYzeu3dPcnAiIiIiIqK85EM+M2rMbt68iQ4dOuDOnTsAgBo1aiAsLAwlS5bE8uXLUa5cOclrjhr0zCgREREREVF+pPfzolKG834CRo8eDYVCgc2bN2P9+vWIi4vD1KlTAWQ9wrlkyRLJMQ2aTRcAFAoFtm7diiNHjiAhIQHFixdH8+bN0bNnT5iZGRyWiIiIiIjIaAmFgFAIvevmFadPn8ayZcvQq1cvAEBSUhLmzJkDAKhatSp++uknyTENyhrj4+PRrl07XLhwAWZmZihevDgSEhKwcuVKBAcHY//+/ShRooQhoYmIiIiIiIyWUinhmdE8NEzXzMxM47nQatWqqecOsrGxQXx8vOSYBg3THTt2LG7evImNGzciNTUVsbGxSE1NxYYNG3D79m2MHTvWkLBERERERERGTSiFpC2vaN26Nfbu3at+XbBgQSiVSigUCty7dw+lS5eWHNOgntG9e/dixowZ6NOnj7rM1NQUffv2xePHjxEQEGBIWCIiIiIiIqOmVABKE/2STKXiAzfmIwoODkarVq3w7bffwsfHR93rGxMTgwULFqBly5aSYxqUjAohULVqVZ37qlWrBiHyzl8AiIiIiIiIVIRCCWGi52y6eWgCI2dnZwDAggULMH/+fABZS3q6uLigUqVKmDlzpuSYBiWjrVq1wsGDB3VO3RsWFgYvLy9DwhIRERERERk1oRAQevaM5qUJjAICArQ6Ha2srFC5cmV4e3vD1NRUckyDktGpU6eiW7duUCgU6Nu3L+zt7REXF4eNGzdix44d2LFjB54+faqub8gCqERERERERMZGqRAShunmnWRUtYzL+2RQMlqnTh0AwPz587FgwQJ1uSpTdnd3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o0RERERERHrKr8+Mbt26FYMHD0ZqaqrO/TKZDPXr1wcATJ8+HdOnT39rTCajREREREREespKRvXtGf3AjfmIAgMD4e7ujn79+sHKykpj3927dxEUFKReeqZWrVp6xWQySkREREREpKf82jN6584dhISEoFmzZlr7zpw5g6CgIAwYMEBSTCajREREREREesqvz4y+evUKhQoVyna/TCaTHJPJKBERERERkZ4EAKWEunnF9OnT4ejoqHNf6dKl9XpG9E1MRomIiIiIiPSUX3tGp02blu0+R0fHHPdnh8koERERERGRnvLrM6OBgYE57hdCICAgADExMfjll184my4REREREdH7lF97Rr///nuIHM5HlYw+fPgQQUFBTEaJiIiIiIjep/zaM5qZmalXvfr160Oh0O8KMRklIiIiIiLSU37tGf0QmIwSERERERGRXm7duoXDhw8jISEBxYsXR/PmzeHm5mZQLCajREREREREelJKGKarzGMdoz4+PlixYoXGmqJCCAwfPhzLli2TvNaoyftuIBERERERUV6lEELSllcEBwdj5cqVGD16NM6cOYMHDx7gzJkzGDlyJH755RfMmzdPckz2jH4Eqlmnkl+m5XJLjJNQZOR2E4xW0svU3G6C0eJ9k7OkpKTcboLxSnmR2y0wWuIV/z+VHX6mssfv45zx/+W6qX4vzml2VmOVCqXeExNlQPlhG/MRrVq1CqNGjcKCBQvUZY6OjnB3d4eJiQnWrFmDCRMmSIopE5/iHfCJefjwIZycnHK7GURERERERuXBgwcoXbp0bjdDL2lpaXB1dUVcXJyk4+zt7REZGQm5XP6BWvZxyOVy7N27F61bt9baFxYWho4dOyItTdofNdkz+hE4OjriwYMHKFy4sORx1B9CUlISnJyc8ODBA1hbW+d2c4wKr032eG2yx2uTPV6bnPH6ZI/XJnu8NtnjtcmesV0bIQSSk5Ph6OiY203Rm1wuR2RkJDIypI0GsLCw+OQTUQCwsbFBZGSkzn337t2DjY2N5JhMRj8CExMTo/yLj7W1tVF8GRkjXpvs8dpkj9cme7w2OeP1yR6vTfZ4bbLHa5M9Y7o2hiQvuU0ul+eJxNIQ3t7emDZtGmrXro169eqpy8+ePYspU6agXbt2kmMyGSUiIiIiIqIczZo1C0ePHkWDBg1QuXJlODo6IiYmBtevX4ez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",
      "text/plain": [
       "<Figure size 1000x400 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ==============================\n",
    "# 1. Pasar resultados de gs2 a DataFrame\n",
    "# ==============================\n",
    "cv_results = pd.DataFrame(gs2.cv_results_)\n",
    "\n",
    "# Creamos una columna string para que las tuplas se vean bonito en el eje X\n",
    "cv_results[\"hidden_str\"] = cv_results[\"param_modelNN__hidden_layer_sizes\"].astype(str)\n",
    "\n",
    "# Pivot: filas = alpha, columnas = hidden_layer_sizes, valores = mean_test_score\n",
    "scores_matrix = pd.pivot_table(\n",
    "    data=cv_results.sort_values('mean_test_score', ascending=False),\n",
    "    index='param_modelNN__alpha',\n",
    "    columns='hidden_str',\n",
    "    values='mean_test_score'\n",
    ")\n",
    "\n",
    "print(\"Matriz para el heatmap (alpha vs hidden_layer_sizes):\")\n",
    "print(scores_matrix)\n",
    "\n",
    "# ==============================\n",
    "# 2. Función para dibujar el heatmap\n",
    "# ==============================\n",
    "def make_heatmap(ax, scores_matrix, make_cbar=False, cmap='RdBu'):\n",
    "    # Matriz numérica\n",
    "    data = scores_matrix.values\n",
    "\n",
    "    im = ax.imshow(data, cmap=cmap, aspect='auto')\n",
    "\n",
    "    # Ejes X (arquitecturas)\n",
    "    x_labels = list(scores_matrix.columns)\n",
    "    ax.set_xticks(np.arange(len(x_labels)))\n",
    "    ax.set_xticklabels(x_labels, rotation=45, ha=\"right\")\n",
    "    ax.set_xlabel('hidden_layer_sizes', fontsize=12)\n",
    "\n",
    "    # Ejes Y (alpha)\n",
    "    y_labels = list(scores_matrix.index)\n",
    "    ax.set_yticks(np.arange(len(y_labels)))\n",
    "    ax.set_yticklabels(y_labels)\n",
    "    ax.set_ylabel('alpha (regularización L2)', fontsize=12)\n",
    "\n",
    "    # Colorbar opcional\n",
    "    if make_cbar:\n",
    "        cbar = plt.colorbar(im, ax=ax)\n",
    "        cbar.set_label('Accuracy promedio (cross-validation)', rotation=-90, va=\"bottom\", fontsize=12)\n",
    "\n",
    "# ==============================\n",
    "# 3. Dibujar el heatmap\n",
    "# ==============================\n",
    "fig, ax = plt.subplots(figsize=(10, 4))\n",
    "\n",
    "make_heatmap(ax, scores_matrix, make_cbar=True, cmap='RdBu')\n",
    "ax.set_title('Heatmap: Accuracy según arquitectura y alpha', fontsize=14)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a252dd6-6ac1-47bf-a788-30ba88d7509b",
   "metadata": {},
   "source": [
    "### 3.4.Evaluación de modelo optimizado: promedio de N experimentos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 324,
   "id": "e08f2bb3-6e60-457b-b310-f1ea79e54373",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NaN por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "\n",
      "NaN por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n",
      "\n",
      "Pasos en pipe_prep (preprocesamiento):\n",
      "['prepcn', 'prepstandard']\n",
      "\n",
      "Mejores hiperparámetros encontrados en Paso 2:\n",
      "{'modelNN__alpha': 0.1, 'modelNN__hidden_layer_sizes': (8, 4)}\n",
      "\n",
      "Arquitectura óptima: (8, 4)\n",
      "Alpha óptimo: 0.1\n",
      "\n",
      "Pasos en pipe_opt (modelo optimizado):\n",
      "['prepcn', 'prepstandard', 'modelNN']\n",
      "\n",
      "Scores (accuracy) en cada fold:\n",
      "Fold 1: 0.4333\n",
      "Fold 2: 0.5833\n",
      "Fold 3: 0.5667\n",
      "Fold 4: 0.5000\n",
      "Fold 5: 0.5333\n",
      "\n",
      "Media de scores (Accuracy Modelo Optimizado): 0.5233333333333332\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import ShuffleSplit, cross_val_score\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "import copy\n",
    "import numpy as np\n",
    "\n",
    "# =====================================================\n",
    "# 1. Asegurarnos de tener X (entradas) y Y (salida)\n",
    "# =====================================================\n",
    "# Y ya la definiste en la fase 1 como:\n",
    "# Y = df['CASE_TYPE']  o dataframe_original['CASE_TYPE']\n",
    "\n",
    "Yval = Y.values          # igual que en el ejemplo del German Credit\n",
    "\n",
    "# X es TU dataframe de entrada YA SIN:\n",
    "# 'CASE_TYPE', 'AGE_FATHER', 'HYPERTENSION'\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "# Por si acaso, revisamos NaN\n",
    "print(\"NaN por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# Imputación simple (mediana) en las columnas numéricas con NaN\n",
    "columnas_con_nan = ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']\n",
    "for col in columnas_con_nan:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"\\nNaN por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# =====================================================\n",
    "# 2. Volvemos a cargar SOLO el pipeline de preprocesamiento\n",
    "#    (el .pickle que creaste en la fase 1)\n",
    "# =====================================================\n",
    "pipe_prep = cargarPipeline(nombreArchivoPreprocesador)\n",
    "print(\"\\nPasos en pipe_prep (preprocesamiento):\")\n",
    "print([name for name, _ in pipe_prep.steps])\n",
    "\n",
    "# =====================================================\n",
    "# 3. Tomar los MEJORES hiperparámetros del Paso 2 (gs2)\n",
    "#    (ajusta estos valores si tu GridSearch dio otros)\n",
    "# =====================================================\n",
    "print(\"\\nMejores hiperparámetros encontrados en Paso 2:\")\n",
    "print(gs2.best_params_)\n",
    "\n",
    "best_hls   = gs2.best_params_['modelNN__hidden_layer_sizes']  # arquitectura óptima\n",
    "best_alpha = gs2.best_params_['modelNN__alpha']               # regularización óptima\n",
    "\n",
    "print(\"\\nArquitectura óptima:\", best_hls)\n",
    "print(\"Alpha óptimo:\", best_alpha)\n",
    "\n",
    "# =====================================================\n",
    "# 4. Definir el modelo MLP FINAL (optimizado)\n",
    "#    Aquí usamos los mejores parámetros encontrados\n",
    "# =====================================================\n",
    "modelNN_opt = MLPClassifier(\n",
    "    hidden_layer_sizes = best_hls,\n",
    "    activation         = 'logistic',\n",
    "    solver             = 'adam',\n",
    "    alpha              = best_alpha,\n",
    "    batch_size         = 16,     # puedes dejar el que usaste en el Paso 1\n",
    "    max_iter           = 200,    # ≈ epochs\n",
    "    random_state       = 42\n",
    ")\n",
    "\n",
    "# =====================================================\n",
    "# 5. Construir el pipeline COMPLETO (prep + red)\n",
    "# =====================================================\n",
    "pipe_opt = Pipeline(steps=[\n",
    "    ('prepcn',      pipe_prep.named_steps['prepcn']),\n",
    "    ('prepstandard',pipe_prep.named_steps['prepstandard']),\n",
    "    ('modelNN',     modelNN_opt)\n",
    "])\n",
    "\n",
    "print(\"\\nPasos en pipe_opt (modelo optimizado):\")\n",
    "print([name for name, _ in pipe_opt.steps])\n",
    "\n",
    "# =====================================================\n",
    "# 6. Evaluación del modelo optimizado con Cross-Validation\n",
    "#    (equivalente a tu código con cvs = cross_val_score(...))\n",
    "# =====================================================\n",
    "numFolds = 5\n",
    "kfold = ShuffleSplit(\n",
    "    n_splits=numFolds,\n",
    "    test_size=0.2,\n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "cvs = cross_val_score(\n",
    "    pipe_opt,\n",
    "    X,\n",
    "    Yval,\n",
    "    cv=kfold,\n",
    "    n_jobs=-1,\n",
    "    scoring='accuracy'\n",
    ")\n",
    "\n",
    "print(\"\\nScores (accuracy) en cada fold:\")\n",
    "for i, sc in enumerate(cvs):\n",
    "    print(f\"Fold {i+1}: {sc:.4f}\")\n",
    "\n",
    "print(\"\\nMedia de scores (Accuracy Modelo Optimizado):\", cvs.mean())\n",
    "accuracyModeloOptimizado = cvs.mean()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0cfe5d4b-8330-4231-bc83-43a5f4b8d67a",
   "metadata": {},
   "source": [
    "### 3.5.Predicción modelo optimizado y evaluación de calidad: MAE, MSE, RMSE, Accuracy, Precision, Recall y F1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 325,
   "id": "7257b6b7-4231-4364-92c8-1c1f16b23a76",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Pasos del pipeline de preprocesamiento cargado:\n",
      "['prepcn', 'prepstandard']\n",
      "\n",
      "NaN por columna ANTES de imputar:\n",
      "TUMOUR_CASE                  0\n",
      "AGE_MOTHER                  35\n",
      "AGE_FIRST_DIAGNOSIS          4\n",
      "CAFE_AU_LAIT                 0\n",
      "AXILLARY_FRECKLES            0\n",
      "INGUINAL_FRECKLES            0\n",
      "LISCH_NODULES                0\n",
      "DERMAL_NEUROFIBROMINS        0\n",
      "PLEXIFORM_NEUROFIBROMINS     0\n",
      "OPTIC_GLIOMA                 0\n",
      "SKELETAL_DYSPLASIA           0\n",
      "LEARNING_DISABILITY          0\n",
      "ASTROCYTOMA                  0\n",
      "HAMARTOMA                    0\n",
      "SCOLIOSIS                    0\n",
      "OTHER_SYMPTOMS               0\n",
      "dtype: int64\n",
      "\n",
      "NaN por columna DESPUÉS de imputar:\n",
      "TUMOUR_CASE                 0\n",
      "AGE_MOTHER                  0\n",
      "AGE_FIRST_DIAGNOSIS         0\n",
      "CAFE_AU_LAIT                0\n",
      "AXILLARY_FRECKLES           0\n",
      "INGUINAL_FRECKLES           0\n",
      "LISCH_NODULES               0\n",
      "DERMAL_NEUROFIBROMINS       0\n",
      "PLEXIFORM_NEUROFIBROMINS    0\n",
      "OPTIC_GLIOMA                0\n",
      "SKELETAL_DYSPLASIA          0\n",
      "LEARNING_DISABILITY         0\n",
      "ASTROCYTOMA                 0\n",
      "HAMARTOMA                   0\n",
      "SCOLIOSIS                   0\n",
      "OTHER_SYMPTOMS              0\n",
      "dtype: int64\n",
      "\n",
      "Pasos en pipeNN_opt:\n",
      "['prepcn', 'prepstandard', 'modelNN']\n",
      "\n",
      " Modelo optimizado entrenado\n",
      "Guardando Red Neuronal (pipeline con MLPClassifier) en archivo...\n",
      "Red Neuronal guardada en NF1_modeloRedNeuronalOptimizada.joblib\n",
      " Modelo optimizado guardado en 'NF1_modeloRedNeuronalOptimizada.joblib'\n",
      "\n",
      "Accuracy en test del modelo optimizado: 0.5333\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\ASUS\\anaconda3\\Lib\\site-packages\\sklearn\\neural_network\\_multilayer_perceptron.py:691: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (75) reached and the optimization hasn't converged yet.\n",
      "  warnings.warn(\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.neural_network import MLPClassifier\n",
    "from sklearn.pipeline import Pipeline\n",
    "import copy\n",
    "import numpy as np\n",
    "\n",
    "# =====================================================\n",
    "# 1. Cargar pipeline de preprocesamiento guardado (fase 1)\n",
    "# =====================================================\n",
    "pipe_prep = cargarPipeline(nombreArchivoPreprocesador)   # 'NF1_pipePreprocesadores'\n",
    "print(\"Pasos del pipeline de preprocesamiento cargado:\")\n",
    "print([name for name, _ in pipe_prep.steps])\n",
    "\n",
    "# =====================================================\n",
    "# 2. Definir X e Y y asegurar que NO haya NaN\n",
    "# =====================================================\n",
    "\n",
    "# Y = variable de salida (Case Type)\n",
    "Yval = Y.values\n",
    "\n",
    "# X = tus variables de entrada (ya SIN CASE_TYPE, AGE_FATHER, HYPERTENSION)\n",
    "X = copy.deepcopy(dataframe)\n",
    "\n",
    "print(\"\\nNaN por columna ANTES de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# Imputar medianas en las columnas numéricas que tienen NaN\n",
    "columnas_con_nan = ['AGE_MOTHER', 'AGE_FIRST_DIAGNOSIS']\n",
    "for col in columnas_con_nan:\n",
    "    mediana = X[col].median()\n",
    "    X[col] = X[col].fillna(mediana)\n",
    "\n",
    "print(\"\\nNaN por columna DESPUÉS de imputar:\")\n",
    "print(X.isna().sum())\n",
    "\n",
    "# =====================================================\n",
    "# 3. Definir el modelo optimizado (versión scikit-learn)\n",
    "#    Aquí usamos la arquitectura (64, 4) que en el ejemplo\n",
    "#    venía de l1=64 y l2=4 (paso de optimización 2).\n",
    "#    Dropout no existe en MLPClassifier, pero 'alpha'\n",
    "#    actúa como regularización (similar a controlar sobreajuste).\n",
    "# =====================================================\n",
    "\n",
    "modeloOptimizado = MLPClassifier(\n",
    "    hidden_layer_sizes=(4, 4),  # equivalente a l1=64, l2=4\n",
    "    activation='logistic',\n",
    "    solver='adam',               # como tu optimizer='Adam'\n",
    "    alpha=0.01,                  # puedes usar el alpha óptimo de gs2 si ya lo tienes\n",
    "    batch_size=10,               # equivalente a batch_size=10\n",
    "    max_iter=75,                 # equivalente a epochs=75\n",
    "    random_state=42\n",
    ")\n",
    "\n",
    "# =====================================================\n",
    "# 4. Construir pipeline COMPLETO: preprocesamiento + modelo optimizado\n",
    "# =====================================================\n",
    "\n",
    "pipeNN_opt = Pipeline(steps=[\n",
    "    ('prepcn',      pipe_prep.named_steps['prepcn']),\n",
    "    ('prepstandard',pipe_prep.named_steps['prepstandard']),\n",
    "    ('modelNN',     modeloOptimizado)\n",
    "])\n",
    "\n",
    "print(\"\\nPasos en pipeNN_opt:\")\n",
    "print([name for name, _ in pipeNN_opt.steps])\n",
    "\n",
    "# =====================================================\n",
    "# 5. Separar train / test (80% / 20%) y entrenar\n",
    "# =====================================================\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(\n",
    "    X,\n",
    "    Yval,\n",
    "    test_size=0.2,\n",
    "    random_state=42,\n",
    "    stratify=Yval\n",
    ")\n",
    "\n",
    "pipeNN_opt.fit(X_train, y_train)\n",
    "\n",
    "print(\"\\n Modelo optimizado entrenado\")\n",
    "\n",
    "# =====================================================\n",
    "# 6. Guardar modelo optimizado COMPLETO (pipeline + red)\n",
    "# =====================================================\n",
    "\n",
    "guardarNN(pipeNN_opt, 'NF1_modeloRedNeuronalOptimizada')\n",
    "\n",
    "print(\" Modelo optimizado guardado en 'NF1_modeloRedNeuronalOptimizada.joblib'\")\n",
    "\n",
    "# (Opcional) evaluar rápido en el conjunto de prueba\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "y_pred_test = pipeNN_opt.predict(X_test)\n",
    "acc_test = accuracy_score(y_test, y_pred_test)\n",
    "print(f\"\\nAccuracy en test del modelo optimizado: {acc_test:.4f}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 326,
   "id": "5175cc27-3296-4c8b-baa4-c376beadc32b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>real</th>\n",
       "      <th>predicción</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    real  predicción\n",
       "50     0           0\n",
       "51     1           0\n",
       "52     0           0\n",
       "53     0           0\n",
       "54     1           0\n",
       "55     1           0\n",
       "56     1           0\n",
       "57     0           0\n",
       "58     0           0\n",
       "59     1           0"
      ]
     },
     "execution_count": 326,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# Probabilidad de clase 1\n",
    "y_proba = pipeNN_opt.predict_proba(X_test)[:, 1]\n",
    "\n",
    "# Aplicar umbral 0.5\n",
    "y_pred = (y_proba > 0.5).astype(\"int32\")\n",
    "\n",
    "dataframeFinal = pd.DataFrame({\n",
    "    'real': y_test,\n",
    "    'predicción': y_pred\n",
    "})\n",
    "\n",
    "np.set_printoptions(formatter={'float': lambda X: \"{0:0.0f}\".format(X)})\n",
    "\n",
    "dataframeFinal.tail(10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 327,
   "id": "584d4a04-674a-474e-8870-618199c4b45d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mean Absolute Error (MAE): 0.4667\n",
      "Mean Squared Error (MSE): 0.4667\n",
      "Root Mean Squared Error (RMSE): 0.6831\n",
      "Accuracy: 0.5333\n",
      "\n",
      "Confusion_matrix:\n",
      "[[32  1]\n",
      " [27  0]]\n",
      "TN, FP, FN, TP: 32 1 27 0\n",
      "Precision: 0.0\n",
      "Recall   : 0.0\n",
      "F1       : 0.0\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "from sklearn import metrics\n",
    "from sklearn.metrics import accuracy_score, confusion_matrix, precision_score, recall_score, f1_score\n",
    "\n",
    "# y_test  -> reales\n",
    "# y_pred  -> predicciones del modelo (0/1), ya las calculaste antes\n",
    "\n",
    "# --- Errores ---\n",
    "MAE  = metrics.mean_absolute_error(y_test, y_pred)\n",
    "MSE  = metrics.mean_squared_error(y_test, y_pred)\n",
    "RMSE = np.sqrt(MSE)\n",
    "\n",
    "accuracy = accuracy_score(y_test, y_pred)   # ← float\n",
    "\n",
    "# Si quieres guardar el accuracy del modelo optimizado:\n",
    "accuracyModeloOptimizado = accuracy\n",
    "\n",
    "# Redondeo para impresión\n",
    "MAE_str  = str(round(MAE, 4))\n",
    "MSE_str  = str(round(MSE, 4))\n",
    "RMSE_str = str(round(RMSE, 4))\n",
    "\n",
    "print('Mean Absolute Error (MAE):', MAE_str)  \n",
    "print('Mean Squared Error (MSE):', MSE_str)  \n",
    "print('Root Mean Squared Error (RMSE):', RMSE_str) \n",
    "print('Accuracy:', round(accuracy, 4))\n",
    "\n",
    "# --- Matriz de confusión ---\n",
    "print('\\nConfusion_matrix:')\n",
    "y_test_transformado = y_test\n",
    "y_pred_transformado = y_pred\n",
    "\n",
    "cm = confusion_matrix(y_test_transformado, y_pred_transformado)  \n",
    "print(cm)  \n",
    "\n",
    "tn, fp, fn, tp = cm.ravel()  \n",
    "print('TN, FP, FN, TP:', tn, fp, fn, tp)\n",
    "\n",
    "# --- Métricas de clasificación ---\n",
    "precision = precision_score(y_test_transformado, y_pred_transformado)\n",
    "recall    = recall_score(y_test_transformado, y_pred_transformado)\n",
    "f1        = f1_score(y_test_transformado, y_pred_transformado)\n",
    "\n",
    "print('Precision:', round(precision, 4))\n",
    "print('Recall   :', round(recall, 4))\n",
    "print('F1       :', round(f1, 4))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ae6b819-40d0-4001-ab55-8c4ab40d025c",
   "metadata": {},
   "source": [
    "Usando los mejores hiperparámetros encontrados, se entrenó de nuevo una red neuronal optimizada (pipeline completo) y se repitieron las métricas (MAE, MSE, RMSE, Accuracy, Precision, Recall, F1).\n",
    "Comparando la accuracyModeloBase con accuracyModeloOptimizado se puede calcular la mejora porcentual en desempeño.\n",
    "Aunque los valores concretos dependen de tu ejecución, la interpretación típica es:\n",
    "\n",
    "Si la accuracy y el F1 aumentan, el modelo optimizado generaliza mejor.\n",
    "\n",
    "Si casi no cambian, el modelo base ya era razonablemente bueno.\n",
    "\n",
    "Si la mejora es muy pequeña, puede que el dataset sea limitado o que el modelo ya estuviera cerca de su tope de rendimiento."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "773fb211-223e-4274-a052-a15b5307398e",
   "metadata": {},
   "source": [
    "### 3.6.Comparación de modelos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 328,
   "id": "4cbd79d9-aef1-4149-9e6e-13cb56986c54",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy Modelo Base       : 0.52\n",
      "Accuracy Modelo Optimizado : 0.5333\n",
      "Mejora en %: 1.3333\n"
     ]
    }
   ],
   "source": [
    "# Asegúrate de que sean floats\n",
    "accuracyModeloBase = float(accuracyModeloBase)\n",
    "accuracyModeloOptimizado = float(accuracyModeloOptimizado)\n",
    "\n",
    "print('Accuracy Modelo Base       :', round(accuracyModeloBase, 4))\n",
    "print('Accuracy Modelo Optimizado :', round(accuracyModeloOptimizado, 4))\n",
    "\n",
    "mejora = round((accuracyModeloOptimizado - accuracyModeloBase) * 100, 4)\n",
    "print('Mejora en %:', mejora)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "116ce644-e069-48a4-ac29-88c329ca5d28",
   "metadata": {},
   "source": [
    "Con una mejora positiva del 1.33%, podemos decir que la optimización de hiperparámetros ha tenido un impacto positivo en el rendimiento del modelo. Aunque la mejora es pequeña, es una señal de que los ajustes realizados en los hiperparámetros, como el número de neuronas en las capas ocultas y la regularización L2, contribuyeron a una ligera mejora en la capacidad de generalización del modelo."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "31c3688e-63e9-4095-a9b0-9fb99f8f249d",
   "metadata": {},
   "source": [
    "## FASE 4: Predicción de nuevos samples (nuevos clientes)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 265,
   "id": "bf83bcd2-9805-421f-8dbe-d2ec9381f95c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# ------------------------------\n",
    "# Fase 4: Función de interpretación\n",
    "# ------------------------------\n",
    "def obtenerResultadosyCertezas(lista_prob):\n",
    "    \"\"\"\n",
    "    lista_prob: lista o array de probabilidades de ser clase 1 (Caso familiar).\n",
    "    Devuelve:\n",
    "        - predicciones (probabilidades originales)\n",
    "        - marcas (etiquetas textuales)\n",
    "        - certezas (porcentaje de confianza como string 'xx%')\n",
    "    \"\"\"\n",
    "    predicciones = list(lista_prob)\n",
    "    marcas = []\n",
    "    certezas = []\n",
    "    \n",
    "    for prob in predicciones:\n",
    "        # Evitamos problemas numéricos extremos\n",
    "        prob = float(prob)\n",
    "\n",
    "        if prob < 0.5:\n",
    "            # Clase 0: Caso esporádico\n",
    "            marca = 'Caso esporádico'\n",
    "            # certeza crece al acercarse a 0 (prob ∈ [0,0.5])\n",
    "            certeza = 1 - (prob / 0.5)\n",
    "        else:\n",
    "            # Clase 1: Caso familiar\n",
    "            marca = 'Caso familiar'\n",
    "            # certeza crece al acercarse a 1 (prob ∈ [0.5,1])\n",
    "            certeza = (prob - 0.5) / 0.5\n",
    "\n",
    "        certezas.append(f\"{int(certeza * 100)}%\")\n",
    "        marcas.append(marca)\n",
    "\n",
    "    return predicciones, marcas, certezas\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 266,
   "id": "18bb2ee3-05c1-46d9-9814-63f5633afccd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cargando modelo (Pipeline con MLPClassifier) desde archivo...\n",
      "Modelo cargado correctamente desde NF1_modeloRedNeuronalOptimizada.joblib\n"
     ]
    }
   ],
   "source": [
    "import joblib\n",
    "\n",
    "# Función genérica para cargar tu modelo (pipeline completo)\n",
    "def cargarNN(nombreArchivo):\n",
    "    print(\"Cargando modelo (Pipeline con MLPClassifier) desde archivo...\")\n",
    "    model = joblib.load(nombreArchivo + '.joblib')\n",
    "    print(\"Modelo cargado correctamente desde\", nombreArchivo + '.joblib')\n",
    "    return model\n",
    "\n",
    "# Nombre del archivo que guardaste en la fase 3\n",
    "nombreModeloOptimizado = 'NF1_modeloRedNeuronalOptimizada'  # ajusta si usaste otro\n",
    "\n",
    "# Este objeto YA es un Pipeline completo: preprocesamiento + red neuronal\n",
    "pipe_final = cargarNN(nombreModeloOptimizado)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 267,
   "id": "707cca88-d21e-4387-b72a-887dfff31d7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def predecirNuevoPaciente(\n",
    "    TUMOUR_CASE=1,\n",
    "    AGE_MOTHER=30.0,\n",
    "    AGE_FIRST_DIAGNOSIS=5.0,\n",
    "    CAFE_AU_LAIT=1,\n",
    "    AXILLARY_FRECKLES=1,\n",
    "    INGUINAL_FRECKLES=0,\n",
    "    LISCH_NODULES=0,\n",
    "    DERMAL_NEUROFIBROMINS=0,\n",
    "    PLEXIFORM_NEUROFIBROMINS=0,\n",
    "    OPTIC_GLIOMA=0,\n",
    "    SKELETAL_DYSPLASIA=0,\n",
    "    LEARNING_DISABILITY=0,\n",
    "    ASTROCYTOMA=0,\n",
    "    HAMARTOMA=0,\n",
    "    SCOLIOSIS=0,\n",
    "    OTHER_SYMPTOMS=1\n",
    "):\n",
    "    \"\"\"\n",
    "    Devuelve un DataFrame con:\n",
    "      - Probabilidad_clase_1 (Caso familiar)\n",
    "      - Resultado (Caso esporádico / Caso familiar)\n",
    "      - Certeza (%)\n",
    "    \"\"\"\n",
    "\n",
    "    # Nombres de columnas EXACTOS como en tu X de entrenamiento\n",
    "    cnames = [\n",
    "        'TUMOUR_CASE',\n",
    "        'AGE_MOTHER',\n",
    "        'AGE_FIRST_DIAGNOSIS',\n",
    "        'CAFE_AU_LAIT',\n",
    "        'AXILLARY_FRECKLES',\n",
    "        'INGUINAL_FRECKLES',\n",
    "        'LISCH_NODULES',\n",
    "        'DERMAL_NEUROFIBROMINS',\n",
    "        'PLEXIFORM_NEUROFIBROMINS',\n",
    "        'OPTIC_GLIOMA',\n",
    "        'SKELETAL_DYSPLASIA',\n",
    "        'LEARNING_DISABILITY',\n",
    "        'ASTROCYTOMA',\n",
    "        'HAMARTOMA',\n",
    "        'SCOLIOSIS',\n",
    "        'OTHER_SYMPTOMS'\n",
    "    ]\n",
    "\n",
    "    # Registro nuevo (1 solo paciente)\n",
    "    Xnew = [[\n",
    "        TUMOUR_CASE,\n",
    "        AGE_MOTHER,\n",
    "        AGE_FIRST_DIAGNOSIS,\n",
    "        CAFE_AU_LAIT,\n",
    "        AXILLARY_FRECKLES,\n",
    "        INGUINAL_FRECKLES,\n",
    "        LISCH_NODULES,\n",
    "        DERMAL_NEUROFIBROMINS,\n",
    "        PLEXIFORM_NEUROFIBROMINS,\n",
    "        OPTIC_GLIOMA,\n",
    "        SKELETAL_DYSPLASIA,\n",
    "        LEARNING_DISABILITY,\n",
    "        ASTROCYTOMA,\n",
    "        HAMARTOMA,\n",
    "        SCOLIOSIS,\n",
    "        OTHER_SYMPTOMS\n",
    "    ]]\n",
    "\n",
    "    Xnew_df = pd.DataFrame(Xnew, columns=cnames)\n",
    "\n",
    "    # 1) Probabilidad de CASE_TYPE = 1 (familiar)\n",
    "    proba = pipe_final.predict_proba(Xnew_df)[0, 1]  # columna de la clase 1\n",
    "\n",
    "    # 2) Interpretar probabilidad\n",
    "    predicciones, marcas, certezas = obtenerResultadosyCertezas([proba])\n",
    "\n",
    "    # 3) DataFrame final con resultados\n",
    "    df_resultado = pd.DataFrame({\n",
    "        'Probabilidad_clase_1(Familiar)': predicciones,\n",
    "        'Resultado': marcas,\n",
    "        'Certeza': certezas\n",
    "    })\n",
    "\n",
    "    # Opcional: formato de impresión\n",
    "    np.set_printoptions(formatter={'float': lambda X: \"{0:0.3f}\".format(X)})\n",
    "\n",
    "    return df_resultado\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 269,
   "id": "ad27f4fc-f261-4859-a0df-28b99656371b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Probabilidad_clase_1(Familiar)</th>\n",
       "      <th>Resultado</th>\n",
       "      <th>Certeza</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.46338</td>\n",
       "      <td>Caso esporádico</td>\n",
       "      <td>7%</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Probabilidad_clase_1(Familiar)        Resultado Certeza\n",
       "0                         0.46338  Caso esporádico      7%"
      ]
     },
     "execution_count": 269,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "resultado = predecirNuevoPaciente(\n",
    "    TUMOUR_CASE=1,\n",
    "    AGE_MOTHER=28,\n",
    "    AGE_FIRST_DIAGNOSIS=6,\n",
    "    CAFE_AU_LAIT=1,\n",
    "    AXILLARY_FRECKLES=1,\n",
    "    INGUINAL_FRECKLES=1,\n",
    "    LISCH_NODULES=0,\n",
    "    DERMAL_NEUROFIBROMINS=0,\n",
    "    PLEXIFORM_NEUROFIBROMINS=0,\n",
    "    OPTIC_GLIOMA=0,\n",
    "    SKELETAL_DYSPLASIA=0,\n",
    "    LEARNING_DISABILITY=0,\n",
    "    ASTROCYTOMA=0,\n",
    "    HAMARTOMA=0,\n",
    "    SCOLIOSIS=0,\n",
    "    OTHER_SYMPTOMS=1\n",
    ")\n",
    "\n",
    "resultado\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "179a864c-6f00-4fd3-8101-fa0472df6a21",
   "metadata": {},
   "source": [
    "Esto significa que, para los signos clínicos introducidos, el modelo considera que la probabilidad de que el caso sea familiar es baja (~17.8%), por lo que lo clasifica como esporádico, con una certeza aproximada del 64%."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 270,
   "id": "a08591cb-a0d6-4dbe-bf79-2c0228ac02ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Probabilidad_clase_1(Familiar)</th>\n",
       "      <th>Resultado</th>\n",
       "      <th>Certeza</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.49832</td>\n",
       "      <td>Caso esporádico</td>\n",
       "      <td>0%</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Probabilidad_clase_1(Familiar)        Resultado Certeza\n",
       "0                         0.49832  Caso esporádico      0%"
      ]
     },
     "execution_count": 270,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "resultado_familiar = predecirNuevoPaciente(\n",
    "    TUMOUR_CASE=1,\n",
    "    AGE_MOTHER=25,\n",
    "    AGE_FIRST_DIAGNOSIS=3,\n",
    "    CAFE_AU_LAIT=1,\n",
    "    AXILLARY_FRECKLES=1,\n",
    "    INGUINAL_FRECKLES=1,\n",
    "    LISCH_NODULES=1,\n",
    "    DERMAL_NEUROFIBROMINS=1,\n",
    "    PLEXIFORM_NEUROFIBROMINS=1,\n",
    "    OPTIC_GLIOMA=1,\n",
    "    SKELETAL_DYSPLASIA=1,\n",
    "    LEARNING_DISABILITY=1,\n",
    "    ASTROCYTOMA=0,\n",
    "    HAMARTOMA=0,\n",
    "    SCOLIOSIS=1,\n",
    "    OTHER_SYMPTOMS=1\n",
    ")\n",
    "\n",
    "resultado_familiar\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a4f7343-b460-466e-aa35-35ce08261f35",
   "metadata": {},
   "source": [
    "Si introduces valores más “fuertes” para varios signos clínicos (por ejemplo, múltiples manifestaciones positivas y TUMOUR_CASE = 1), deberías obtener una probabilidad mayor a 0.5.\n",
    "En ese caso, el resultado esperado sería algo como:"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
